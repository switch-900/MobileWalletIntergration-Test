<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>0.5</title>

  <style>
    body { margin: 0; padding: 0; }
    #root { min-height: 100vh; }
  </style>
  <script type="importmap">
  {
    "imports": {
      "react": "https://ordinals.com/content/609b117277f1e9c9f27f358fe02db34e13d08915bbcea18770dc36f5f3afcbb2i0",
      "react-dom": "https://ordinals.com/content/609b117277f1e9c9f27f358fe02db34e13d08915bbcea18770dc36f5f3afcbb2i1",
      "react-dom/client": "https://ordinals.com/content/4d9308ce08bed11c028acb3d1dd964ea0e9809f51daf141ca0760e745a8070aei0",
      "react/jsx-runtime": "https://ordinals.com/content/609bad601cdafa4d4a2622bbd9f4ebfdd278b8c5ea1efeb0d468db33f871fffai1"
    }
  }
  </script>
  <script type="module" crossorigin>
var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,s=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=Reflect.get,c=Math.pow,u=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,d=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&u(e,n,t[n]);if(i)for(var n of i(t))a.call(t,n)&&u(e,n,t[n]);return e},p=(e,r)=>t(e,n(r)),h=(e,t,n)=>l(s(e),n,t),f=(e,t,n)=>new Promise((r,i)=>{var s=e=>{try{a(n.next(e))}catch(t){i(t)}},o=e=>{try{a(n.throw(e))}catch(t){i(t)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(s,o);a((n=n.apply(e,t)).next())});import g,{useState as m,useRef as y,useEffect as w,useMemo as b}from"react";import v from"react-dom/client";var E,S,I=(E={"assets/index.single-dj47-MCe.js"(e){function t(e,t){for(var n=0;n<t.length;n++){const r=t[n];if("string"!=typeof r&&!Array.isArray(r))for(const t in r)if("default"!==t&&!(t in e)){const n=Object.getOwnPropertyDescriptor(r,t);n&&Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>r[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const n=({inscription:e,onSelect:t})=>g.createElement("div",{className:"inscription-item",onClick:()=>{t&&t(e)}},g.createElement("div",{className:"inscription-header"},e.inscriptionNumber&&g.createElement("span",{className:"inscription-badge"},"#",e.inscriptionNumber),e.contentType&&g.createElement("span",{className:"content-type-pill"},e.contentType)),g.createElement("div",{className:"inscription-id-display monospace"},e.inscriptionId?`${e.inscriptionId.slice(0,12)}...`:"Unknown ID"),g.createElement("div",{className:"inscription-arrow"},"‚Üí")),r=({walletState:t,onClose:n,onInscriptionCreated:r})=>{var i;if(!t)return g.createElement("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4"},g.createElement("div",{className:"bg-gradient-to-br from-zinc-900 to-black border-2 border-purple-700 rounded-2xl max-w-md w-full p-6"},g.createElement("div",{className:"text-center"},g.createElement("div",{className:"text-4xl mb-4"},"‚ö†Ô∏è"),g.createElement("h3",{className:"text-xl font-bold text-white mb-2"},"Wallet Not Connected"),g.createElement("p",{className:"text-zinc-400 mb-4"},"Please connect a wallet before creating inscriptions."),g.createElement("button",{onClick:n,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-xl font-semibold transition-all"},"Close"))));const[s,o]=m("text"),[a,l]=m(""),[c,u]=m(null),[p,h]=m(""),[w,b]=m("text/plain"),[v,E]=m(10),[S,I]=m(""),[T,P]=m(""),[A,B]=m(0),[N,x]=m(1),[_,C]=m(!1),[k,O]=m(null),[U,R]=m(null),L=y(null),[H,M]=m("deploy"),[W,q]=m(""),[F,K]=m(""),[$,D]=m(""),[X,V]=m(""),j=[{value:"text",label:"Text",icon:"üìù",contentType:"text/plain"},{value:"json",label:"JSON",icon:"üìã",contentType:"application/json"},{value:"html",label:"HTML",icon:"üåê",contentType:"text/html"},{value:"brc20",label:"BRC-20",icon:"ü™ô",contentType:"text/plain"},{value:"image",label:"Image",icon:"üñºÔ∏è",contentType:"image/*"},{value:"file",label:"Custom File",icon:"üìÑ",contentType:"*/*"}],G=()=>{const e={p:"brc-20",op:H};return"deploy"===H?(e.tick=W.toLowerCase(),e.max=$,e.lim=X||$):("mint"===H||"transfer"===H)&&(e.tick=W.toLowerCase(),e.amt=F),JSON.stringify(e)},z=(()=>{let e=0;"text"===s||"json"===s||"html"===s?e=new Blob([a]).size:"brc20"===s?e=new Blob([G()]).size:c&&(e=c.byteLength||0);const t=200+e,n=Math.ceil(t*v*1.5),r=N>1?N:1,i=n*r;return{size:e,estimatedSats:i,estimatedBTC:(i/1e8).toFixed(8),perInscription:n,count:r}})();return g.createElement("div",{className:"modal-overlay",onClick:n},g.createElement("div",{className:"modal-card",style:{maxWidth:"800px"},onClick:e=>e.stopPropagation()},g.createElement("div",{className:"modal-header"},g.createElement("h2",{className:"modal-title"},"Create Inscription"),g.createElement("button",{className:"modal-close",onClick:n},"√ó")),g.createElement("div",{className:"modal-body"},g.createElement("div",{className:"card mb-lg"},g.createElement("div",{className:"text-sm mb-xs"},"Connected Wallet"),g.createElement("div",{className:"text-lg font-bold mb-xs"},(null==(i=null==t?void 0:t.walletType)?void 0:i.toUpperCase())||"Unknown"),g.createElement("div",{className:"monospace text-xs address-display"},(null==t?void 0:t.address)||"No address")),g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Inscription Type"),g.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"var(--spacing-sm)"}},j.map(e=>g.createElement("button",{key:e.value,onClick:()=>(e=>{o(e),O(null),R(null);const t=j.find(t=>t.value===e);t&&b(t.contentType)})(e.value),className:"btn "+(s===e.value?"btn-primary":"btn-secondary"),style:{padding:"var(--spacing-md)",height:"auto",flexDirection:"column",gap:"var(--spacing-xs)"}},g.createElement("div",{style:{fontSize:"1.5rem"}},e.icon),g.createElement("div",{style:{fontSize:"0.875rem"}},e.label))))),"brc20"===s&&g.createElement("div",{className:"card mb-lg"},g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Operation"),g.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"var(--spacing-xs)"}},["deploy","mint","transfer"].map(e=>g.createElement("button",{key:e,onClick:()=>M(e),className:"btn "+(H===e?"btn-primary":"btn-secondary")},e.charAt(0).toUpperCase()+e.slice(1))))),g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Ticker (4 letters)"),g.createElement("input",{type:"text",value:W,onChange:e=>q(e.target.value.toLowerCase().slice(0,4)),maxLength:4,placeholder:"ordi",className:"form-input"})),"deploy"===H&&g.createElement(g.Fragment,null,g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Max Supply"),g.createElement("input",{type:"text",value:$,onChange:e=>D(e.target.value),placeholder:"21000000",className:"form-input"})),g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Mint Limit (optional)"),g.createElement("input",{type:"text",value:X,onChange:e=>V(e.target.value),placeholder:"1000",className:"form-input"}))),("mint"===H||"transfer"===H)&&g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Amount"),g.createElement("input",{type:"text",value:F,onChange:e=>K(e.target.value),placeholder:"1000",className:"form-input"})),g.createElement("div",{className:"card"},g.createElement("div",{className:"text-xs mb-xs"},"Preview:"),g.createElement("pre",{className:"monospace text-xs",style:{overflow:"auto"}},W?G():"{}"))),("text"===s||"json"===s||"html"===s)&&g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Content ","json"===s&&"(JSON format)"),g.createElement("textarea",{value:a,onChange:e=>l(e.target.value),rows:10,placeholder:"json"===s?'{"name": "My Inscription", "description": "..."}':"html"===s?"<html><body>Your content here</body></html>":"Enter your text content here...",className:"form-textarea monospace"}),g.createElement("div",{className:"text-xs mt-xs",style:{opacity:.6}},"Size: ",new Blob([a]).size," bytes")),("image"===s||"file"===s)&&g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Select ","image"===s?"Image":"File"),g.createElement("input",{ref:L,type:"file",onChange:e=>{var t;const n=null==(t=e.target.files)?void 0:t[0];if(!n)return;h(n.name),b(n.type||"application/octet-stream");const r=new FileReader;r.onload=e=>{u(e.target.result)},r.readAsArrayBuffer(n)},accept:"image"===s?"image/*":"*/*",style:{display:"none"}}),g.createElement("button",{onClick:()=>{var e;return null==(e=L.current)?void 0:e.click()},className:"btn btn-secondary",style:{width:"100%",padding:"var(--spacing-xl)",flexDirection:"column",gap:"var(--spacing-sm)"}},g.createElement("div",{style:{fontSize:"2rem"}},"üìÅ"),g.createElement("div",null,p||"Click to select "+("image"===s?"an image":"a file")),c&&g.createElement("div",{className:"text-xs",style:{opacity:.6}},"Size: ",c.byteLength," bytes (",w,")"))),g.createElement("div",{style:{borderTop:"1px solid var(--color-border-dark)",paddingTop:"var(--spacing-lg)"}},g.createElement("details",null,g.createElement("summary",{className:"form-label",style:{cursor:"pointer",marginBottom:"var(--spacing-lg)"}},"‚öôÔ∏è Advanced Options"),g.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-lg)"}},g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Fee Rate (sat/vB)"),g.createElement("input",{type:"number",value:v,onChange:e=>E(Math.max(1,parseInt(e.target.value)||1)),min:"1",className:"form-input"}),g.createElement("div",{className:"text-xs mt-xs",style:{opacity:.6}},"Higher fee rates = faster confirmation")),"Xverse"===t.walletType&&g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"üîÑ Repeat Count (Batch Inscriptions)"),g.createElement("input",{type:"number",value:N,onChange:e=>x(Math.max(1,Math.min(100,parseInt(e.target.value)||1))),min:"1",max:"100",className:"form-input"}),g.createElement("div",{className:"text-xs mt-xs",style:{opacity:.6}},"Create multiple identical inscriptions in one transaction (Xverse only, max 100)")),g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Recipient Address (optional)"),g.createElement("input",{type:"text",value:S,onChange:e=>I(e.target.value),placeholder:"Leave empty to inscribe to your own address",className:"form-input monospace"})),g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Service Fee Address (optional)"),g.createElement("input",{type:"text",value:T,onChange:e=>P(e.target.value),placeholder:"Address to receive service fee",className:"form-input monospace"})),T&&g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Service Fee (sats)"),g.createElement("input",{type:"number",value:A,onChange:e=>B(Math.max(0,parseInt(e.target.value)||0)),min:"0",className:"w-full bg-black border-2 border-purple-900/50 rounded-xl px-4 py-3 text-white focus:border-purple-600 focus:outline-none"}))))),g.createElement("div",{className:"card"},g.createElement("h3",{className:"form-label mb-md"},"üí∞ Estimated Cost"),g.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"var(--spacing-md)",fontSize:"0.875rem"}},g.createElement("div",null,g.createElement("div",{style:{opacity:.6,marginBottom:"var(--spacing-xs)"}},"Content Size"),g.createElement("div",{style:{fontWeight:600}},z.size," bytes")),g.createElement("div",null,g.createElement("div",{style:{opacity:.6,marginBottom:"var(--spacing-xs)"}},"Estimated Fee"),g.createElement("div",{style:{fontWeight:600}},"~",z.estimatedSats," sats (",z.estimatedBTC," BTC)")),z.count>1&&g.createElement(g.Fragment,null,g.createElement("div",null,g.createElement("div",{style:{opacity:.6,marginBottom:"var(--spacing-xs)"}},"Per Inscription"),g.createElement("div",{style:{fontWeight:600}},"~",z.perInscription," sats")),g.createElement("div",null,g.createElement("div",{style:{opacity:.6,marginBottom:"var(--spacing-xs)"}},"Total Count"),g.createElement("div",{style:{fontWeight:600}},z.count," inscriptions")))),g.createElement("div",{className:"text-xs mt-md",style:{opacity:.5}},"* This is a rough estimate. Actual cost may vary.")),k&&g.createElement("div",{className:"error-message"},"‚ùå ",k),U&&g.createElement("div",{className:"success-message"},g.createElement("div",{style:{fontWeight:600,marginBottom:"var(--spacing-xs)"}},"‚úÖ ",U.message),U.txid&&g.createElement("div",{className:"text-xs monospace",style:{marginTop:"var(--spacing-xs)"}},g.createElement("span",{style:{opacity:.6}},"TX ID: "),g.createElement("span",null,U.txid)),U.inscriptionId&&g.createElement("div",{className:"text-xs monospace",style:{marginTop:"var(--spacing-xs)"}},g.createElement("span",{style:{opacity:.6}},"Inscription ID: "),g.createElement("span",null,U.inscriptionId))),g.createElement("div",{style:{display:"flex",gap:"var(--spacing-md)"}},g.createElement("button",{onClick:()=>f(e,null,function*(){C(!0),O(null),R(null);try{if((()=>{if("text"===s&&!a.trim())throw new Error("Text content cannot be empty");if("brc20"===s){if(!W.trim())throw new Error("BRC-20 ticker is required");if("deploy"===H&&(!$||parseFloat($)<=0))throw new Error("Max supply must be greater than 0");if(("mint"===H||"transfer"===H)&&(!F||parseFloat(F)<=0))throw new Error("Amount must be greater than 0")}if(("image"===s||"file"===s)&&!c)throw new Error("Please select a file");if(v<1)throw new Error("Fee rate must be at least 1 sat/vB")})(),!t.isConnected)throw new Error("No wallet connected");let e,n=w;"text"===s?(e=a,n="text/plain;charset=utf-8"):"json"===s?(e=a,n="application/json"):"html"===s?(e=a,n="text/html;charset=utf-8"):"brc20"===s?(e=G(),n="text/plain;charset=utf-8"):"image"!==s&&"file"!==s||(e=c);const i={contentType:n,feeRate:parseInt(v)};S.trim()&&(i.receiverAddress=S.trim()),T.trim()&&A>0&&(i.devAddress=T.trim(),i.devFee=parseInt(A));const o=N>1&&"Xverse"===t.walletType;let l;o?(i.repeat=parseInt(N),l=yield window.NexusWalletConnect.createRepeatInscriptions(e,i)):l=yield window.NexusWalletConnect.inscribe(e,i),R(d({message:o?`${N} inscriptions created successfully!`:"Inscription created successfully!",txid:l.txid||l.commitTxId||l.commitTx||l.txId,inscriptionId:l.inscriptionId,revealTxId:l.revealTxId||l.revealTxs&&l.revealTxs[0],repeatCount:o?N:1},l)),r&&r(l)}catch(e){O(e.message||"Failed to create inscription"),console.error("Inscription creation error:",e)}finally{C(!1)}}),disabled:_||!!U,className:"btn btn-primary btn-large",style:{flex:1}},_?"‚è≥ Creating...":U?"‚úÖ Created!":"‚úçÔ∏è Create Inscription"),g.createElement("button",{onClick:n,className:"btn btn-secondary"},U?"Close":"Cancel")))))},i=({isConnected:t,walletState:n})=>{var r,i,s;const[o,a]=m("bitcoin"),[l,c]=m(!1),[u,d]=m(null),[p,h]=m(null),[y,w]=m(""),[b,v]=m(""),[E,S]=m(""),[I,T]=m(""),[P,A]=m("Hello from Xverse!"),[B,N]=m(""),[x,_]=m("text/plain;charset=utf-8"),[C,k]=m("10"),[O,U]=m("5"),[R,L]=m(""),[H,M]=m(""),[W,q]=m(null),[F,K]=m(""),[$,D]=m(""),[X,V]=m(""),[j,G]=m(""),[z,Y]=m(""),[J,Q]=m("8"),[Z,ee]=m(""),[te,ne]=m(!1),re=()=>{d(null),h(null)},ie=e=>/^[A-Z]+(?:‚Ä¢[A-Z]+)*$/.test(e),se=e=>e&&(e.startsWith("bc1")||e.startsWith("tb1")||e.startsWith("1")||e.startsWith("3"))&&e.length>=26&&e.length<=90;return console.log("XversePanel render:",{isConnected:t,walletType:null==n?void 0:n.walletType,walletTypeLower:null==(r=null==n?void 0:n.walletType)?void 0:r.toLowerCase(),shouldRender:t&&"xverse"===(null==(i=null==n?void 0:n.walletType)?void 0:i.toLowerCase())}),t&&"xverse"===(null==(s=null==n?void 0:n.walletType)?void 0:s.toLowerCase())?g.createElement("div",{className:"xverse-panel"},g.createElement("div",{className:"xverse-header"},g.createElement("h2",null,"üü£ Xverse Wallet Features"),g.createElement("p",null,"Access all 16 Xverse Bitcoin methods")),g.createElement("div",{className:"xverse-tabs"},g.createElement("button",{className:"xverse-tab "+("bitcoin"===o?"active":""),onClick:()=>a("bitcoin")},"‚Çø Bitcoin Methods (6)"),g.createElement("button",{className:"xverse-tab "+("inscriptions"===o?"active":""),onClick:()=>a("inscriptions")},"üé® Inscription Methods (4)"),g.createElement("button",{className:"xverse-tab "+("runes"===o?"active":""),onClick:()=>a("runes")},"üî≤ Runes Methods (5)")),p&&g.createElement("div",{className:"xverse-error"},"‚ùå ",p,g.createElement("button",{onClick:re},"‚úï")),u&&g.createElement("div",{className:"xverse-result"},g.createElement("h3",null,"‚úÖ Result (",u.type,")"),g.createElement("pre",null,JSON.stringify(u.data,null,2)),g.createElement("button",{onClick:re},"Clear")),"bitcoin"===o&&g.createElement("div",{className:"xverse-content"},g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"1. Get Addresses"),g.createElement("p",null,"Retrieve payment and ordinals addresses"),g.createElement("button",{onClick:()=>f(e,null,function*(){re(),c(!0);try{const e=yield window.NexusWalletConnect.getAddresses(["ordinals","payment"]);d({type:"addresses",data:e})}catch(e){h(e.message)}finally{c(!1)}}),disabled:l},l?"Loading...":"Get Addresses")),g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"2. Sign Message"),g.createElement("input",{type:"text",placeholder:"Message to sign",value:P,onChange:e=>A(e.target.value)}),g.createElement("button",{onClick:()=>f(e,null,function*(){if(P){re(),c(!0);try{const e=yield window.NexusWalletConnect.signMessage(P);d({type:"signature",data:e})}catch(e){h(e.message)}finally{c(!1)}}else h("Please enter a message to sign")}),disabled:l},l?"Signing...":"Sign Message")),g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"3. Sign PSBT"),g.createElement("textarea",{placeholder:"Enter PSBT hex string",value:y,onChange:e=>w(e.target.value),rows:4}),g.createElement("button",{onClick:()=>f(e,null,function*(){if(y){re(),c(!0);try{const e=yield window.NexusWalletConnect.signPSBT(y);d({type:"signedPsbt",data:e})}catch(e){h(e.message)}finally{c(!1)}}else h("Please enter a PSBT hex string")}),disabled:l},l?"Signing...":"Sign PSBT")),g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"4. Send Transfer (sendTransfer)"),g.createElement("input",{type:"text",placeholder:"Recipient address",value:E,onChange:e=>S(e.target.value)}),g.createElement("input",{type:"number",placeholder:"Amount in BTC",value:I,onChange:e=>T(e.target.value),step:"0.00000001"}),g.createElement("button",{onClick:()=>f(e,null,function*(){if(E&&I){re(),c(!0);try{const e=Math.floor(1e8*parseFloat(I)),t=yield window.NexusWalletConnect.sendBitcoin(E,e);d({type:"txid",data:t})}catch(e){h(e.message)}finally{c(!1)}}else h("Please enter recipient address and amount")}),disabled:l},l?"Sending...":"Send Bitcoin")),g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"5. Sign Multiple Transactions"),g.createElement("textarea",{placeholder:"Enter PSBTs (one per line)",value:b,onChange:e=>v(e.target.value),rows:6}),g.createElement("button",{onClick:()=>f(e,null,function*(){if(b){re(),c(!0);try{const e=b.split("\n").filter(e=>e.trim()),t=window.NexusWalletConnect.getCurrentProvider(),n=yield t.signMultipleTransactions(e);d({type:"multipleSigned",data:n})}catch(e){h(e.message)}finally{c(!1)}}else h("Please enter PSBTs (one per line)")}),disabled:l},l?"Signing...":"Sign Multiple PSBTs")),g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"6. Get Balance"),g.createElement("p",null,"Retrieve wallet balance"),g.createElement("button",{onClick:()=>f(e,null,function*(){re(),c(!0);try{const e=yield window.NexusWalletConnect.getBalance();d({type:"balance",data:e})}catch(e){h(e.message)}finally{c(!1)}}),disabled:l},l?"Loading...":"Get Balance"))),"inscriptions"===o&&g.createElement("div",{className:"xverse-content"},g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"1. Create Inscription"),g.createElement("textarea",{placeholder:"Inscription content",value:B,onChange:e=>N(e.target.value),rows:4}),g.createElement("input",{type:"text",placeholder:"Content type",value:x,onChange:e=>_(e.target.value)}),g.createElement("input",{type:"number",placeholder:"Fee rate (sats/vB)",value:C,onChange:e=>k(e.target.value)}),g.createElement("button",{onClick:()=>f(e,null,function*(){if(B){re(),c(!0);try{const e=yield window.NexusWalletConnect.inscribe(B,{contentType:x,feeRate:parseInt(C)});d({type:"inscription",data:e})}catch(e){h(e.message)}finally{c(!1)}}else h("Please enter inscription content")}),disabled:l},l?"Creating...":"Create Inscription")),g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"2. Create Repeat Inscriptions (Batch)"),g.createElement("p",null,"Create multiple identical inscriptions"),g.createElement("textarea",{placeholder:"Inscription content",value:B,onChange:e=>N(e.target.value),rows:3}),g.createElement("input",{type:"number",placeholder:"Repeat count",value:O,onChange:e=>U(e.target.value),min:"1",max:"50"}),g.createElement("button",{onClick:()=>f(e,null,function*(){if(B&&O){re(),c(!0);try{const e={content:B,contentType:x,payloadType:"PLAIN_TEXT",repeat:parseInt(O),network:{type:"Mainnet"},suggestedMinerFeeRate:parseInt(C)},t=window.NexusWalletConnect.getCurrentProvider(),n=yield t.createRepeatInscriptions(e);d({type:"repeatInscriptions",data:n})}catch(e){h(e.message)}finally{c(!1)}}else h("Please enter inscription content and repeat count")}),disabled:l},l?"Creating...":`Create ${O} Inscriptions`)),g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"3. Get Inscriptions (ord_getInscriptions)"),g.createElement("p",null,"Retrieve all inscriptions in your wallet"),g.createElement("button",{onClick:()=>f(e,null,function*(){re(),c(!0);try{const e=yield window.NexusWalletConnect.getInscriptions();d({type:"inscriptions",data:e})}catch(e){h(e.message)}finally{c(!1)}}),disabled:l},l?"Loading...":"Get Inscriptions")),g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"4. Send Inscriptions (ord_sendInscriptions)"),g.createElement("input",{type:"text",placeholder:"Inscription IDs (comma-separated)",value:R,onChange:e=>L(e.target.value)}),g.createElement("input",{type:"text",placeholder:"Recipient address",value:H,onChange:e=>M(e.target.value)}),g.createElement("button",{onClick:()=>f(e,null,function*(){if(R&&H){re(),c(!0);try{const e=R.split(",").map(e=>e.trim()),t=window.NexusWalletConnect.getCurrentProvider(),n=yield t.sendInscriptions({recipient:H,inscriptionIds:e});d({type:"inscriptionsSent",data:n})}catch(e){h(e.message)}finally{c(!1)}}else h("Please enter inscription IDs and recipient address")}),disabled:l},l?"Sending...":"Send Inscriptions"))),"runes"===o&&g.createElement("div",{className:"xverse-content"},g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"1. Get Runes Balance (runes_getBalance)"),g.createElement("p",null,"Check your Runes holdings"),g.createElement("button",{onClick:()=>f(e,null,function*(){re(),c(!0);try{const e=window.NexusWalletConnect.getCurrentProvider(),t=yield e.getRunesBalance();q(t),d({type:"runesBalance",data:t})}catch(e){h(e.message)}finally{c(!1)}}),disabled:l},l?"Loading...":"Get Runes Balance"),W&&g.createElement("div",{className:"runes-balance-display"},g.createElement("pre",null,JSON.stringify(W,null,2)))),g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"2. Transfer Runes (runes_transfer)"),g.createElement("div",{className:"xverse-helper-box"},g.createElement("p",null,"üìù ",g.createElement("strong",null,"Format Requirements:")),g.createElement("ul",null,g.createElement("li",null,"Rune name: ",g.createElement("strong",null,"UPPERCASE‚Ä¢LETTERS")," (e.g., UNCOMMON‚Ä¢GOODS)"),g.createElement("li",null,"Address: Valid Bitcoin address (bc1, tb1, 1, or 3 prefix)"),g.createElement("li",null,"Amount: Must be greater than 0")),g.createElement("p",{className:"xverse-example"},"‚úÖ Example: UNCOMMON‚Ä¢GOODS")),g.createElement("div",{className:"xverse-input-group"},g.createElement("label",null,"Rune Name"),g.createElement("input",{type:"text",placeholder:"e.g., UNCOMMON‚Ä¢GOODS",value:$,onChange:e=>D(e.target.value),className:$&&!ie($)?"xverse-input-invalid":""}),$&&!ie($)&&g.createElement("span",{className:"xverse-validation-error"},"‚ùå Use UPPERCASE letters with ‚Ä¢ separator"),$&&ie($)&&g.createElement("span",{className:"xverse-validation-success"},"‚úÖ Valid format")),g.createElement("div",{className:"xverse-input-group"},g.createElement("label",null,"Recipient Address"),g.createElement("input",{type:"text",placeholder:"bc1q... or tb1q...",value:F,onChange:e=>K(e.target.value),className:F&&!se(F)?"xverse-input-invalid":""}),F&&!se(F)&&g.createElement("span",{className:"xverse-validation-error"},"‚ùå Invalid Bitcoin address"),F&&se(F)&&g.createElement("span",{className:"xverse-validation-success"},"‚úÖ Valid address")),g.createElement("div",{className:"xverse-input-group"},g.createElement("label",null,"Amount"),g.createElement("input",{type:"text",placeholder:"Amount to transfer",value:X,onChange:e=>V(e.target.value),className:X&&(isNaN(X)||parseFloat(X)<=0)?"xverse-input-invalid":""}),X&&(isNaN(X)||parseFloat(X)<=0)&&g.createElement("span",{className:"xverse-validation-error"},"‚ùå Amount must be greater than 0")),g.createElement("button",{onClick:()=>f(e,null,function*(){if($.trim())if(ie($))if(F.trim())if(se(F))if(!X||parseFloat(X)<=0)h("‚ùå Amount must be greater than 0");else{re(),c(!0);try{const e=window.NexusWalletConnect.getCurrentProvider(),t=yield e.transferRunes({recipient:F,runeName:$,amount:X});d({type:"runesTransfer",data:t}),K(""),D(""),V("")}catch(e){const t=e.message||"Unknown error";t.includes("insufficient")?h("‚ùå Insufficient rune balance"):t.includes("not found")?h("‚ùå Rune not found in your wallet"):t.includes("cancel")?h("‚ö†Ô∏è Transaction cancelled by user"):h(`‚ùå Transfer failed: ${t}`)}finally{c(!1)}}else h("‚ùå Invalid Bitcoin address format");else h("‚ùå Recipient address is required");else h("‚ùå Invalid rune name format. Use uppercase letters with ‚Ä¢ separator (e.g., UNCOMMON‚Ä¢GOODS)");else h("‚ùå Rune name is required")}),disabled:l||!$||!F||!X,className:$&&F&&X?"":"xverse-button-disabled"},l?"Transferring...":"Transfer Runes")),g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"3. Mint Runes"),g.createElement("div",{className:"xverse-helper-box"},g.createElement("p",null,"üìù ",g.createElement("strong",null,"Format Requirements:")),g.createElement("ul",null,g.createElement("li",null,"Rune name: ",g.createElement("strong",null,"UPPERCASE‚Ä¢LETTERS")," (e.g., UNCOMMON‚Ä¢GOODS)"),g.createElement("li",null,"Note: Only mintable runes can be minted (check runes_getBalance)")),g.createElement("p",{className:"xverse-example"},"‚úÖ Example: UNCOMMON‚Ä¢GOODS")),g.createElement("div",{className:"xverse-input-group"},g.createElement("label",null,"Rune Name to Mint"),g.createElement("input",{type:"text",placeholder:"e.g., UNCOMMON‚Ä¢GOODS",value:$,onChange:e=>D(e.target.value),className:$&&!ie($)?"xverse-input-invalid":""}),$&&!ie($)&&g.createElement("span",{className:"xverse-validation-error"},"‚ùå Use UPPERCASE letters with ‚Ä¢ separator"),$&&ie($)&&g.createElement("span",{className:"xverse-validation-success"},"‚úÖ Valid format")),g.createElement("button",{onClick:()=>f(e,null,function*(){if($.trim())if(ie($)){re(),c(!0);try{const e=window.NexusWalletConnect.getCurrentProvider(),t=yield e.mintRunes({runeName:$});d({type:"runesMint",data:t}),D("")}catch(e){const t=e.message||"Unknown error";t.includes("not mintable")?h("‚ùå This rune is not mintable or minting has ended"):t.includes("not found")?h("‚ùå Rune not found. Check the name and try again"):t.includes("cancel")?h("‚ö†Ô∏è Minting cancelled by user"):h(`‚ùå Minting failed: ${t}`)}finally{c(!1)}}else h("‚ùå Invalid rune name format. Use uppercase letters with ‚Ä¢ separator (e.g., UNCOMMON‚Ä¢GOODS)");else h("‚ùå Rune name is required")}),disabled:l||!$,className:$?"":"xverse-button-disabled"},l?"Minting...":"Mint Runes")),g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"4. Etch Runes (Create New Rune)"),g.createElement("div",{className:"xverse-helper-box"},g.createElement("p",null,"üìù ",g.createElement("strong",null,"Format Requirements:")),g.createElement("ul",null,g.createElement("li",null,"Rune name: ",g.createElement("strong",null,"UPPERCASE‚Ä¢LETTERS")," (e.g., UNCOMMON‚Ä¢GOODS)"),g.createElement("li",null,"Length: 3-28 characters (including ‚Ä¢ separators)"),g.createElement("li",null,"Symbol: Single character (optional, e.g., $, ¬¢, ‚Çø)"),g.createElement("li",null,"Divisibility: 0-38 (0 = no decimals, 8 = like Bitcoin)"),g.createElement("li",null,"Premine: Number of runes to mint immediately (optional)"),g.createElement("li",null,"Turbo: Enable turbo mode for faster etching (optional)")),g.createElement("p",{className:"xverse-example"},"‚úÖ Examples: UNCOMMON‚Ä¢GOODS, MY‚Ä¢NEW‚Ä¢RUNE, SATOSHI‚Ä¢NAKAMOTO")),g.createElement("div",{className:"xverse-input-group"},g.createElement("label",null,"Rune Name (Required)"),g.createElement("input",{type:"text",placeholder:"e.g., UNCOMMON‚Ä¢GOODS",value:$,onChange:e=>D(e.target.value),className:$&&!ie($)?"xverse-input-invalid":""}),$&&!ie($)&&g.createElement("span",{className:"xverse-validation-error"},"‚ùå Use UPPERCASE letters with ‚Ä¢ separator"),$&&ie($)&&$.length<3&&g.createElement("span",{className:"xverse-validation-error"},"‚ùå Name must be at least 3 characters"),$&&ie($)&&$.length>28&&g.createElement("span",{className:"xverse-validation-error"},"‚ùå Name must be 28 characters or less"),$&&ie($)&&$.length>=3&&$.length<=28&&g.createElement("span",{className:"xverse-validation-success"},"‚úÖ Valid format (",$.length," characters)")),g.createElement("div",{className:"xverse-input-group"},g.createElement("label",null,"Symbol (Optional)"),g.createElement("input",{type:"text",placeholder:"e.g., $ or ¬¢ or ‚Çø",value:z,onChange:e=>Y(e.target.value.slice(0,1)),maxLength:"1"}),g.createElement("span",{className:"xverse-help-text"},"Single character symbol for display")),g.createElement("div",{className:"xverse-input-group"},g.createElement("label",null,"Divisibility (Optional)"),g.createElement("input",{type:"number",placeholder:"0-38 (default: 8)",value:J,onChange:e=>Q(e.target.value),min:"0",max:"38",className:J&&(parseInt(J)<0||parseInt(J)>38)?"xverse-input-invalid":""}),J&&(parseInt(J)<0||parseInt(J)>38)&&g.createElement("span",{className:"xverse-validation-error"},"‚ùå Divisibility must be between 0 and 38"),g.createElement("span",{className:"xverse-help-text"},"0 = no decimals, 8 = like Bitcoin (default)")),g.createElement("div",{className:"xverse-input-group"},g.createElement("label",null,"Premine Amount (Optional)"),g.createElement("input",{type:"text",placeholder:"e.g., 1000000",value:Z,onChange:e=>ee(e.target.value)}),g.createElement("span",{className:"xverse-help-text"},"Number of runes to mint immediately to your address")),g.createElement("div",{className:"xverse-input-group xverse-checkbox-group"},g.createElement("label",null,g.createElement("input",{type:"checkbox",checked:te,onChange:e=>ne(e.target.checked)}),g.createElement("span",null,"Enable Turbo Mode")),g.createElement("span",{className:"xverse-help-text"},"Faster etching with higher fees")),g.createElement("button",{onClick:()=>f(e,null,function*(){if(!$.trim())return void h("‚ùå Rune name is required");const e=$.toUpperCase().replace(/[.\s]/g,"‚Ä¢");if(!ie(e))return void h("‚ùå Invalid rune name. Use letters only (will be converted to UPPERCASE‚Ä¢FORMAT)");if(e.length<3)return void h("‚ùå Rune name must be at least 3 characters");if(e.length>28)return void h("‚ùå Rune name must be 28 characters or less");const t=parseInt(J);if(isNaN(t)||t<0||t>38)h("‚ùå Divisibility must be between 0 and 38");else{re(),c(!0);try{const n=window.NexusWalletConnect.getCurrentProvider(),r={runeName:e,symbol:z||"‚ö°",divisibility:t};Z&&parseFloat(Z)>0&&(r.premine=Z),te&&(r.turbo=!0);const i=yield n.etchRunes(r);d({type:"runesEtch",data:i}),D(""),Y(""),Q("8"),ee(""),ne(!1)}catch(n){const e=n.message||"Unknown error";e.includes("already exists")?h("‚ùå This rune name already exists"):e.includes("invalid name")?h("‚ùå Invalid rune name format"):e.includes("cancel")?h("‚ö†Ô∏è Etching cancelled by user"):e.includes("fee")?h("‚ùå Insufficient funds for etching fee"):h(`‚ùå Etching failed: ${e}`)}finally{c(!1)}}}),disabled:l||!$,className:$?"":"xverse-button-disabled"},l?"Etching...":"Etch Runes")),g.createElement("div",{className:"xverse-section"},g.createElement("h3",null,"5. Get Runes Order (runes_getOrder)"),g.createElement("p",null,"Check status of a rune mint/etch order"),g.createElement("div",{className:"xverse-input-group"},g.createElement("label",null,"Order ID"),g.createElement("input",{type:"text",placeholder:"Order ID from mint or etch operation",value:j,onChange:e=>G(e.target.value)})),g.createElement("button",{onClick:()=>f(e,null,function*(){if(j){re(),c(!0);try{const e=window.NexusWalletConnect.getCurrentProvider(),t=yield e.getRunesOrder(j);d({type:"runesOrder",data:t})}catch(e){h(e.message)}finally{c(!1)}}else h("Please enter order ID")}),disabled:l||!j,className:j?"":"xverse-button-disabled"},l?"Checking...":"Get Order Status"))),l&&g.createElement("div",{className:"xverse-loading"},g.createElement("div",{className:"spinner"}),g.createElement("p",null,"Processing..."))):(console.log("XversePanel: Not rendering - conditions not met"),null)},s=e=>{if(!Number.isInteger(e)||e<0)throw new Error("varInt: invalid n");if(e<253)return[e];throw new Error("varInt: values >= 0xfd not supported in sample")},o=e=>[255&e,e>>>8&255,e>>>16&255,e>>>24&255],a=e=>{const t=Number(e);if(!Number.isFinite(t)||t<0)throw new Error("u64le: invalid n");const n=t>>>0,r=Math.floor(t/4294967296)>>>0;return[255&n,n>>>8&255,n>>>16&255,n>>>24&255,255&r,r>>>8&255,r>>>16&255,r>>>24&255]},l=e=>{let t="";for(let n=0;n<e.length;n+=32768){const r=e.subarray(n,n+32768);t+=String.fromCharCode(...r)}return btoa(t)},u=(...e)=>{const t=e.reduce((e,t)=>e+t.length,0),n=new Uint8Array(t);let r=0;for(const i of e)n.set(i,r),r+=i.length;return n},E=()=>{const e=(()=>{const e=String("70736274ff").replace(/\s+/g,"");if(e.length%2!=0)throw new Error("hexToBytes: odd length");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++)t[n]=parseInt(e.slice(2*n,2*n+2),16);return t})(),t=(()=>{const e=new Uint8Array(32);e.fill(17);const t=new Uint8Array(22);t[0]=0,t[1]=20,t.fill(34,2);const n=new Uint8Array(o(2)),r=new Uint8Array([0,1]),i=new Uint8Array(s(1)),l=new Uint8Array(s(1)),c=new Uint8Array(o(0)),d=new Uint8Array([0]),p=new Uint8Array([255,255,255,255]),h=new Uint8Array(a(5e4)),f=new Uint8Array(s(t.length)),g=new Uint8Array([0]),m=new Uint8Array(o(0));return u(n,r,i,e,c,d,p,l,h,f,t,g,m)})(),n=new Uint8Array([0]),r=u(new Uint8Array(s(n.length)),n,new Uint8Array(s(t.length)),t),i=new Uint8Array([0]),c=(()=>{const e=new Uint8Array(22);return e[0]=0,e[1]=20,e.fill(51,2),u(new Uint8Array(a(1e5)),new Uint8Array(s(e.length)),e)})(),d=new Uint8Array([1]),p=u(new Uint8Array(s(d.length)),d,new Uint8Array(s(c.length)),c),h=new Uint8Array([1,0,0,0]),f=new Uint8Array([3]),g=u(new Uint8Array(s(f.length)),f,new Uint8Array(s(h.length)),h),m=new Uint8Array([0]),y=new Uint8Array([0]),w=u(e,r,i,p,g,m,y);return{base64:l(w),hex:(b=w,Array.from(b||[]).map(e=>e.toString(16).padStart(2,"0")).join(""))};var b},S=()=>{const[t,n]=m(null),[r,i]=m(""),[s,o]=m({}),[a,l]=m({}),[c,u]=m([]),[h,y]=m(!1),[b,v]=m({message:"Hello from NexusWalletConnect!",psbtHex:(()=>{try{return E().base64}catch(e){return""}})(),network:"testnet",toAddress:"",amount:1e4,inscriptionCursor:0,inscriptionSize:20,brc20Tick:"ordi",inscriptionContent:"Hello Bitcoin!",inscriptionContentType:"text/plain;charset=utf-8",inscriptionId:"",utxoTxid:"",utxoVout:0,assetName:"My Asset"});w(()=>{var e,t;const r=null==(e=window.NexusWalletConnect)?void 0:e.getCurrentProvider(),s=null==(t=window.NexusWalletConnect)?void 0:t.getState();r&&(null==s?void 0:s.walletType)&&(n(r),i(s.walletType),S(r))},[]);const S=e=>{var t,n,r;const i=[];"function"==typeof e.getAddress&&i.push({category:"Connection",name:"getAddress",description:"Get the wallet address",params:[],code:"const address = await provider.getAddress();"}),"function"==typeof e.getPublicKey&&i.push({category:"Connection",name:"getPublicKey",description:"Get the wallet public key",params:[],code:"const publicKey = await provider.getPublicKey();"}),"function"==typeof e.getAccounts&&i.push({category:"Connection",name:"getAccounts",description:"Get all wallet accounts",params:[],code:"const accounts = await provider.getAccounts();"}),"function"==typeof e.getBalance&&i.push({category:"Balance & Network",name:"getBalance",description:"Get wallet balance",params:[],code:"const balance = await provider.getBalance();\n// Returns: { confirmed: 0, unconfirmed: 0, total: 0 }"}),"function"==typeof e.getNetwork&&i.push({category:"Balance & Network",name:"getNetwork",description:"Get current network",params:[],code:'const network = await provider.getNetwork();\n// Returns: "mainnet" or "testnet"'}),"function"==typeof e.switchNetwork&&i.push({category:"Balance & Network",name:"switchNetwork",description:"Switch to different network",params:["network"],code:"await provider.switchNetwork('testnet');\n// Options: 'mainnet' or 'testnet'"}),"function"==typeof e.signMessage&&i.push({category:"Signing",name:"signMessage",description:"Sign a text message",params:["message","type"],code:"const signature = await provider.signMessage('Hello World', 'ecdsa');\n// type: 'ecdsa' or 'bip322-simple'"}),"function"==typeof e.signPsbt&&i.push({category:"Signing",name:"signPsbt",description:"Sign a PSBT transaction",params:["psbtHex","options"],code:"const signedPsbt = await provider.signPsbt(psbtHex, {\n  autoFinalized: true,\n  toSignInputs: []\n});"}),"function"==typeof e.signPsbts&&i.push({category:"Signing",name:"signPsbts",description:"Sign multiple PSBTs",params:["psbtHexs","options"],code:"const signedPsbts = await provider.signPsbts([psbt1, psbt2], [options1, options2]);"}),"function"==typeof e.sendBitcoin&&i.push({category:"Transactions",name:"sendBitcoin",description:"Send Bitcoin to address",params:["toAddress","satoshis","options"],code:"const txid = await provider.sendBitcoin(\n  'bc1q...address',\n  10000, // satoshis\n  { feeRate: 5 }\n);"}),"function"==typeof e.pushPsbt&&i.push({category:"Transactions",name:"pushPsbt",description:"Broadcast a signed PSBT",params:["psbtHex"],code:"const txid = await provider.pushPsbt(signedPsbtHex);"}),"function"==typeof e.pushTx&&i.push({category:"Transactions",name:"pushTx",description:"Broadcast a raw transaction",params:["rawTxHex"],code:"const txid = await provider.pushTx(rawTxHex);"}),"function"==typeof e.getInscriptions&&i.push({category:"Inscriptions",name:"getInscriptions",description:"Get inscriptions (paginated)",params:["cursor","size"],code:"const result = await provider.getInscriptions(0, 20);\n// Returns: { list: [...], total: 100 }"}),"function"==typeof e.getAllInscriptions&&i.push({category:"Inscriptions",name:"getAllInscriptions",description:"Get all inscriptions",params:[],code:"const inscriptions = await provider.getAllInscriptions();\n// Returns: [inscription1, inscription2, ...]"}),"function"==typeof e.sendInscription&&i.push({category:"Inscriptions",name:"sendInscription",description:"Send an inscription to address",params:["toAddress","inscriptionId","options"],code:"const txid = await provider.sendInscription(\n  'bc1q...address',\n  'inscription_id',\n  { feeRate: 5 }\n);"}),"function"==typeof e.inscribe&&i.push({category:"BRC-20 & Inscriptions",name:"inscribe",description:"Create a new inscription",params:["content","options"],code:"// Universal inscribe - works across all wallets\nconst result = await provider.inscribe('Hello World', {\n  contentType: 'text/plain;charset=utf-8',\n  feeRate: 5\n});\n\n// Result formats vary by wallet:\n// - OKX: { commitTx, revealTxs[], commitTxFee, revealTxFees[] }\n// - Xverse: { commitTxId, revealTxId, totalFee }\n// - UniSat: { txid }\n// Always access: result.txid || result.commitTxId || result.commitTx"}),"function"==typeof e.createInscription&&i.push({category:"BRC-20 & Inscriptions",name:"createInscription",description:"Create inscription (Xverse native)",params:["inscriptionData"],code:"const result = await provider.createInscription({\n  content: 'Hello World',\n  contentType: 'text/plain;charset=utf-8',\n  feeRate: 5\n});"}),"function"==typeof e.createRepeatInscriptions&&i.push({category:"BRC-20 & Inscriptions",name:"createRepeatInscriptions",description:"Create multiple inscriptions (Xverse)",params:["payload"],code:"const result = await provider.createRepeatInscriptions({\n  content: 'Hello World',\n  contentType: 'text/plain;charset=utf-8',\n  payloadType: 'PLAIN_TEXT',\n  repeat: 5,\n  network: { type: 'Mainnet' },\n  suggestedMinerFeeRate: 10\n});"}),"function"==typeof e.sendRunes&&i.push({category:"Runes",name:"sendRunes",description:"Send Runes tokens",params:["toAddress","runeName","amount"],code:"const txid = await provider.sendRunes(\n  'bc1q...address',\n  'UNCOMMON‚Ä¢GOODS',\n  1000\n);"}),"function"==typeof e.getRunesBalance&&i.push({category:"Runes",name:"getRunesBalance",description:"Get Runes balance (Xverse)",params:[],code:"const balance = await provider.getRunesBalance();"}),"function"==typeof e.transferRunes&&i.push({category:"Runes",name:"transferRunes",description:"Transfer Runes (Xverse)",params:["transferParams"],code:"const result = await provider.transferRunes({\n  recipient: 'bc1q...address',\n  runeName: 'UNCOMMON‚Ä¢GOODS',\n  amount: '1000'\n});"}),"function"==typeof e.mintRunes&&i.push({category:"Runes",name:"mintRunes",description:"Mint Runes (Xverse)",params:["mintParams"],code:"const result = await provider.mintRunes({\n  runeName: 'UNCOMMON‚Ä¢GOODS',\n  amount: '1000'\n});"}),"function"==typeof e.etchRunes&&i.push({category:"Runes",name:"etchRunes",description:"Etch (create) Runes (Xverse)",params:["etchParams"],code:"const result = await provider.etchRunes({\n  name: 'MY‚Ä¢RUNE',\n  symbol: 'MR',\n  divisibility: 8\n});"}),"function"==typeof e.getRunesOrder&&i.push({category:"Runes",name:"getRunesOrder",description:"Get Runes order status (Xverse)",params:["orderId"],code:"const order = await provider.getRunesOrder('order_id_here');"}),"function"==typeof e.speedUpRunesOrder&&i.push({category:"Runes",name:"speedUpRunesOrder",description:"Speed up Runes order (Xverse)",params:["orderId","newFeeRate"],code:"const result = await provider.speedUpRunesOrder(\n  'order_id_here',\n  50  // new fee rate in sats/vB\n);"}),"function"==typeof e.sendInscriptions&&i.push({category:"Inscriptions",name:"sendInscriptions",description:"Send inscriptions (Xverse)",params:["sendParams"],code:"const result = await provider.sendInscriptions({\n  recipient: 'bc1q...address',\n  inscriptionIds: ['inscription_id_1', 'inscription_id_2']\n});"}),"function"==typeof e.detectBitmaps&&i.push({category:"BitmapWallet Methods",name:"detectBitmaps",description:"Detect Bitmap inscriptions (BitmapWallet)",params:[],code:"const bitmaps = await provider.detectBitmaps();\n// Returns array of bitmap inscriptions"}),"function"==typeof e.getRunes&&i.push({category:"BitmapWallet Methods",name:"getRunes",description:"Get Runes tokens (BitmapWallet)",params:["address"],code:"const runes = await provider.getRunes(address);\n// Returns array of rune balances"}),"function"==typeof e.getRareSats&&i.push({category:"BitmapWallet Methods",name:"getRareSats",description:"Get rare satoshis (BitmapWallet)",params:["address"],code:"const rareSats = await provider.getRareSats(address);\n// Returns array of rare/exotic satoshis"}),"function"==typeof e.getSpendableUtxos&&i.push({category:"BitmapWallet Methods",name:"getSpendableUtxos",description:"Get spendable UTXOs (BitmapWallet)",params:["address"],code:"const utxos = await provider.getSpendableUtxos(address);\n// Returns array of spendable UTXOs"}),"function"==typeof e.getAddresses&&i.push({category:"Bitcoin",name:"getAddresses",description:"Get payment & ordinals addresses (Xverse)",params:["purposes"],code:"const addresses = await provider.getAddresses(['ordinals', 'payment']);\n// Returns array of address objects"}),"function"==typeof e.sendTransfer&&i.push({category:"Bitcoin",name:"sendTransfer",description:"Send Bitcoin transfer (Xverse)",params:["params"],code:"const result = await provider.sendTransfer({\n  recipients: [{\n    address: 'bc1q...address',\n    amountSats: 10000\n  }]\n});"}),"function"==typeof e.signMultipleTransactions&&i.push({category:"Bitcoin",name:"signMultipleTransactions",description:"Sign multiple PSBTs (Xverse)",params:["psbtArray","options"],code:"const results = await provider.signMultipleTransactions([\n  'psbt_base64_1',\n  'psbt_base64_2'\n], { broadcast: false });"}),"function"==typeof e.multiSignMessage&&i.push({category:"UniSat Methods",name:"multiSignMessage",description:"Sign multiple messages at once (UniSat)",params:["messages","type"],code:"const signatures = await provider.multiSignMessage([\n  'Message 1',\n  'Message 2'\n], 'ecdsa');\n// Returns array of signatures"}),"function"==typeof e.signData&&i.push({category:"UniSat Methods",name:"signData",description:"Sign arbitrary data (UniSat)",params:["data","type"],code:"const signature = await provider.signData('0x1234...', 'ecdsa');\n// Sign hex data directly"}),"function"==typeof e.getChain&&i.push({category:"UniSat Methods",name:"getChain",description:"Get current blockchain (UniSat)",params:[],code:"const chain = await provider.getChain();\n// Returns: 'BITCOIN_MAINNET', 'BITCOIN_TESTNET', etc."}),"function"==typeof e.switchChain&&i.push({category:"UniSat Methods",name:"switchChain",description:"Switch blockchain (UniSat)",params:["chain"],code:"await provider.switchChain('BITCOIN_TESTNET');\n// Options: BITCOIN_MAINNET, BITCOIN_TESTNET, FRACTAL_BITCOIN_MAINNET"}),"function"==typeof e.verifyMessageOfBIP322Simple&&i.push({category:"UniSat Methods",name:"verifyMessageOfBIP322Simple",description:"Verify BIP-322 signature (UniSat)",params:["address","message","signature"],code:"const isValid = await provider.verifyMessageOfBIP322Simple(\n  'bc1q...address',\n  'Hello World',\n  'signature_here'\n);\n// Returns: true or false"}),"function"==typeof e.inscribeTransfer&&i.push({category:"BRC-20 & Inscriptions",name:"inscribeTransfer",description:"Create BRC-20 transfer inscription",params:["tick","amount"],code:"// Create BRC-20 transfer inscription (UniSat, OKX)\nconst result = await provider.inscribeTransfer('ordi', '100');\n// UniSat returns: txid string\n// OKX returns: { commitTx, revealTxs[], commitTxFee, revealTxFees[] }"}),"function"==typeof e.splitUtxo&&i.push({category:"OKX Methods",name:"splitUtxo",description:"Split UTXO for multiple operations (OKX)",params:["splitCount"],code:"// Split a UTXO into multiple outputs\nconst result = await provider.splitUtxo(5);\n// Useful before creating multiple inscriptions"}),"function"==typeof e.transferNft&&i.push({category:"OKX Methods",name:"transferNft",description:"Transfer NFT/inscription (OKX)",params:["toAddress","inscriptionId"],code:"const result = await provider.transferNft(\n  'bc1q...address',\n  'inscription_id_here'\n);"}),"function"==typeof e.watchAsset&&i.push({category:"OKX Methods",name:"watchAsset",description:"Add asset to wallet watch list (OKX)",params:["assetInfo"],code:"const result = await provider.watchAsset({\n  type: 'BRC20',\n  tick: 'ordi'\n});"}),"function"==typeof e.mint&&i.push({category:"OKX Methods",name:"mint",description:"Create inscription with advanced options (OKX)",params:["mintParams"],code:"// OKX mint method - for general inscriptions\nconst result = await provider.mint({\n  type: 61, // 61=text, 62=image, 60=BRC-20 deploy, 51=BRC-20 transfer\n  from: address,\n  inscriptions: [{\n    contentType: 'text/plain;charset=utf-8',\n    body: 'Hello Bitcoin!'\n  }]\n});\n// Returns: { commitTx, revealTxs[], commitTxFee, ... }"}),"function"==typeof e.getBitcoinUtxos&&i.push({category:"Advanced",name:"getBitcoinUtxos",description:"Get unspent transaction outputs",params:[],code:"const utxos = await provider.getBitcoinUtxos();\n// Returns: [{ txid, vout, satoshis, ... }, ...]"}),(null==(t=window.NexusWalletConnect)?void 0:t.getCapabilities)&&i.push({category:"Utility",name:"getCapabilities",description:"Get wallet capabilities and features",params:[],code:"const capabilities = window.NexusWalletConnect.getCapabilities();\n// Returns: { walletType, methods: [...], features: {...} }"}),(null==(n=window.NexusWalletConnect)?void 0:n.getUtxos)&&i.push({category:"Utility",name:"getUtxos",description:"Get UTXOs (wrapper for provider method)",params:[],code:"const utxos = await window.NexusWalletConnect.getUtxos();\n// Unified format across all wallets"}),(null==(r=window.NexusWalletConnect)?void 0:r.getBRC20List)&&i.push({category:"Utility",name:"getBRC20List",description:"Get BRC-20 tokens (wrapper for provider method)",params:[],code:"const brc20s = await window.NexusWalletConnect.getBRC20List();\n// Unified format across all wallets"}),u(i)},I=c.reduce((e,t)=>(e[t.category]||(e[t.category]=[]),e[t.category].push(t),e),{});return t?g.createElement("div",{className:"wallet-tester"},g.createElement("div",{className:"tester-header"},g.createElement("h2",null,"üß™ ",r," Wallet - Method Testing"),g.createElement("p",{className:"tester-subtitle"},"Found ",g.createElement("strong",null,c.length," available methods")),g.createElement("div",{className:"dev-notice"},g.createElement("strong",null,"üìö Developer Reference"),g.createElement("p",null,"This testing page demonstrates how to properly call all wallet methods using the NexusWalletConnect library. All code snippets show the exact syntax needed for your application."),g.createElement("p",null,g.createElement("strong",null,"Latest Updates:")," OKX provider now uses correct inscription API format (inscribe with type, from, tick/inscriptions parameters). All wallets support multi-format result handling. Added UniSat-specific methods: multiSignMessage, signData, getChain, switchChain, verifyMessageOfBIP322Simple."),g.createElement("p",null,g.createElement("strong",null,"‚ö†Ô∏è Testing Notes:")," For ",g.createElement("code",null,"sendBitcoin")," and other transaction methods, ensure you have sufficient balance and provide a valid recipient address. Xverse requires addresses in the correct network format (bc1 for mainnet, tb1 for testnet). Some methods like ",g.createElement("code",null,"inscribe")," and ",g.createElement("code",null,"sendBitcoin")," will prompt wallet confirmation.")),g.createElement("div",{className:"batch-actions"},g.createElement("button",{onClick:()=>f(e,null,function*(){var t,n,r;if(!window.NexusWalletConnect)return void alert("‚ùå NexusWalletConnect not available");const i=["UniSat","Xverse","OKX","Wizz","Phantom","Oyl","Leather","MagicEden","BitmapWallet"],s=[{name:"getAddress",category:"Connection",destructive:!1},{name:"getPublicKey",category:"Connection",destructive:!1},{name:"getAccounts",category:"Connection",destructive:!1},{name:"getAddresses",category:"Connection",destructive:!1},{name:"requestAccounts",category:"Connection",destructive:!1},{name:"getVersion",category:"Connection",destructive:!1},{name:"getBalance",category:"Balance & Network",destructive:!1},{name:"getBalanceV2",category:"Balance & Network",destructive:!1},{name:"getNetwork",category:"Balance & Network",destructive:!1},{name:"switchNetwork",category:"Balance & Network",destructive:!0},{name:"signMessage",category:"Signing",destructive:!1,requiresUserConfirmation:!0},{name:"signPsbt",category:"Signing",destructive:!1,requiresUserConfirmation:!0},{name:"signPsbts",category:"Signing",destructive:!1,requiresUserConfirmation:!0},{name:"signTransaction",category:"Signing",destructive:!1,requiresUserConfirmation:!0},{name:"signMultipleTransactions",category:"Signing",destructive:!1,requiresUserConfirmation:!0},{name:"sendBitcoin",category:"Transactions",destructive:!1,requiresUserConfirmation:!0},{name:"pushPsbt",category:"Transactions",destructive:!0},{name:"pushTx",category:"Transactions",destructive:!0},{name:"getBitcoinUtxos",category:"Transactions",destructive:!1},{name:"getInscriptions",category:"Inscriptions",destructive:!1},{name:"getAllInscriptions",category:"Inscriptions",destructive:!1},{name:"sendInscription",category:"Inscriptions",destructive:!1,requiresUserConfirmation:!0},{name:"inscribe",category:"Inscriptions",destructive:!1,requiresUserConfirmation:!0},{name:"inscribeTransfer",category:"Inscriptions",destructive:!1,requiresUserConfirmation:!0},{name:"createInscription",category:"Inscriptions",destructive:!1,requiresUserConfirmation:!0},{name:"createRepeatInscriptions",category:"Inscriptions",destructive:!1,requiresUserConfirmation:!0},{name:"sendInscriptions",category:"Inscriptions",destructive:!1,requiresUserConfirmation:!0},{name:"getAddresses",category:"Bitcoin",destructive:!1},{name:"sendTransfer",category:"Bitcoin",destructive:!0},{name:"sendRunes",category:"Runes",destructive:!1,requiresUserConfirmation:!0},{name:"getRunes",category:"Runes",destructive:!1},{name:"getRuneBalance",category:"Runes",destructive:!1},{name:"getRunesBalance",category:"Runes",destructive:!1},{name:"transferRunes",category:"Runes",destructive:!1,requiresUserConfirmation:!0},{name:"mintRunes",category:"Runes",destructive:!1,requiresUserConfirmation:!0},{name:"etchRunes",category:"Runes",destructive:!1,requiresUserConfirmation:!0},{name:"getRunesOrder",category:"Runes",destructive:!1},{name:"speedUpRunesOrder",category:"Runes",destructive:!1,requiresUserConfirmation:!0},{name:"detectBitmaps",category:"BitmapWallet",destructive:!1},{name:"getRareSats",category:"BitmapWallet",destructive:!1},{name:"getSpendableUtxos",category:"BitmapWallet",destructive:!1},{name:"request",category:"Advanced",destructive:!1},{name:"on",category:"Advanced",destructive:!1},{name:"removeListener",category:"Advanced",destructive:!1},{name:"getCapabilities",category:"Utility",destructive:!1},{name:"getUtxos",category:"Utility",destructive:!1},{name:"getBRC20List",category:"Utility",destructive:!1}],o=[],a={},l={};o.push("# Complete Wallet Capability Matrix & Test Report"),o.push(`\nGenerated: ${(new Date).toLocaleString()}`),o.push("\nTest Inputs Used:"),o.push(`- Message: "${b.message}"`),o.push(`- Address: ${b.toAddress||"Not provided"}`),o.push(`- Amount: ${b.amount} satoshis`),o.push(`\n${"=".repeat(80)}\n`),y(!0);for(const y of i){console.log(`\nüîç Testing ${y}...`),a[y]={},l[y]={connected:!1,methods:{}};try{const i=(null==(t=window.NexusWalletConnect)?void 0:t.connectSmart)||(null==(n=window.NexusWalletConnect)?void 0:n.connect);if(!i||!(yield i(y))){console.log(`‚ùå ${y} not installed or connection failed`),l[y].connected=!1,l[y].error="Not installed or connection failed",s.forEach(e=>{a[y][e.name]="‚ùå Not Installed"});continue}const o=window.NexusWalletConnect.getCurrentProvider();if(!o){console.log(`‚ùå ${y} provider not available`),l[y].connected=!1,l[y].error="Provider not available",s.forEach(e=>{a[y][e.name]="‚ùå No Provider"});continue}l[y].connected=!0,console.log(`‚úÖ ${y} connected`);for(const t of s){const n=t.name;if("getCapabilities"===n||"getUtxos"===n||"getBRC20List"===n){if(!(null==(r=window.NexusWalletConnect)?void 0:r[n])){a[y][n]="‚ö™ Not Available",l[y].methods[n]={available:!1,status:"Not Available"};continue}}else if("function"!=typeof o[n]){a[y][n]="‚ö™ Not Available",l[y].methods[n]={available:!1,status:"Not Available"};continue}if(t.destructive)a[y][n]="üö´ Destructive (Not Tested)",l[y].methods[n]={available:!0,status:"Destructive - broadcasts transactions immediately",destructive:!0};else if(t.requiresUserConfirmation)a[y][n]="üë§ Requires User Confirmation",l[y].methods[n]={available:!0,status:"Requires user confirmation via wallet popup",requiresUserConfirmation:!0};else try{let t;const r=new Promise((e,t)=>{setTimeout(()=>t(new Error("Method timed out after 10 seconds")),1e4)}),i=(()=>f(e,null,function*(){return"signMessage"===n?yield o.signMessage(b.message):"signPsbt"===n&&b.psbtHex?yield o.signPsbt(b.psbtHex):"getInscriptions"===n?yield o.getInscriptions(b.inscriptionCursor,b.inscriptionSize):"request"===n?{note:"Request method requires specific RPC calls"}:"getCapabilities"===n?window.NexusWalletConnect.getCapabilities():"getUtxos"===n?yield window.NexusWalletConnect.getUtxos():"getBRC20List"===n?yield window.NexusWalletConnect.getBRC20List():yield o[n]()}))();t=yield Promise.race([i,r]),a[y][n]="‚úÖ Works",l[y].methods[n]={available:!0,tested:!0,status:"Success",result:t},console.log(`  ‚úÖ ${n} works`)}catch(v){const e=v.message||"Unknown error";a[y][n]=`‚ùå ${e.substring(0,30)}...`,l[y].methods[n]={available:!0,tested:!0,status:"Error",error:e},console.log(`  ‚ùå ${n} error: ${e}`)}}}catch(v){console.log(`‚ùå ${y} error: ${v.message}`),l[y].error=v.message,s.forEach(e=>{a[y][e.name]=`‚ùå ${v.message.substring(0,20)}...`})}}y(!1),o.push("\n## üìä Capability Matrix\n"),o.push("Legend:\n"),o.push("- ‚úÖ **Works** - Method tested successfully\n"),o.push("- üë§ **Requires User Confirmation** - Opens wallet popup (not auto-tested)\n"),o.push("- üö´ **Destructive** - Broadcasts immediately without confirmation (dangerous!)\n"),o.push("- ‚ö™ **Not Available** - Method not supported by wallet\n"),o.push("- ‚ùå **Error** - Method failed or wallet not connected\n");const c=[...new Set(s.map(e=>e.category))];for(const e of c){o.push(`\n### ${e}\n`);const t=s.filter(t=>t.category===e);o.push(`| Method | ${i.join(" | ")} |`),o.push(`|--------|${i.map(()=>"--------").join("|")}|`);for(const e of t){const t=[e.name];for(const n of i)t.push(a[n][e.name]||"‚ùì Unknown");o.push(`| ${t.join(" | ")} |`)}}o.push(`\n\n${"=".repeat(80)}\n`),o.push("## üìù Detailed Test Results\n");for(const e of i){o.push(`\n### ${e} Wallet\n`);const t=l[e];if(!t.connected){o.push(`**Status:** ‚ùå ${t.error||"Not connected"}\n`);continue}o.push("**Status:** ‚úÖ Connected\n");const n=Object.entries(t.methods),r=n.filter(([e,t])=>t.available).length,i=n.filter(([e,t])=>t.tested).length,a=n.filter(([e,t])=>"Success"===t.status).length;o.push(`**Available Methods:** ${r}/${s.length}\n`),o.push(`**Successfully Tested:** ${a}/${i}\n`);const c=n.filter(([e,t])=>"Success"===t.status);if(c.length>0){o.push(`\n#### ‚úÖ Working Methods (${c.length})\n`);for(const[e,t]of c){const n=s.find(t=>t.name===e);o.push(`\n**${e}** (${null==n?void 0:n.category})`),o.push("```javascript"),o.push(`const result = await provider.${e}();`),o.push("```"),o.push("Result:"),o.push("```json"),o.push(JSON.stringify(t.result,null,2).substring(0,500)),o.push("```\n")}}const u=n.filter(([e,t])=>t.requiresUserConfirmation);if(u.length>0){o.push(`\n#### üë§ Requires User Confirmation (${u.length})\n`),o.push("These methods open wallet popups and require user approval (not auto-tested in batch mode):\n");for(const[e]of u)o.push(`- ${e}`);o.push("\n")}const d=n.filter(([e,t])=>t.destructive);if(d.length>0){o.push(`\n#### üö´ Destructive Methods (${d.length})\n`),o.push("‚ö†Ô∏è **DANGER:** These methods broadcast transactions immediately without user confirmation:\n");for(const[e]of d)o.push(`- ${e}`);o.push("\n")}const p=n.filter(([e,t])=>"Error"===t.status);if(p.length>0){o.push(`\n#### ‚ùå Errors (${p.length})\n`);for(const[e,t]of p)o.push(`- **${e}**: ${t.error}`);o.push("\n")}o.push("\n---\n")}y(!1);const u=o.join("\n"),d=new Blob([u],{type:"text/markdown"}),p=URL.createObjectURL(d),h=document.createElement("a");h.href=p,h.download=`WALLET-CAPABILITY-MATRIX-${Date.now()}.md`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(p);const g=i.filter(e=>l[e].connected).length,m=s.length*i.length,w=Object.values(l).reduce((e,t)=>t.connected?e+Object.values(t.methods).filter(e=>"Success"===e.status).length:e,0);alert(`‚úÖ Complete capability matrix generated!\n    \nüìä Summary:\n- Wallets Tested: ${i.length}\n- Wallets Connected: ${g}\n- Total Method Checks: ${m}\n- Working Methods: ${w}\n- Report Downloaded: WALLET-CAPABILITY-MATRIX-${Date.now()}.md\n\nCheck the downloaded file for the complete capability matrix!`)}),disabled:h,className:"btn-test-all",style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"}},h?"‚è≥ Testing All Wallets...":"üåê Test ALL Wallets (8)"),g.createElement("button",{onClick:()=>f(e,null,function*(){y(!0);const e={},n=[];n.push(`# ${r} Wallet - Complete Method Test Report`),n.push(`\nGenerated: ${(new Date).toLocaleString()}`),n.push("\n---\n");for(const r of c){l(e=>p(d({},e),{[r.name]:!0}));try{let i;i="signMessage"===r.name?yield t.signMessage(b.message):"signPsbt"===r.name&&b.psbtHex?yield t.signPsbt(b.psbtHex):"switchNetwork"===r.name?yield t.switchNetwork(b.network):"sendBitcoin"===r.name&&b.toAddress&&b.amount?yield t.sendBitcoin(b.toAddress,b.amount):"getInscriptions"===r.name?yield t.getInscriptions(b.inscriptionCursor,b.inscriptionSize):r.name.includes("send")||r.name.includes("inscribe")||r.name.includes("push")?{skipped:!0,reason:"Destructive method - requires manual testing with valid inputs"}:yield t[r.name](),e[r.name]={success:!0,data:i},n.push(`\n## ${r.name}`),n.push(`**Category:** ${r.category}`),n.push("**Status:** ‚úÖ Success\n"),n.push("### Usage Code:"),n.push("```javascript"),n.push(r.code),n.push("```\n"),n.push("### Result:"),n.push("```json"),n.push(JSON.stringify(i,null,2)),n.push("```\n"),n.push("---\n")}catch(h){e[r.name]={success:!1,error:h.message},n.push(`\n## ${r.name}`),n.push(`**Category:** ${r.category}`),n.push("**Status:** ‚ùå Error\n"),n.push("### Usage Code:"),n.push("```javascript"),n.push(r.code),n.push("```\n"),n.push("### Error:"),n.push("```"),n.push(h.message),n.push("```\n"),n.push("---\n")}l(e=>p(d({},e),{[r.name]:!1}))}o(e),y(!1);const i=n.join("\n"),s=new Blob([i],{type:"text/markdown"}),a=URL.createObjectURL(s),u=document.createElement("a");u.href=a,u.download=`${r}-test-report-${Date.now()}.md`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(a),alert(`‚úÖ Test complete! Report downloaded.\n\nTested: ${c.length} methods\nSuccessful: ${Object.values(e).filter(e=>e.success).length}\nFailed: ${Object.values(e).filter(e=>!e.success).length}`)}),disabled:h,className:"btn-test-all"},h?"‚è≥ Testing...":"üöÄ Test Current Wallet Methods"),g.createElement("button",{onClick:()=>{const e=c.map(e=>`// ${e.category} - ${e.name}\n${e.code}`).join("\n\n");navigator.clipboard.writeText(e),alert("All code snippets copied to clipboard!")},className:"btn-copy-all"},"üìã Copy All Snippets")),h&&g.createElement("div",{className:"testing-progress"},g.createElement("strong",null,"Testing in progress..."),g.createElement("p",null,"This will systematically test all wallets and methods, generating a comprehensive report. Each wallet will be connected, tested, and documented automatically. Destructive methods (send, inscribe, push) will be skipped for safety."))),g.createElement("div",{className:"test-inputs-section"},g.createElement("h3",null,"üìù Test Inputs"),g.createElement("div",{className:"input-grid"},g.createElement("div",{className:"input-group"},g.createElement("label",null,"Message to Sign"),g.createElement("input",{type:"text",value:b.message,onChange:e=>v(t=>p(d({},t),{message:e.target.value})),placeholder:"Message to sign"})),g.createElement("div",{className:"input-group"},g.createElement("label",null,"Recipient Address"),g.createElement("input",{type:"text",value:b.toAddress,onChange:e=>v(t=>p(d({},t),{toAddress:e.target.value})),placeholder:"bc1q..."})),g.createElement("div",{className:"input-group"},g.createElement("label",null,"Amount (satoshis)"),g.createElement("input",{type:"number",value:b.amount,onChange:e=>v(t=>p(d({},t),{amount:parseInt(e.target.value)})),placeholder:"10000"})),g.createElement("div",{className:"input-group"},g.createElement("label",null,"PSBT (hex or base64)"),g.createElement("textarea",{value:b.psbtHex,onChange:e=>v(t=>p(d({},t),{psbtHex:e.target.value})),placeholder:"cHNidP8B...",rows:"2"})),g.createElement("div",{className:"input-group"},g.createElement("label",null,"BRC-20 Tick (OKX)"),g.createElement("input",{type:"text",value:b.brc20Tick,onChange:e=>v(t=>p(d({},t),{brc20Tick:e.target.value})),placeholder:"ordi"})),g.createElement("div",{className:"input-group"},g.createElement("label",null,"Inscription Content"),g.createElement("textarea",{value:b.inscriptionContent,onChange:e=>v(t=>p(d({},t),{inscriptionContent:e.target.value})),placeholder:"Hello Bitcoin!",rows:"2"})),g.createElement("div",{className:"input-group"},g.createElement("label",null,"Content Type"),g.createElement("input",{type:"text",value:b.inscriptionContentType,onChange:e=>v(t=>p(d({},t),{inscriptionContentType:e.target.value})),placeholder:"text/plain;charset=utf-8"})),g.createElement("div",{className:"input-group"},g.createElement("label",null,"Inscription ID (for transfers)"),g.createElement("input",{type:"text",value:b.inscriptionId,onChange:e=>v(t=>p(d({},t),{inscriptionId:e.target.value})),placeholder:"abc123...i0"})))),Object.entries(I).map(([n,i])=>g.createElement("div",{key:n,className:"category-section"},g.createElement("h3",{className:"category-title"},n," (",i.length," methods)"),g.createElement("div",{className:"methods-grid"},i.map(n=>{const i=s[n.name],c=a[n.name];return g.createElement("div",{key:n.name,className:"method-card"},g.createElement("div",{className:"method-header"},g.createElement("h4",{className:"method-name"},n.name,"()"),g.createElement("button",{className:"test-button",onClick:()=>(n=>f(e,null,function*(){l(e=>p(d({},e),{[n.name]:!0}));try{let e;switch(n.name){case"getAddress":case"getPublicKey":case"getAccounts":case"getBalance":case"getNetwork":case"getAllInscriptions":case"getBitcoinUtxos":e=yield t[n.name]();break;case"getCapabilities":e=window.NexusWalletConnect.getCapabilities();break;case"getUtxos":e=yield window.NexusWalletConnect.getUtxos();break;case"getBRC20List":e=yield window.NexusWalletConnect.getBRC20List();break;case"getInscriptions":e=yield t.getInscriptions(b.inscriptionCursor,b.inscriptionSize);break;case"switchNetwork":e=yield t.switchNetwork(b.network);break;case"signMessage":e=yield t.signMessage(b.message,"ecdsa");break;case"signPsbt":if(!b.psbtHex)throw new Error("Please provide a PSBT (hex or base64)");if("phantom"===r&&(e=>{const t=String(e||"").trim().toLowerCase();return t.startsWith("70736274ff")&&t.length<40})(b.psbtHex))throw new Error("Phantom requires a real, complete PSBT (not just the PSBT header).");e=yield t.signPsbt(b.psbtHex);break;case"sendBitcoin":if(!b.toAddress)throw new Error("Please provide a recipient address");if(!b.amount||b.amount<=0)throw new Error("Please provide a valid amount (must be > 0 satoshis)");if(!(b.toAddress.startsWith("bc1")||b.toAddress.startsWith("tb1")||b.toAddress.startsWith("1")||b.toAddress.startsWith("3")))throw new Error("Invalid Bitcoin address format");e=yield t.sendBitcoin(b.toAddress,b.amount);break;case"inscribe":e=yield t.inscribe(b.inscriptionContent,{contentType:b.inscriptionContentType,feeRate:5});break;case"inscribeTransfer":if(!b.brc20Tick)throw new Error("Please provide a BRC-20 tick symbol");e=yield t.inscribeTransfer(b.brc20Tick,"100");break;case"mint":e=yield t.mint({type:61,from:t.address,inscriptions:[{contentType:b.inscriptionContentType,body:b.inscriptionContent}]});break;case"transferNft":if(!b.toAddress||!b.inscriptionId)throw new Error("Please provide recipient address and inscription ID");e=yield t.transferNft(b.toAddress,b.inscriptionId);break;case"watchAsset":e=yield t.watchAsset({type:"BRC20",tick:b.brc20Tick||"ordi"});break;case"splitUtxo":e=yield t.splitUtxo(5);break;case"multiSignMessage":e=yield t.multiSignMessage([b.message,"Second message"],"ecdsa");break;case"signData":e=yield t.signData("0x48656c6c6f","ecdsa");break;case"getChain":e=yield t.getChain();break;case"switchChain":e=yield t.switchChain("BITCOIN_TESTNET");break;case"verifyMessageOfBIP322Simple":e={note:"Requires valid address, message, and signature to test"};break;default:e="Method requires manual parameters - see code snippet"}o(t=>p(d({},t),{[n.name]:{success:!0,data:e,error:null,timestamp:(new Date).toLocaleTimeString()}})),console.log(`‚úÖ ${n.name}:`,e)}catch(e){o(t=>p(d({},t),{[n.name]:{success:!1,data:null,error:e.message,timestamp:(new Date).toLocaleTimeString()}})),console.error(`‚ùå ${n.name}:`,e)}finally{l(e=>p(d({},e),{[n.name]:!1}))}}))(n),disabled:c},c?"‚è≥ Testing...":"‚ñ∂Ô∏è Test")),g.createElement("p",{className:"method-description"},n.description),g.createElement("div",{className:"code-section"},g.createElement("div",{className:"code-header"},g.createElement("span",{className:"code-label"},"Usage:"),g.createElement("button",{className:"copy-code-btn",onClick:()=>{return e=n.code,navigator.clipboard.writeText(e),void alert("Code copied to clipboard!");var e},title:"Copy code"},"üìã")),g.createElement("pre",{className:"code-block"},g.createElement("code",null,n.code))),i&&g.createElement("div",{className:"result-box "+(i.success?"success":"error")},g.createElement("div",{className:"result-header"},g.createElement("span",{className:"result-icon"},i.success?"‚úÖ":"‚ùå"),g.createElement("span",{className:"result-time"},i.timestamp)),i.success?g.createElement("div",{className:"result-data"},g.createElement("strong",null,"Result:"),g.createElement("pre",null,JSON.stringify(i.data,null,2))):g.createElement("div",{className:"result-error"},g.createElement("strong",null,"Error:"),g.createElement("p",null,i.error))))})))),g.createElement("style",{jsx:!0},"\n        .wallet-tester {\n          padding: 20px;\n          max-width: 1400px;\n          margin: 0 auto;\n        }\n\n        .tester-header {\n          margin-bottom: 30px;\n          padding: 20px;\n          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n          color: white;\n          border-radius: 12px;\n        }\n\n        .tester-header h2 {\n          margin: 0 0 10px 0;\n          font-size: 28px;\n        }\n\n        .tester-subtitle {\n          margin: 0 0 15px 0;\n          opacity: 0.9;\n        }\n        \n        .dev-notice {\n          background: rgba(255, 255, 255, 0.15);\n          padding: 15px;\n          border-radius: 8px;\n          margin: 15px 0;\n          border-left: 4px solid #ffd700;\n        }\n        \n        .dev-notice strong {\n          display: block;\n          margin-bottom: 8px;\n          font-size: 16px;\n        }\n        \n        .dev-notice p {\n          margin: 5px 0;\n          font-size: 14px;\n          line-height: 1.6;\n          opacity: 0.95;\n        }\n\n        .batch-actions {\n          display: flex;\n          gap: 10px;\n          margin: 20px 0;\n          flex-wrap: wrap;\n        }\n\n        .btn-test-all {\n          padding: 12px 24px;\n          font-size: 16px;\n          font-weight: bold;\n          color: #fff;\n          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n          border: none;\n          border-radius: 8px;\n          cursor: pointer;\n          transition: all 0.3s ease;\n          box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);\n        }\n\n        .btn-test-all:hover:not(:disabled) {\n          transform: translateY(-2px);\n          box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);\n        }\n\n        .btn-test-all:disabled {\n          background: #666;\n          cursor: not-allowed;\n          box-shadow: none;\n        }\n\n        .btn-copy-all {\n          padding: 12px 24px;\n          font-size: 16px;\n          font-weight: bold;\n          color: #667eea;\n          background: #fff;\n          border: 2px solid #667eea;\n          border-radius: 8px;\n          cursor: pointer;\n          transition: all 0.3s ease;\n        }\n\n        .btn-copy-all:hover {\n          background: #667eea;\n          color: #fff;\n          transform: translateY(-2px);\n        }\n\n        .testing-progress {\n          padding: 15px;\n          background: #e3f2fd;\n          border-radius: 8px;\n          margin: 15px 0;\n          color: #1976d2;\n          border-left: 4px solid #2196f3;\n        }\n\n        .testing-progress strong {\n          display: block;\n          margin-bottom: 5px;\n        }\n\n        .testing-progress p {\n          margin: 5px 0 0 0;\n          font-size: 14px;\n        }\n\n        .test-inputs-section {\n          margin-bottom: 30px;\n          padding: 20px;\n          background: #f8f9fa;\n          border-radius: 8px;\n          border: 2px solid #e9ecef;\n        }\n\n        .test-inputs-section h3 {\n          margin-top: 0;\n          color: #495057;\n        }\n\n        .input-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n          gap: 15px;\n        }\n\n        .input-group {\n          display: flex;\n          flex-direction: column;\n        }\n\n        .input-group label {\n          font-weight: 600;\n          margin-bottom: 5px;\n          color: #495057;\n          font-size: 14px;\n        }\n\n        .input-group input,\n        .input-group textarea {\n          padding: 8px 12px;\n          border: 1px solid #ced4da;\n          border-radius: 4px;\n          font-family: monospace;\n          font-size: 13px;\n        }\n\n        .category-section {\n          margin-bottom: 40px;\n        }\n\n        .category-title {\n          color: #FF6B00;\n          border-bottom: 3px solid #FF6B00;\n          padding-bottom: 10px;\n          margin-bottom: 20px;\n        }\n\n        .methods-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));\n          gap: 20px;\n        }\n\n        .method-card {\n          background: white;\n          border: 2px solid #e9ecef;\n          border-radius: 8px;\n          padding: 15px;\n          transition: all 0.2s;\n        }\n\n        .method-card:hover {\n          border-color: #FF6B00;\n          box-shadow: 0 4px 12px rgba(255, 107, 0, 0.1);\n        }\n\n        .method-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 10px;\n        }\n\n        .method-name {\n          margin: 0;\n          color: #212529;\n          font-size: 18px;\n          font-family: 'Monaco', 'Courier New', monospace;\n        }\n\n        .test-button {\n          padding: 6px 12px;\n          background: #FF6B00;\n          color: white;\n          border: none;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 14px;\n          font-weight: 600;\n          transition: background 0.2s;\n        }\n\n        .test-button:hover:not(:disabled) {\n          background: #E55B00;\n        }\n\n        .test-button:disabled {\n          background: #ccc;\n          cursor: not-allowed;\n        }\n\n        .method-description {\n          color: #6c757d;\n          margin: 0 0 15px 0;\n          font-size: 14px;\n        }\n\n        .code-section {\n          background: #282c34;\n          border-radius: 6px;\n          overflow: hidden;\n          margin-bottom: 15px;\n        }\n\n        .code-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          padding: 8px 12px;\n          background: #21252b;\n          border-bottom: 1px solid #181a1f;\n        }\n\n        .code-label {\n          color: #abb2bf;\n          font-size: 12px;\n          font-weight: 600;\n          text-transform: uppercase;\n        }\n\n        .copy-code-btn {\n          background: none;\n          border: none;\n          cursor: pointer;\n          font-size: 16px;\n          padding: 4px;\n          opacity: 0.7;\n          transition: opacity 0.2s;\n        }\n\n        .copy-code-btn:hover {\n          opacity: 1;\n        }\n\n        .code-block {\n          margin: 0;\n          padding: 12px;\n          background: #282c34;\n          color: #61dafb;\n          font-family: 'Monaco', 'Courier New', monospace;\n          font-size: 13px;\n          line-height: 1.5;\n          overflow-x: auto;\n        }\n\n        .code-block code {\n          color: #61dafb;\n        }\n\n        .result-box {\n          padding: 12px;\n          border-radius: 6px;\n          margin-top: 10px;\n        }\n\n        .result-box.success {\n          background: #e8f5e9;\n          border: 1px solid #4caf50;\n          color: #1b5e20;\n        }\n\n        .result-box.error {\n          background: #ffebee;\n          border: 1px solid #f44336;\n          color: #b71c1c;\n        }\n\n        .result-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 8px;\n        }\n\n        .result-icon {\n          font-size: 18px;\n        }\n\n        .result-time {\n          font-size: 12px;\n          color: #666;\n          font-weight: 500;\n        }\n\n        .result-data pre,\n        .result-error p {\n          margin: 5px 0 0 0;\n          padding: 10px;\n          background: #fff;\n          border: 1px solid rgba(0,0,0,0.1);\n          border-radius: 4px;\n          font-size: 12px;\n          max-height: 200px;\n          overflow: auto;\n          color: #212529;\n          font-family: 'Monaco', 'Courier New', monospace;\n        }\n\n        .result-data strong,\n        .result-error strong {\n          color: #212529;\n          display: block;\n          margin-bottom: 5px;\n        }\n\n        .warning {\n          padding: 20px;\n          background: #fff3cd;\n          border: 2px solid #ffc107;\n          border-radius: 8px;\n          text-align: center;\n        }\n\n        .warning strong {\n          display: block;\n          margin-bottom: 10px;\n          font-size: 18px;\n          color: #856404;\n        }\n\n        .warning p {\n          margin: 0;\n          color: #856404;\n        }\n      ")):g.createElement("div",{className:"warning"},g.createElement("strong",null,"‚ö†Ô∏è No wallet connected"),g.createElement("p",null,"Please connect a wallet first to test its methods."))},I={unisat:{name:"UniSat",features:{connect:!0,balance:!0,inscriptions:!0,signPsbt:!0,sendBitcoin:!0,signMessage:!0,getNetwork:!0,switchNetwork:!0,getPublicKey:!0,createInscription:!1,pushPsbt:!0,getAccounts:!0,getUtxos:!0,getBRC20List:!0},inscriptionMethod:"website",inscriptionSupport:{contentTypes:["brc20"],methods:{inscribeTransfer:!0,inscribe:"website"},maxSize:4e5,options:{feeRate:!0,receiverAddress:!0,devAddress:!1,devFee:!1}},notes:"Full-featured wallet with comprehensive API support. Supports BIP322 message signing. Inscription creation NOT available in NexusWalletConnect wrapper - only BRC-20 transfers via API. For other inscription types (text, images, HTML), users must visit https://unisat.io/inscribe"},xverse:{name:"Xverse",features:{connect:!0,balance:!0,inscriptions:!0,signPsbt:!0,sendBitcoin:!0,signMessage:!0,getNetwork:!1,switchNetwork:!1,getPublicKey:!0,createInscription:!0,pushPsbt:"auto-broadcast",getAccounts:!0,getUtxos:!1,getBRC20List:!1},inscriptionMethod:"native-jwt",inscriptionSupport:{contentTypes:["text","image","json","html","brc20","audio","video","model"],methods:{createInscription:!0},maxSize:4e5,options:{feeRate:!0,receiverAddress:!1,devAddress:!0,devFee:!0,appFee:!0},payloadTypes:["PLAIN_TEXT","BASE_64"],tokenMethod:"JWT"},externalApis:{},notes:"Returns separate payment and ordinals addresses. Balance supported via JSON-RPC 2.0 getBalance() method. Inscriptions supported via ord_getInscriptions. Uses native createInscription() method with JWT tokens (no external dependencies). Full inscription support for all content types via PLAIN_TEXT and BASE_64 encoding."},leather:{name:"Leather (Hiro)",features:{connect:!0,balance:!1,inscriptions:"external",signPsbt:!0,sendBitcoin:!0,signMessage:!0,getNetwork:!1,switchNetwork:!1,getPublicKey:!1,createInscription:!1,pushPsbt:!0,getAccounts:!0,getUtxos:!1,getBRC20List:!1},inscriptionMethod:"none",inscriptionSupport:{contentTypes:[],methods:{},maxSize:0,options:{}},notes:"Requires external APIs for balance and inscriptions. Use Hiro Platform or other inscription services. Focuses on signing and transaction broadcast."},okx:{name:"OKX Wallet",features:{connect:!0,balance:!0,inscriptions:!0,signPsbt:!0,sendBitcoin:!0,signMessage:!0,getNetwork:!0,switchNetwork:!0,getPublicKey:!0,createInscription:!0,pushPsbt:!0,getAccounts:!0,getUtxos:"splitUtxo",getBRC20List:!1},inscriptionMethod:"native",inscriptionSupport:{contentTypes:["brc20","text","image","json","html","audio","video"],methods:{mint:!0,inscribe:!0,inscribeBRC20Transfer:!0,inscribeBRC20Deploy:!0},maxSize:4e5,options:{feeRate:!0,receiverAddress:!0,devAddress:!0,devFee:!0,inscriptionType:!0}},notes:"Full-featured wallet similar to UniSat. Supports complete inscription creation with extensive BRC-20 support including deploy, mint, and transfer operations."},magiceden:{name:"Magic Eden",features:{connect:!0,balance:!1,inscriptions:!1,signPsbt:!0,sendBitcoin:!0,signMessage:!0,getNetwork:!0,switchNetwork:!1,getPublicKey:!1,createInscription:!1,pushPsbt:!1,getAccounts:!0,getUtxos:!1,getBRC20List:!1},inscriptionMethod:"none",inscriptionSupport:{contentTypes:[],methods:{},maxSize:0,options:{}},notes:"Good support for core transaction features. Balance not available via API - use Magic Eden website. getInscriptions() is not supported by Magic Eden wallet provider - it returns empty data. No native inscription creation - users should use Magic Eden marketplace for inscriptions."},wizz:{name:"Wizz Wallet",features:{connect:!0,balance:!0,inscriptions:!0,signPsbt:!0,sendBitcoin:!0,signMessage:!0,getNetwork:!0,switchNetwork:!0,getPublicKey:!0,createInscription:!0,pushPsbt:!0,getAccounts:!0,getUtxos:!0,getBRC20List:!1},inscriptionMethod:"native",inscriptionSupport:{contentTypes:["brc20","text","image","json","html","audio","video"],methods:{inscribe:!0},maxSize:4e5,options:{feeRate:!0,receiverAddress:!0,devAddress:!0,devFee:!0,inscriptionType:!0}},notes:"Full-featured wallet similar to UniSat. Supports BIP322 message signing and complete inscription creation with automatic content type detection."},oyl:{name:"Oyl Wallet",features:{connect:!0,balance:!0,inscriptions:!0,signPsbt:!0,sendBitcoin:!0,signMessage:!0,getNetwork:!1,switchNetwork:!1,getPublicKey:!1,createInscription:!1,pushPsbt:!1,getAccounts:!0,getUtxos:!1,getBRC20List:!1},inscriptionMethod:"none",inscriptionSupport:{contentTypes:[],methods:{},maxSize:0,options:{}},notes:"Good support for core features. Balance returns satoshis as simple number. No native inscription creation API - use external services."},phantom:{name:"Phantom",features:{connect:!0,balance:!1,inscriptions:!1,signPsbt:!0,sendBitcoin:!0,signMessage:!0,getNetwork:!1,switchNetwork:!1,getPublicKey:!0,createInscription:!1,pushPsbt:!1,getAccounts:!0,getUtxos:!1,getBRC20List:!1},inscriptionMethod:"none",inscriptionSupport:{contentTypes:[],methods:{},maxSize:0,options:{}},notes:"Limited Bitcoin support - only connect, signing, and transactions. No balance or inscription APIs. Returns account objects with address and publicKey."},bitmapwallet:{name:"BitmapWallet",features:{connect:!0,balance:!0,inscriptions:!0,signPsbt:!0,sendBitcoin:!0,signMessage:!0,getNetwork:!0,switchNetwork:!0,getPublicKey:!0,createInscription:!1,pushPsbt:!0,getAccounts:!0,getUtxos:!0,getBRC20List:!1,detectBitmaps:!0,getRunes:!0,getRareSats:!0},inscriptionMethod:"none",inscriptionSupport:{contentTypes:[],methods:{},maxSize:0,options:{}},notes:"Bitmap-focused wallet with full UTXO management, rare sats detection, runes support, and bitmap-specific features. Uses EIP-1193 compatible request() interface."}},T={version:"1.0.0"},P=()=>{var t,s,o,a,l,c,u,h,y,v,P,A,B,N,x,_,C,k,O;const U=(()=>{try{const e=String((null==document?void 0:document.title)||"").trim().match(/^([0-9]+(?:\.[0-9]+){1,2})\b/);if(e&&e[1])return e[1]}catch(e){}return String(null==T?void 0:T.version).trim()||"0.0.0"})(),[R,L]=m(!1),[H,M]=m(!0),[W,q]=m("overview"),[F,K]=m({isConnected:!1,walletType:null,address:null,balance:0}),[$,D]=m([]),[X,V]=m(!1),[j,G]=m(null),[z,Y]=m(null),[J,Q]=m(!1),[Z,ee]=m(!1),[te,ne]=m([]),[re,ie]=m(null),[se,oe]=m(""),[ae,le]=m({signedPSBT:"",sentTxId:"",messageSignature:""}),[ce,ue]=m(null),de=b(()=>{const e=E();return[{name:"Sample PSBT (valid structure; NOT spendable)",psbtBase64:e.base64,psbtHex:e.hex}]},[]),pe=[{id:"unisat",name:"UniSat",capabilities:["balance","inscriptions","signPsbt","sendBitcoin","signMessage","pushPsbt","getPublicKey"],color:"orange"},{id:"xverse",name:"Xverse",capabilities:["balance","inscriptions","signPsbt","sendBitcoin","signMessage","createInscription","getPublicKey"],color:"blue"},{id:"okx",name:"OKX",capabilities:["balance","inscriptions","signPsbt","sendBitcoin","signMessage","pushPsbt","getPublicKey"],color:"black"},{id:"leather",name:"Leather",capabilities:["signPsbt","sendBitcoin","signMessage","pushPsbt"],color:"brown"},{id:"phantom",name:"Phantom",capabilities:["balance","inscriptions","signPsbt","sendBitcoin","signMessage","getPublicKey"],color:"purple"},{id:"wizz",name:"Wizz",capabilities:["balance","inscriptions","signPsbt","sendBitcoin","signMessage","createInscription","pushPsbt","getPublicKey"],color:"green"},{id:"oyl",name:"Oyl",capabilities:["balance","inscriptions","signPsbt","sendBitcoin","signMessage"],color:"red"},{id:"magiceden",name:"Magic Eden",capabilities:["signPsbt","sendBitcoin","signMessage"],color:"violet"},{id:"bitmapwallet",name:"BitmapWallet",capabilities:["balance","inscriptions","signPsbt","sendBitcoin","signMessage","pushPsbt","getPublicKey","detectBitmaps","getRunes","getRareSats"],color:"teal"}],he=()=>{try{return"undefined"!=typeof navigator&&/Android|iPhone|iPad|iPod/i.test(navigator.userAgent||"")}catch(e){return!1}},fe=()=>{var e,t;try{const n=null==(t=null==(e=window.NexusWalletConnect)?void 0:e.detectWallets)?void 0:t.call(e);Array.isArray(n)&&ne(n)}catch(n){}};w(()=>{const e=()=>{if(window.NexusWalletConnect){L(!0),K(window.NexusWalletConnect.getState());try{const e=window.NexusWalletConnect.detectWallets();console.log("üîç Detected wallets:",e),console.log("üîç Number of wallets found:",e.length),e.length>0&&console.log("üîç First wallet:",JSON.stringify(e[0])),ne(e)}catch(t){console.warn("Failed to detect wallets:",t),ne([])}if("undefined"!=typeof window){let e=0;const n=30,r=setInterval(()=>{e+=1;try{const e=window.NexusWalletConnect.detectWallets();Array.isArray(e)&&e.length>0&&(ne(e),clearInterval(r))}catch(t){}e>=n&&clearInterval(r)},500)}const e=()=>fe(),n=()=>{"visible"===document.visibilityState&&fe()};try{window.addEventListener("focus",e),document.addEventListener("visibilitychange",n)}catch(t){}const r=window.NexusWalletConnect.subscribe(e=>{K(e)});return()=>{try{null==r||r()}catch(t){}try{window.removeEventListener("focus",e)}catch(t){}try{document.removeEventListener("visibilitychange",n)}catch(t){}}}L(!0),setTimeout(e,100)};return e()},[]),w(()=>{f(e,null,function*(){var e,t,n;if(F.isConnected){try{const r=null==(t=null==(e=window.NexusWalletConnect)?void 0:e.getCurrentProvider)?void 0:t.call(e);if((null==r?void 0:r.features)&&"object"==typeof r.features)return void ue(r.features);const i=null==(n=window.NexusWalletConnect)?void 0:n.getCapabilities;if("function"==typeof i){const e=yield i();if((null==e?void 0:e.features)&&"object"==typeof e.features)return void ue(e.features);if(Array.isArray(null==e?void 0:e.methods)){const t={};for(const n of e.methods)t[n]=!0;return void ue(t)}}}catch(r){}ue(null)}else ue(null)})},[F.isConnected,F.walletType]),w(()=>{if(F.isConnected&&F.walletType){const e=pe.find(e=>e.id.toLowerCase()===F.walletType.toLowerCase());(null==e?void 0:e.capabilities.includes("inscriptions"))?be():(D([]),console.log(`‚ÑπÔ∏è ${F.walletType} wallet does not support inscription viewing`))}else D([])},[F.isConnected,F.walletType]);const ge=t=>f(e,null,function*(){var e,n;V(!0),G(t),Y(null),ie(null);try{const r=(null==(e=window.NexusWalletConnect)?void 0:e.connectSmart)||(null==(n=window.NexusWalletConnect)?void 0:n.connect);if(!r)throw new Error("Wallet connector not available");const i=yield r(t);if(i&&i.redirected)return ie({walletType:t,deepLink:i.deepLink||null,nonce:i.nonce||null}),void Q(!0);Q(!1)}catch(r){Y(`Failed to connect to ${t}: ${r.message}`)}finally{V(!1),G(null)}}),me=()=>{var e,t;try{const n=null==(t=null==(e=window.NexusWalletConnect)?void 0:e.detectWallets)?void 0:t.call(e);Array.isArray(n)&&ne(n)}catch(n){}Q(!0)},ye=()=>{Q(!1)};w(()=>{const e=e=>{"Escape"===e.key&&J&&ye()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[J]);const we=()=>f(e,null,function*(){try{yield window.NexusWalletConnect.disconnect(),D([]),Y(null),le({signedPSBT:"",sentTxId:"",messageSignature:""})}catch(e){Y(e.message)}}),be=()=>f(e,null,function*(){if(!F.isConnected)return;const e=pe.find(e=>e.id.toLowerCase()===F.walletType.toLowerCase());if(!(null==e?void 0:e.capabilities.includes("inscriptions")))return console.log(`‚ÑπÔ∏è ${F.walletType} wallet does not support inscription viewing`),void D([]);V(!0),Y(null);try{const e=yield window.NexusWalletConnect.getInscriptions();Array.isArray(e)?(D(e),console.log(`‚úÖ Loaded ${e.length} inscriptions`)):(D([]),console.warn("‚ö†Ô∏è getInscriptions did not return an array:",e))}catch(t){console.error("‚ùå Failed to load inscriptions:",t);const e=t.message||"Unknown error";e.includes("not supported")?Y(`${F.walletType} wallet does not support inscription viewing`):Y(`Failed to load inscriptions: ${e}`),D([])}finally{V(!1)}}),ve=e=>{if(!F.isConnected||!F.walletType)return!1;if(ce&&Object.prototype.hasOwnProperty.call(ce,e))return!0===ce[e];const t=pe.find(e=>e.id.toLowerCase()===F.walletType.toLowerCase());if(t&&t.capabilities.includes(e))return!0;const n=function(e,t){const n=I[null==e?void 0:e.toLowerCase()];return n&&n.features[t]||!1}(F.walletType,e);return"string"==typeof n||!0===n},Ee=e=>{var t,n;if(null==e)return null;if("number"==typeof e)return e;if("object"==typeof e){const r=null!=(n=null!=(t=e.totalSats)?t:e.total)?n:null;if("number"==typeof r)return r/1e8}return null};return R?g.createElement("div",{className:"nexus-wallet-app "+(H?"dark-theme":"light-theme")},g.createElement("nav",{className:"top-navigation"},g.createElement("div",{className:"nav-left"},g.createElement("div",{className:"nav-title-group"},g.createElement("div",{className:"nav-title"},"Nexus"),g.createElement("div",{className:"nav-subtitle"},"OCW v",U))),g.createElement("div",{className:"nav-right"},g.createElement("button",{className:"btn btn-icon btn-secondary",onClick:()=>M(!H),title:H?"Switch to light mode":"Switch to dark mode"},H?"‚òÄÔ∏è":"üåô"),F.isConnected?g.createElement("button",{className:"btn btn-secondary",onClick:we},"Disconnect"):g.createElement("button",{className:"btn btn-primary",onClick:me},"Connect Wallet"))),g.createElement("main",{className:"main-content"},F.isConnected?g.createElement(g.Fragment,null,g.createElement("div",{className:"tab-navigation"},g.createElement("div",{className:"tab-navigation-left"},g.createElement("button",{className:"tab-button "+("overview"===W?"active":""),onClick:()=>q("overview")},"Overview"),g.createElement("button",{className:"tab-button "+("inscriptions"===W?"active":""),onClick:()=>q("inscriptions")},"Inscriptions"),g.createElement("button",{className:"tab-button "+("testing"===W?"active":""),onClick:()=>q("testing")},"üß™ Testing"),"xverse"===(null==(t=F.walletType)?void 0:t.toLowerCase())&&g.createElement("button",{className:"tab-button "+("xverse"===W?"active":""),onClick:()=>q("xverse")},"üü£ Xverse Advanced"),g.createElement("button",{className:"tab-button "+("settings"===W?"active":""),onClick:()=>q("settings")},"Settings")),g.createElement("div",{className:"tab-navigation-right"},ve("sendBitcoin")&&g.createElement("button",{className:"btn btn-primary btn-sm",onClick:()=>f(e,null,function*(){const e=prompt("Enter recipient address:");if(!e)return;const t=prompt("Enter amount in BTC:","0.001");if(t&&!isNaN(parseFloat(t))){V(!0);try{const n=yield window.NexusWalletConnect.sendBTC(e,parseFloat(t));le(e=>p(d({},e),{sentTxId:n})),Y(null)}catch(n){Y("Send failed: "+n.message)}finally{V(!1)}}}),disabled:X},X?"‚è≥ ":"","Send BTC"),ve("signMessage")&&g.createElement("button",{className:"btn btn-secondary btn-sm",onClick:()=>f(e,null,function*(){const e=prompt("Enter message to sign:","Hello from NexusWalletConnect!");if(e){V(!0);try{const t=yield window.NexusWalletConnect.signMessage(e);le(e=>p(d({},e),{messageSignature:t})),Y(null)}catch(t){Y("Message signing failed: "+t.message)}finally{V(!1)}}}),disabled:X},X?"‚è≥ ":"","Sign Message"),ve("signPsbt")&&g.createElement("button",{className:"btn btn-secondary btn-sm",onClick:()=>f(e,null,function*(){var e,t,n,r;const i=String(F.walletType||"").toLowerCase(),s="phantom"===i,o="magiceden"===i;let a=String((null==(e=de[0])?void 0:e.psbtBase64)||(null==(t=de[0])?void 0:t.psbtHex)||"").trim();if(!a){const e=prompt("Enter PSBT (hex or base64) to sign:","");if(!e)return;a=String(e).trim()}try{const e=a.toLowerCase();if(e.startsWith("70736274ff")&&e.length<40&&(s||o))throw new Error((o?"Magic Eden":"Phantom")+" requires a real, full PSBT (not just the PSBT header).")}catch(l){return void Y("PSBT signing failed: "+((null==l?void 0:l.message)||String(l)))}V(!0);try{const e=(null==(n=window.NexusWalletConnect)?void 0:n.signPsbt)||(null==(r=window.NexusWalletConnect)?void 0:r.signPSBT);if("function"!=typeof e)throw new Error("signPsbt() is not available on NexusWalletConnect");const t=yield e(a);le(e=>p(d({},e),{signedPSBT:t})),Y(null)}catch(c){Y("PSBT signing failed: "+c.message)}finally{V(!1)}}),disabled:X},X?"‚è≥ ":"","Sign PSBT"),!(!F.isConnected||!F.walletType)&&function(e){const t=I[null==e?void 0:e.toLowerCase()];return!0===(null==t?void 0:t.features.createInscription)}(F.walletType)&&g.createElement("button",{className:"btn btn-primary btn-sm",onClick:()=>{F.isConnected?ee(!0):Y("Please connect a wallet first")},disabled:X},X?"‚è≥ ":"","+ Create Inscription"))),"overview"===W&&g.createElement("div",{className:"grid-2col"},g.createElement("div",{className:"card"},g.createElement("div",{className:"card-header"},g.createElement("h2",{className:"card-title"},"Wallet Information"),g.createElement("p",{className:"card-subtitle"},"Connected: ",F.walletType)),"xverse"!==(null==(s=F.walletType)?void 0:s.toLowerCase())&&"magiceden"!==(null==(o=F.walletType)?void 0:o.toLowerCase())||!F.paymentAddress?g.createElement("div",{className:"address-display"},F.address):g.createElement(g.Fragment,null,g.createElement("div",{className:"address-section"},g.createElement("div",{className:"address-label"},"Payment Address"),g.createElement("div",{className:"address-display"},F.paymentAddress)),F.ordinalsAddress&&g.createElement("div",{className:"address-section mt-sm"},g.createElement("div",{className:"address-label"},"Ordinals Address"),g.createElement("div",{className:"address-display"},F.ordinalsAddress))),ve("balance")&&g.createElement(g.Fragment,null,g.createElement("div",{className:"balance-label"},"Total Balance"),g.createElement("div",{className:"balance-display"},null!==F.balance&&void 0!==F.balance?g.createElement(g.Fragment,null,g.createElement("div",{className:"balance-amount"},null==(a=Ee(F.balance))?void 0:a.toFixed(8)," BTC"),0===Ee(F.balance)&&g.createElement("div",{className:"balance-note"},"Wallet has no balance")):g.createElement("span",{className:"balance-unavailable"},"Balance fetch failed")))),g.createElement("div",{className:"card"},g.createElement("div",{className:"card-header"},g.createElement("h2",{className:"card-title"},"Wallet Capabilities"),g.createElement("p",{className:"card-subtitle"},"Supported features & quick actions")),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"Balance API"),g.createElement("span",{className:"stat-value"},ve("balance")?"‚úì Available":"‚úó Not Available")),ve("balance")&&g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){var e,t;try{const n=yield window.NexusWalletConnect.getBalance(),r=Ee(n),i=n&&"object"==typeof n&&null!=(t=null!=(e=n.totalSats)?e:n.total)?t:null;"number"==typeof r&&"number"==typeof i?alert(`Balance: ${r.toFixed(8)} BTC (${i} sats)`):"number"==typeof r?alert(`Balance: ${r} BTC`):alert(`Balance: ${JSON.stringify(n,null,2)}`)}catch(n){alert(`Error: ${n.message}`)}})},"üîÑ Refresh Balance"),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"Send Bitcoin"),g.createElement("span",{className:"stat-value"},ve("sendBitcoin")?"‚úì Supported":"‚úó Not Supported")),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"Sign Messages"),g.createElement("span",{className:"stat-value"},ve("signMessage")?"‚úì Supported":"‚úó Not Supported")),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"PSBT Signing"),g.createElement("span",{className:"stat-value"},ve("signPsbt")?"‚úì Supported":"‚úó Not Supported")),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"View Inscriptions"),g.createElement("span",{className:"stat-value"},ve("inscriptions")?"‚úì Supported":"‚úó Not Supported")),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"Create Inscriptions"),g.createElement("span",{className:"stat-value"},ve("createInscription")?"‚úì Supported":"‚úó Not Supported")),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"Public Key Access"),g.createElement("span",{className:"stat-value"},ve("getPublicKey")?"‚úì Supported":"‚úó Not Supported")),ve("getPublicKey")&&g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){try{const e=window.NexusWalletConnect.getCurrentProvider(),t=yield e.getPublicKey();alert(`Public Key: ${t}`)}catch(e){alert(`Error: ${e.message}`)}})},"üîë Get Public Key"),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"Push PSBT"),g.createElement("span",{className:"stat-value"},ve("pushPsbt")?"‚úì Supported":"‚úó Not Supported")),g.createElement("div",{className:"stat-item mt-sm"},g.createElement("span",{className:"stat-label"},"üõ†Ô∏è Utility Functions"),g.createElement("span",{className:"stat-value"},"‚úì Available")),(null==(l=window.NexusWalletConnect)?void 0:l.getCapabilities)&&g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){try{const e=yield window.NexusWalletConnect.getCapabilities();alert(`Wallet Capabilities:\n\n${JSON.stringify(e,null,2)}`)}catch(e){alert(`Error: ${e.message}`)}})},"üîç Get Capabilities"),(null==(c=window.NexusWalletConnect)?void 0:c.getUtxos)&&g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){try{const e=yield window.NexusWalletConnect.getUtxos();alert(`UTXOs (${(null==e?void 0:e.length)||0} found):\n\n${JSON.stringify((null==e?void 0:e.slice(0,3))||[],null,2)}${(null==e?void 0:e.length)>3?"\n\n... and more":""}`)}catch(e){alert(`Error: ${e.message}`)}})},"üì¶ Get UTXOs"),(null==(u=window.NexusWalletConnect)?void 0:u.getBRC20List)&&g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){try{const e=yield window.NexusWalletConnect.getBRC20List();alert(`BRC-20 Tokens (${(null==e?void 0:e.length)||0} found):\n\n${JSON.stringify((null==e?void 0:e.slice(0,5))||[],null,2)}${(null==e?void 0:e.length)>5?"\n\n... and more":""}`)}catch(e){alert(`Error: ${e.message}`)}})},"ü™ô Get BRC-20 List"),"xverse"===(null==(h=F.walletType)?void 0:h.toLowerCase())&&g.createElement(g.Fragment,null,g.createElement("div",{className:"stat-item mt-sm"},g.createElement("span",{className:"stat-label"},"ü™ô Runes Support"),g.createElement("span",{className:"stat-value"},"‚úì Full Support")),g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){try{const e=yield window.NexusWalletConnect.getRunesBalance();alert(`Runes Balance:\n\n${JSON.stringify(e,null,2)}`)}catch(e){alert(`Error: ${e.message}`)}})},"ü™ô Check Runes Balance"),g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){const e=prompt("Enter Rune name:");if(!e)return;const t=prompt("Enter recipient address:");if(!t)return;const n=prompt("Enter amount:");if(n)try{const r=yield window.NexusWalletConnect.transferRunes({runeName:e,recipient:t,amount:n});alert(`‚úÖ Runes transferred! TX: ${JSON.stringify(r)}`)}catch(r){alert(`Error: ${r.message}`)}})},"üí∏ Transfer Runes"),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"Multiple PSBTs"),g.createElement("span",{className:"stat-value"},"‚úì Supported")),g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){const e=prompt("Enter PSBTs to sign (one per line):");if(e)try{const t=e.split("\n").filter(e=>e.trim()),n=yield window.NexusWalletConnect.signMultipleTransactions(t);alert(`‚úÖ Signed ${n.length} PSBTs!\n\n${JSON.stringify(n,null,2)}`)}catch(t){alert(`Error: ${t.message}`)}})},"üìù Sign Multiple PSBTs"),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"Native Inscription"),g.createElement("span",{className:"stat-value"},"‚úì createInscription()"))),"leather"===(null==(y=F.walletType)?void 0:y.toLowerCase())&&g.createElement(g.Fragment,null,g.createElement("div",{className:"stat-item mt-sm"},g.createElement("span",{className:"stat-label"},"üî∑ Stacks Support"),g.createElement("span",{className:"stat-value"},"‚úì Full Stack")),g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){try{const e=yield window.NexusWalletConnect.getProductInfo();alert(`Product Info:\n\n${JSON.stringify(e,null,2)}`)}catch(e){alert(`Error: ${e.message}`)}})},"‚ÑπÔ∏è Get Product Info"),g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){try{const e=yield window.NexusWalletConnect.getURL();alert(`Leather URL: ${e}`)}catch(e){alert(`Error: ${e.message}`)}})},"üîó Get Wallet URL"),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"Structured Data"),g.createElement("span",{className:"stat-value"},"‚úì Signing")),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"Authentication"),g.createElement("span",{className:"stat-value"},"‚úì Supported"))),"magiceden"===(null==(v=F.walletType)?void 0:v.toLowerCase())&&g.createElement(g.Fragment,null,g.createElement("div",{className:"stat-item mt-sm"},g.createElement("span",{className:"stat-label"},"üé¥ Magic Eden API"),g.createElement("span",{className:"stat-value"},"‚úì JWT-based")),g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){try{const e=yield window.NexusWalletConnect.isHardware();alert(`Is Hardware Wallet: ${e}`)}catch(e){alert(`Error: ${e.message}`)}})},"üîê Check Hardware Status"),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"RPC Call Method"),g.createElement("span",{className:"stat-value"},"‚úì Available"))),"okx"===(null==(P=F.walletType)?void 0:P.toLowerCase())&&g.createElement(g.Fragment,null,g.createElement("div",{className:"stat-item mt-sm"},g.createElement("span",{className:"stat-label"},"üìù Inscription Tools"),g.createElement("span",{className:"stat-value"},"‚úì Advanced")),g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){const e=prompt("Enter BRC-20 ticker:","ordi");if(!e)return;const t=prompt("Enter amount:","100");if(t)try{const n=yield window.NexusWalletConnect.inscribeTransfer(e,t);alert(`‚úÖ Transfer inscribed! ${JSON.stringify(n)}`)}catch(n){alert(`Error: ${n.message}`)}})},"üìù Inscribe Transfer"),g.createElement("button",{className:"btn btn-secondary btn-sm mt-xs",onClick:()=>f(e,null,function*(){const e=prompt("Split UTXO into how many outputs?","5");if(e)try{const t=yield window.NexusWalletConnect.splitUtxo({count:parseInt(e)});alert(`‚úÖ UTXO split! TX: ${t}`)}catch(t){alert(`Error: ${t.message}`)}})},"‚úÇÔ∏è Split UTXO"),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"NFT Transfer"),g.createElement("span",{className:"stat-value"},"‚úì Supported")),g.createElement("div",{className:"stat-item"},g.createElement("span",{className:"stat-label"},"Asset Watching"),g.createElement("span",{className:"stat-value"},"‚úì Supported"))))),"inscriptions"===W&&g.createElement(g.Fragment,null,g.createElement("div",{className:"card"},g.createElement("div",{className:"card-header"},g.createElement("h2",{className:"card-title"},"Inscriptions"),g.createElement("p",{className:"card-subtitle"},"Your Bitcoin inscriptions")),ve("inscriptions")?0===$.length?g.createElement("div",{className:"empty-state"},X?g.createElement(g.Fragment,null,g.createElement("div",{className:"empty-state-icon"},"‚è≥"),g.createElement("h3",{className:"empty-state-title"},"Loading Inscriptions...")):g.createElement(g.Fragment,null,g.createElement("div",{className:"empty-state-icon"},"üì≠"),g.createElement("h3",{className:"empty-state-title"},"No Inscriptions Found"),g.createElement("p",{className:"empty-state-description"},"You don't have any inscriptions yet."))):g.createElement("div",{className:"inscriptions-list"},$.map((e,t)=>g.createElement(n,{key:e.inscriptionId||t,inscription:e}))):g.createElement("div",{className:"empty-state"},g.createElement("div",{className:"empty-state-icon"},"‚ÑπÔ∏è"),g.createElement("h3",{className:"empty-state-title"},"Inscriptions Not Supported"),g.createElement("p",{className:"empty-state-description"},F.walletType," wallet does not support inscription viewing.",g.createElement("br",null),"Try connecting with UniSat, Xverse, OKX, Wizz, or Oyl for full inscription support.")),ve("inscriptions")&&g.createElement("div",{className:"action-buttons mt-lg"},g.createElement("button",{className:"btn btn-primary",onClick:be,disabled:X},X?"‚è≥ Loading...":"üîÑ Refresh Inscriptions"),"xverse"===(null==(A=F.walletType)?void 0:A.toLowerCase())&&g.createElement(g.Fragment,null,g.createElement("button",{className:"btn btn-secondary",onClick:()=>f(e,null,function*(){const e=prompt("Enter inscription IDs to send (comma-separated):");if(!e)return;const t=prompt("Enter recipient address:");if(t){V(!0);try{const n=yield window.NexusWalletConnect.sendInscriptions({inscriptionIds:e.split(",").map(e=>e.trim()),recipient:t});alert(`‚úÖ Inscriptions sent! TX: ${JSON.stringify(n)}`)}catch(n){Y(`Failed to send inscriptions: ${n.message}`)}finally{V(!1)}}}),disabled:X},"üì§ Send Inscriptions"),g.createElement("button",{className:"btn btn-secondary",onClick:()=>f(e,null,function*(){const e=prompt("Enter content for repeat inscriptions:","Hello World");if(!e)return;const t=prompt("How many copies?","5");if(t){V(!0);try{const n={content:e,contentType:"text/plain;charset=utf-8",payloadType:"PLAIN_TEXT",repeat:parseInt(t),network:{type:"Mainnet"},suggestedMinerFeeRate:10},r=yield window.NexusWalletConnect.createRepeatInscriptions(n);alert(`‚úÖ Created ${t} inscriptions! Result: ${JSON.stringify(r)}`),yield be()}catch(n){Y(`Failed to create repeat inscriptions: ${n.message}`)}finally{V(!1)}}}),disabled:X},"üîÑ Create Repeat Inscriptions")))),ve("inscriptions")&&(null==(B=window.NexusWalletConnect)?void 0:B.getBRC20List)&&g.createElement("div",{className:"card mt-lg"},g.createElement("div",{className:"card-header"},g.createElement("h2",{className:"card-title"},"ü™ô BRC-20 Tokens"),g.createElement("p",{className:"card-subtitle"},"Your Bitcoin BRC-20 token holdings")),g.createElement("div",{className:"action-buttons"},g.createElement("button",{className:"btn btn-primary",onClick:()=>f(e,null,function*(){V(!0);try{const e=yield window.NexusWalletConnect.getBRC20List();if(!e||0===e.length)return void alert("üì≠ No BRC-20 tokens found in this wallet.");const t=e.map(e=>`${e.tick||e.ticker||"Unknown"}: ${e.balance||e.amount||"0"} (Transferable: ${e.transferable||e.transferableBalance||"0"})`).join("\n");alert(`ü™ô BRC-20 Tokens Found (${e.length}):\n\n${t}`),console.log("ü™ô Complete BRC-20 token data:",e)}catch(e){alert(`Error loading BRC-20 tokens: ${e.message}`)}finally{V(!1)}}),disabled:X},X?"‚è≥ Loading...":"ü™ô Load BRC-20 Tokens"),("okx"===(null==(N=F.walletType)?void 0:N.toLowerCase())||"unisat"===(null==(x=F.walletType)?void 0:x.toLowerCase()))&&g.createElement("button",{className:"btn btn-secondary",onClick:()=>f(e,null,function*(){const e=prompt("Enter BRC-20 ticker to transfer:","ordi");if(!e)return;const t=prompt("Enter amount to transfer:","100");if(t){V(!0);try{const n=yield window.NexusWalletConnect.inscribeTransfer(e,t);alert(`‚úÖ BRC-20 transfer inscription created!\n\nTicker: ${e}\nAmount: ${t}\n\nTransaction: ${JSON.stringify(n)}`)}catch(n){Y(`Failed to create BRC-20 transfer: ${n.message}`)}finally{V(!1)}}}),disabled:X},X?"‚è≥ Creating...":"üìù Create Transfer Inscription"),g.createElement("button",{className:"btn btn-secondary",onClick:()=>f(e,null,function*(){try{const e=yield window.NexusWalletConnect.getUtxos();if(!e||0===e.length)return void alert("üì≠ No UTXOs found in this wallet.");const t=e.slice(0,10).map((e,t)=>`${t+1}. ${e.satoshis||e.value||"0"} sats (${(e.txid||e.txId||"").substring(0,8)}...#${void 0!==e.vout?e.vout:e.outputIndex||0})`).join("\n"),n=e.reduce((e,t)=>e+(t.satoshis||t.value||0),0);alert(`üì¶ UTXOs Found (${e.length} total):\n\nTotal Value: ${n} satoshis\n\n${t}${e.length>10?"\n\n... and more":""}`),console.log("üì¶ Complete UTXO data:",e)}catch(e){alert(`Error loading UTXOs: ${e.message}`)}}),disabled:X},"üì¶ View UTXOs")))),"testing"===W&&g.createElement("div",{className:"card"},g.createElement("div",{className:"card-header"},g.createElement("h2",{className:"card-title"},"üß™ Wallet Testing"),g.createElement("p",{className:"card-subtitle"},"Test all ",F.walletType," methods with code snippets")),g.createElement(S,null)),"xverse"===W&&"xverse"===(null==(_=F.walletType)?void 0:_.toLowerCase())&&g.createElement(i,{isConnected:F.isConnected,walletState:F}),"settings"===W&&g.createElement("div",{className:"card"},g.createElement("div",{className:"card-header"},g.createElement("h2",{className:"card-title"},"Settings"),g.createElement("p",{className:"card-subtitle"},"Application preferences")),g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Theme"),g.createElement("select",{className:"form-select",value:H?"dark":"light",onChange:e=>M("dark"===e.target.value)},g.createElement("option",{value:"dark"},"Dark Mode"),g.createElement("option",{value:"light"},"Light Mode")),g.createElement("small",{className:"form-hint"},"Choose your preferred color theme")),g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Default Network"),g.createElement("select",{className:"form-select",disabled:!0},g.createElement("option",null,"Bitcoin Mainnet"),g.createElement("option",null,"Bitcoin Testnet")),g.createElement("small",{className:"form-hint"},"Network selection is controlled by your wallet")),g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Default Fee Rate (sat/vB)"),g.createElement("input",{type:"number",className:"form-input",defaultValue:"10",min:"1",placeholder:"10"}),g.createElement("small",{className:"form-hint"},"Suggested fee rate for transactions (1-100 sat/vB)")),g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Connected Wallet"),g.createElement("div",{className:"info-display"},g.createElement("strong",null,F.walletType)),g.createElement("small",{className:"form-hint"},"Currently connected wallet provider")),g.createElement("div",{className:"form-group"},g.createElement("label",{className:"form-label"},"Wallet Address"),g.createElement("div",{className:"info-display code"},F.address),g.createElement("small",{className:"form-hint"},"Your Bitcoin address")),g.createElement("hr",{className:"divider"}),g.createElement("div",{className:"action-buttons"},g.createElement("button",{className:"btn btn-secondary",onClick:()=>{var e,t;const n=window.NexusWalletConnect.getState(),r=(null==n?void 0:n.balance)&&"object"==typeof n.balance&&null!=(t=null!=(e=n.balance.totalSats)?e:n.balance.total)?t:null,i="number"==typeof r?r/1e8:n.balance,s={connected:n.isConnected,walletType:n.walletType,address:n.address,balance:null!=r?`${i} BTC (${r} sats)`:`${i} BTC`,coreLibraryVersion:window.NexusWalletConnect.version||"1.0.0"};alert(JSON.stringify(s,null,2))}},"View Wallet Info"),g.createElement("button",{className:"btn btn-danger",onClick:we},"Disconnect Wallet"))),(z||ae.sentTxId||ae.messageSignature||ae.signedPSBT)&&g.createElement("div",{className:"mt-lg"},z&&g.createElement("div",{className:"error-message mb-md"},z),ae.sentTxId&&g.createElement("div",{className:"success-message mb-md"},"Transaction sent! TX ID: ",ae.sentTxId.slice(0,20),"..."),ae.messageSignature&&g.createElement("div",{className:"success-message mb-md"},"‚úÖ Message signed! Signature: ","string"==typeof ae.messageSignature?ae.messageSignature.slice(0,20)+"...":(null==(C=ae.messageSignature.signature)?void 0:C.slice(0,20))+"..."||"Success"),ae.signedPSBT&&g.createElement("div",{className:"success-message mb-md"},"PSBT signed successfully!"))):g.createElement("div",{className:"welcome-screen"},g.createElement("div",{className:"welcome-card"},g.createElement("h1",{className:"welcome-heading"},"Welcome to Nexus OCW"),g.createElement("p",{className:"welcome-description"},"Connect your Bitcoin wallet to manage inscriptions, sign transactions, and interact with the Bitcoin blockchain. Supports multiple wallet providers with a unified interface."),g.createElement("button",{className:"btn btn-primary btn-large",onClick:me},"Connect Your Wallet ‚Üí")))),J&&g.createElement("div",{className:"modal-overlay",onClick:ye},g.createElement("div",{className:"modal-card",onClick:e=>e.stopPropagation()},g.createElement("div",{className:"modal-header"},g.createElement("h2",{className:"modal-title"},"Select Wallet"),g.createElement("button",{className:"modal-close",onClick:ye},"‚úï")),g.createElement("div",{className:"modal-body"},0===te.length?g.createElement("div",{className:"empty-state"},g.createElement("div",{className:"empty-state-icon"},"üîç"),g.createElement("h3",{className:"empty-state-title"},"No Wallets Found"),g.createElement("p",{className:"empty-state-description"},he()?"On mobile, wallets usually only appear inside the wallet's in-app browser.":"Please install a Bitcoin wallet extension to continue.",g.createElement("br",null),g.createElement("br",null),"Supported wallets:",g.createElement("br",null),"UniSat, Xverse, OKX, Leather, Phantom, Wizz, Magic Eden, Oyl, BitmapWallet"),g.createElement("div",{style:{display:"flex",gap:"var(--spacing-sm)",flexWrap:"wrap",justifyContent:"center",marginTop:"var(--spacing-md)"}},g.createElement("button",{className:"btn btn-secondary",onClick:fe,disabled:X},"Refresh"),he()&&g.createElement(g.Fragment,null,g.createElement("button",{className:"btn btn-secondary",onClick:()=>ge("UniSat"),disabled:X},"Open UniSat (connect)"),"function"==typeof(null==(k=window.NexusWalletConnect)?void 0:k.openMobileWallet)&&g.createElement(g.Fragment,null,g.createElement("button",{className:"btn btn-secondary",onClick:()=>f(e,null,function*(){try{yield window.NexusWalletConnect.openMobileWallet("Xverse")}catch(e){Y(String((null==e?void 0:e.message)||e))}}),disabled:X},"Open Xverse Browser"),g.createElement("button",{className:"btn btn-secondary",onClick:()=>f(e,null,function*(){try{yield window.NexusWalletConnect.openMobileWallet("Phantom")}catch(e){Y(String((null==e?void 0:e.message)||e))}}),disabled:X},"Open Phantom Browser"),g.createElement("button",{className:"btn btn-secondary",onClick:()=>f(e,null,function*(){try{yield window.NexusWalletConnect.openMobileWallet("MagicEden")}catch(e){Y(String((null==e?void 0:e.message)||e))}}),disabled:X},"Open Magic Eden Browser")))),he()&&g.createElement("p",{className:"empty-state-description",style:{marginTop:"var(--spacing-md)"}},"If you\\'re viewing this in Safari/Chrome, tap one of the buttons above or open this URL from inside your wallet app\\'s browser."),"UniSat"===(null==re?void 0:re.walletType)&&g.createElement("div",{style:{marginTop:"var(--spacing-lg)",width:"100%"}},g.createElement("h4",{style:{marginBottom:"var(--spacing-sm)"}},"Waiting for UniSat‚Ä¶"),g.createElement("p",{className:"empty-state-description"},"After approving in UniSat, return to this page. If UniSat shows a response link instead of returning here, paste it below."),g.createElement("textarea",{value:se,onChange:e=>oe(e.target.value),rows:3,placeholder:"Paste UniSat response (unisat://response?data=...&nonce=... or data=...&nonce=...)",style:{width:"100%",boxSizing:"border-box",padding:8}}),g.createElement("div",{style:{display:"flex",gap:"var(--spacing-sm)",justifyContent:"center",marginTop:"var(--spacing-sm)"}},g.createElement("button",{className:"btn btn-secondary",onClick:()=>{var e,t;try{null==(t=null==(e=window.NexusWalletConnect)?void 0:e.submitUniSatMobileResponse)||t.call(e,se),oe(""),Y(null)}catch(n){Y(String((null==n?void 0:n.message)||n))}},disabled:X},"Submit Response"),g.createElement("button",{className:"btn btn-secondary",onClick:()=>{ie(null),oe("")},disabled:X},"Cancel")))):g.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-sm)"}},te.map(e=>(pe.find(t=>t.name===e.name),g.createElement("button",{key:e.name,onClick:()=>ge(e.name),disabled:X,className:"btn btn-secondary",style:{width:"100%",justifyContent:"flex-start"}},j===e.name?"‚è≥ Connecting... ":"",e.name,e.features&&e.features.length>0&&g.createElement("span",{style:{marginLeft:"auto",fontSize:"0.8em",opacity:.7}},e.features.slice(0,2).join(", "))))),"UniSat"===(null==re?void 0:re.walletType)&&g.createElement("div",{style:{marginTop:"var(--spacing-md)"}},g.createElement("div",{className:"success-message mb-md"},"UniSat opened. Return here after approving.")))))),Z&&F.isConnected&&g.createElement(r,{walletState:F,onClose:()=>{ee(!1)},onInscriptionCreated:e=>{console.log("Inscription created:",e),setTimeout(()=>{be()},2e3)}}),j&&g.createElement("div",{className:"loading-overlay"},g.createElement("div",{className:"loading-spinner"},g.createElement("div",{className:"spinner-icon"},"‚è≥"),g.createElement("h3",null,"Connecting to ",null==(O=pe.find(e=>e.id===j))?void 0:O.name,"..."),g.createElement("p",null,"Please approve the connection in your wallet")))):g.createElement("div",{className:"nexus-wallet-app "+(H?"dark-theme":"light-theme")},g.createElement("div",{className:"loading-state",style:{minHeight:"100vh"}},g.createElement("div",{className:"spinner"})))};function A(e,t){const n={inscriptionId:e.inscriptionId||e.id,inscriptionNumber:e.inscriptionNumber||e.number,address:e.address,outputValue:e.outputValue||e.output_value||e.value,content:e.content,contentType:e.contentType||e.content_type||e.mimeType,contentLength:e.contentLength||e.content_length,timestamp:e.timestamp,genesisTransaction:e.genesisTransaction||e.genesis_transaction||e.genesis_tx,location:e.location,output:e.output,offset:e.offset};switch(t){case"Xverse":n.contentType=e.contentType||e.mimeType,n.inscriptionNumber=e.number;break;case"UniSat":n.contentType=e.contentType,n.inscriptionNumber=e.inscriptionNumber}return n}function B(e,t){const n=t?` (${t})`:"",r=(e,t)=>{if(null==e)return 0;if("bigint"==typeof e){const r=Number(e);if(!Number.isSafeInteger(r))throw new Error(`Invalid ${t}${n}: bigint exceeds safe integer range`);if(r<0)throw new Error(`Invalid ${t}${n}: must be >= 0`);return r}if("number"==typeof e){if(!Number.isFinite(e))throw new Error(`Invalid ${t}${n}: must be finite`);if(!Number.isInteger(e))throw new Error(`Invalid ${t}${n}: must be an integer sats amount (got non-integer number; did you pass BTC?)`);if(e<0)throw new Error(`Invalid ${t}${n}: must be >= 0`);return e}if("string"==typeof e){const r=e.trim();if(""===r)return 0;if(!/^[0-9]+$/.test(r))throw new Error(`Invalid ${t}${n}: must be a numeric string of sats`);const i=Number(r);if(!Number.isSafeInteger(i))throw new Error(`Invalid ${t}${n}: exceeds safe integer range`);return i}throw new Error(`Invalid ${t}${n}: unsupported type`)};if("number"==typeof e||"string"==typeof e||"bigint"==typeof e){const t=r(e,"totalSats");return{confirmedSats:t,unconfirmedSats:0,totalSats:t}}if(!e||"object"!=typeof e)throw new Error(`Invalid balance${n}: expected sats balance object`);let i=e.confirmed,s=e.unconfirmed,o=e.total;"UniSat"===t&&(null==i&&(i=e.confirm),null==s&&(s=e.pending)),null==o&&null!=e.amount&&(o=e.amount);const a=r(i,"confirmedSats"),l=r(s,"unconfirmedSats");return{confirmedSats:a,unconfirmedSats:l,totalSats:null==o?a+l:r(o,"totalSats")}}function N(e,t="balance"){if(!e||"object"!=typeof e)throw new Error(`${t}: expected { confirmedSats, unconfirmedSats, totalSats }`);for(const n of["confirmedSats","unconfirmedSats","totalSats"]){if(!(n in e))throw new Error(`${t}: missing ${n}`);const r=e[n];if(!("number"==typeof r&&Number.isSafeInteger(r)&&r>=0))throw new Error(`${t}: ${n} must be a non-negative integer number of sats`)}}function x(e,t="sighashTypes"){if(null==e)return;const n=Array.isArray(e)?e:[e],r=[];for(const i of n){const e="string"==typeof i&&""!==i.trim()?Number(i):i;if(!Number.isSafeInteger(e)||e<0)throw new Error(`${t}: invalid sighash type (expected integer, got ${String(i)})`);r.push(e)}return Array.from(new Set(r))}function _(e,t){const n={autoFinalized:!1!==e.autoFinalized,toSignInputs:e.toSignInputs||e.inputsToSign||[]};switch(t){case"Xverse":if(e.toSignInputs&&Array.isArray(e.toSignInputs)){const t={};e.toSignInputs.forEach(e=>{const n=e.address;t[n]||(t[n]=[]),"number"==typeof e.index&&t[n].push(e.index)}),n.signInputs=t}break;case"UniSat":case"OKX":n.toSignInputs=e.toSignInputs||[];break;case"Phantom":e.toSignInputs&&Array.isArray(e.toSignInputs)&&(n.inputsToSign=[{address:e.address,signingIndexes:e.toSignInputs.map(e=>e.index)}])}return n}function C(e){const t=(e||"").toLowerCase();return t.includes("main")||t.includes("live")?"livenet":t.includes("test")?"testnet":"livenet"}function k(e){return"string"==typeof e?e:"object"==typeof e&&null!==e?e.address||e.value||String(e):""}function O(e){return"string"==typeof e&&e.length>0&&e.length%2==0&&/^[0-9a-fA-F]+$/.test(e)}function U(e){const t=function(e){if("string"!=typeof e||0===e.length)return"";let t=e.trim();t=t.replace(/\s+/g,""),t=t.replace(/-/g,"+").replace(/_/g,"/");const n=t.length%4;return n&&(t+="=".repeat(4-n)),t}(e);let n;try{n=atob(t)}catch(i){throw new Error("Invalid base64")}let r="";for(let s=0;s<n.length;s++)r+=n.charCodeAt(s).toString(16).padStart(2,"0");return r}function R(e,t,n="input"){if(!e||"string"!=typeof e)throw new Error("Invalid PSBT: must be a non-empty string");const r=O(e),i=/^[A-Za-z0-9+/_\-]+=*$/.test(e.trim());if(!r&&!i)throw new Error("PSBT must be in hex or base64 format");if("input"===n){const n={Leather:"base64",Xverse:"base64",UniSat:"hex",OKX:"hex",MagicEden:"base64"}[t]||"hex";return"base64"===n&&r?function(e){if(!O(e))throw new Error("Invalid hex");let t="";for(let n=0;n<e.length;n+=2)t+=String.fromCharCode(parseInt(e.slice(n,n+2),16));return btoa(t)}(e):"hex"===n&&i?U(e):e}return i?U(e):e}const L={inscription:A,balance:B,psbtOptions:_,network:C,address:k,providerMethods:function(e){if(!e)return e;const t=d({},e);return!t.signPsbt&&e.signPSBT&&(t.signPsbt=e.signPSBT.bind(e)),t},psbtFormat:R},H={Payment:"payment",Ordinals:"ordinals",Stacks:"stacks"},M={Mainnet:"Mainnet",Testnet:"Testnet"},W=()=>"undefined"!=typeof window&&!0===window.NEXUS_WALLET_DEBUG,q=(...e)=>{W()&&console.log(...e)},F=(...e)=>{W()&&console.warn(...e)};function K(e){var t,n;if(!e)return null;if("function"==typeof e.request)return e;if(e.provider&&"function"==typeof e.provider.request)return e.provider;const r="sats-connect:";if(null==(n=null==(t=e.features)?void 0:t[r])?void 0:n.provider){const t=e.features[r].provider;if("function"==typeof t.request)return t}return null}function $(e){if(e&&"object"==typeof e){const t=["authorization","auth","access_token","id_token","refresh_token"];for(const n of t)if(Object.prototype.hasOwnProperty.call(e,n))throw new Error(`Refusing to build unsecured wallet envelope token containing credential-like field: ${n}`)}const t=e=>{try{const t=(new TextEncoder).encode(e);let n="";const r=32768;for(let e=0;e<t.length;e+=r)n+=String.fromCharCode(...t.subarray(e,e+r));return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(t){return btoa(unescape(encodeURIComponent(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}};return`${t(JSON.stringify({typ:"JWT",alg:"none"}))}.${t(JSON.stringify(e))}.`}function D(e){return $(e)}function X(e){return $(e)}function V(e={}){var t,n,r;if("undefined"==typeof window)return null;const i=e&&!0===e.allowGenericSatsConnect,s=e&&"string"==typeof e.expectedWallet?e.expectedWallet.toLowerCase():"",o=e=>{const t=(e=>String((null==e?void 0:e.name)||(null==e?void 0:e.id)||"").toLowerCase())(e);return!!t&&(s?"xverse"===s?t.includes("xverse"):"leather"===s?t.includes("leather")||"LeatherProvider"===(null==e?void 0:e.id)||"Leather"===(null==e?void 0:e.name):"magiceden"===s||"magic eden"===s?t.includes("magic")&&t.includes("eden"):t.includes(s):t.includes("xverse")||t.includes("leather")||"LeatherProvider"===(null==e?void 0:e.id)||"Leather"===(null==e?void 0:e.name))};if(window.btc_providers&&Array.isArray(window.btc_providers)&&window.btc_providers.length>0)for(const a of window.btc_providers){const e=K(a);if(e&&(o(a)||i))return q(`‚úÖ Using btc_providers provider: ${a.name||a.id||"sats-connect"}`),e}if(null==(n=null==(t=window.magicEden)?void 0:t.bitcoin)?void 0:n.isMagicEden)return q("‚úÖ Using window.magicEden.bitcoin (Magic Eden)"),window.magicEden.bitcoin;if(window.bitmapWallet&&"function"==typeof window.bitmapWallet.request)return q("‚úÖ Using window.bitmapWallet (BitmapWallet)"),window.bitmapWallet;if(window.BitcoinProvider&&"function"==typeof window.BitcoinProvider.request){if(!i&&s)throw new Error(`Refusing generic window.BitcoinProvider for expected wallet: ${s}`);if(!i&&!s)throw new Error("Refusing generic window.BitcoinProvider without explicit user consent");return q("‚úÖ Using generic window.BitcoinProvider (explicitly allowed)"),window.BitcoinProvider}return(null==(r=window.XverseProviders)?void 0:r.BitcoinProvider)?(q("‚úÖ Using window.XverseProviders.BitcoinProvider"),window.XverseProviders.BitcoinProvider):(F("‚ùå No Bitcoin wallet provider found"),null)}function j(e){return f(this,arguments,function*({purposes:e,message:t}){var n,r,i;const s=V();if(!s)throw new Error("No Bitcoin wallet found. Install Xverse, Leather, or Magic Eden.");if((null==(n=window.magicEden)?void 0:n.bitcoin)&&s===window.magicEden.bitcoin)return q("üîç Using Magic Eden direct connect()..."),yield function(e,t){return f(this,null,function*(){const n=window.magicEden.bitcoin,r=$({purposes:e||["payment","ordinals"],message:t||"Connect to view your Bitcoin addresses",network:{type:"Mainnet"}});q("üîç Calling Magic Eden connect() with JWT token...");const i=yield n.connect(r);if((null==i?void 0:i.addresses)&&Array.isArray(i.addresses))return i.addresses;throw new Error("Invalid response from Magic Eden")})}(e,t);const o=["wallet_connect","getAddresses"];let a=null;for(const c of o)try{q(`üîç Trying ${c}...`);const n=yield s.request(c,{purposes:e||[H.Payment,H.Ordinals],message:t||"Connect to view your Bitcoin addresses"});if("success"===(null==n?void 0:n.status))return n.result.addresses||n.result;if("error"===(null==n?void 0:n.status))throw new Error((null==(r=n.error)?void 0:r.message)||"Failed to get addresses");if(null==(i=null==n?void 0:n.result)?void 0:i.addresses)return n.result.addresses;if(null==n?void 0:n.addresses)return n.addresses;if(Array.isArray(n))return n;F(`‚ö†Ô∏è ${c} returned unexpected format, trying next method...`),a=new Error(`${c} returned unexpected format`)}catch(l){F(`‚ö†Ô∏è ${c} failed:`,(null==l?void 0:l.message)||String(l)),a=l}throw a||new Error("Failed to get addresses from wallet")})}function G(e){return f(this,arguments,function*({address:e,message:t,protocol:n="BIP322"}){var r;const i=V();if(!i)throw new Error("No Bitcoin wallet found");const s=yield i.request("signMessage",{address:e,message:t,protocol:n});if("success"===s.status)return s.result.signature||s.result;if("error"===s.status)throw new Error((null==(r=s.error)?void 0:r.message)||"Failed to sign message");return s})}function z(e){return f(this,arguments,function*({psbtBase64:e,inputsToSign:t,broadcast:n=!1}){var r;const i=V();if(!i)throw new Error("No Bitcoin wallet found");const s=yield i.request("signPsbt",{psbt:{psbtBase64:e,inputsToSign:t,broadcast:n}});if("success"===s.status)return{psbtBase64:s.result.psbtBase64||s.result,txid:s.result.txid};if("error"===s.status)throw new Error((null==(r=s.error)?void 0:r.message)||"Failed to sign PSBT");return s})}function Y(e){return f(this,arguments,function*({recipients:e}){var t;const n=V();if(!n)throw new Error("No Bitcoin wallet found");const r=yield n.request("sendTransfer",{recipients:e});if("success"===r.status)return r.result.txid||r.result;if("error"===r.status)throw new Error((null==(t=r.error)?void 0:t.message)||"Failed to send transfer");return r})}function J(e){return f(this,arguments,function*({offset:e=0,limit:t=100}){const n=V();if(!n)throw new Error("No Bitcoin wallet found");try{const r=yield n.request("ord_getInscriptions",{offset:e,limit:t});if("success"===r.status)return r.result.inscriptions||r.result.list||r.result||[]}catch(r){return F("Inscriptions not supported:",(null==r?void 0:r.message)||String(r)),[]}return[]})}function Q(){return f(this,arguments,function*(e={}){var t;const n=V();if(!n)throw new Error("No Bitcoin wallet found");try{const e=yield n.request("getBalance",void 0);let r;if(e&&"2.0"===e.jsonrpc&&e.result)r=e.result;else if(e&&"success"===e.status)r=e.result;else if("error"===e.status)throw new Error((null==(t=e.error)?void 0:t.message)||"Failed to get balance");const i=B(r,"sats-connect");return N(i,"WalletConnector.getBalance"),i}catch(r){throw F("getBalance not supported:",(null==r?void 0:r.message)||String(r)),r}})}const Z={AddressPurpose:H,BitcoinNetworkType:M,getBitcoinProvider:V,getAddresses:j,signMessage:G,signPsbt:z,sendTransfer:Y,getInscriptions:J,getBalance:Q,createWalletEnvelopeToken:$,createUnsecuredToken:D,createMagicEdenToken:X},ee=Object.freeze(Object.defineProperty({__proto__:null,AddressPurpose:H,BitcoinNetworkType:M,createMagicEdenToken:X,createUnsecuredToken:D,createWalletEnvelopeToken:$,default:Z,getAddresses:j,getBalance:Q,getBitcoinProvider:V,getInscriptions:J,sendTransfer:Y,signMessage:G,signPsbt:z},Symbol.toStringTag,{value:"Module"}));class te{constructor(e){this.name=e,this.isConnected=!1,this.address=null,this.publicKey=null,this.walletInstance=null,this.identity=null,this.features={connect:!0,getAddress:!0,getPublicKey:!1,getBalance:!0,getNetwork:!1,switchNetwork:!1,signMessage:!0,signPsbt:!0,signPsbts:!1,pushPsbt:!1,pushTx:!1,sendBitcoin:!0,sendInscription:!1,getInscriptions:!0,getAllInscriptions:!0,inscribe:!1,brc20:{transfer:!1,deploy:!1,mint:!1},runes:{send:!1,mint:!1,etch:!1},atomicals:{transfer:!1,mint:!1},arc20:{transfer:!1}}}requireInstalled(){if(!this.walletInstance)throw new Error(`${this.name} wallet not installed or not detected`)}requireConnected(){if(!this.isConnected||!this.address)throw new Error(`${this.name} wallet not connected. Please connect first.`)}supportsMethod(e){const t=e.split(".");let n=this.features;for(const r of t){if("object"!=typeof n||null===n)return!0===n;n=n[r]}return!0===n}safeCall(e,t,n){return f(this,null,function*(){if(!this.supportsMethod(e))throw new Error(n||`${this.name} does not support ${e}`);return yield t()})}connect(){return f(this,null,function*(){if(this.requireInstalled(),this.walletInstance.connect){const e=yield this.walletInstance.connect();return this.isConnected=!0,this.address=e.address||e,e}const e=yield this.getAddress();return this.isConnected=!0,this.address=e,{address:e}})}disconnect(){return f(this,null,function*(){var e;(null==(e=this.walletInstance)?void 0:e.disconnect)&&(yield this.walletInstance.disconnect()),this.isConnected=!1,this.address=null,this.publicKey=null})}getAddress(){return f(this,null,function*(){if(this.requireInstalled(),this.requireConnected(),this.walletInstance.getAddress)return yield this.walletInstance.getAddress();if(this.walletInstance.requestAccounts)return(yield this.walletInstance.requestAccounts())[0];throw new Error(`${this.name}: No method available to get address`)})}getPublicKey(){return f(this,null,function*(){return this.requireInstalled(),this.requireConnected(),yield this.safeCall("getPublicKey",()=>f(this,null,function*(){if(this.walletInstance.getPublicKey)return yield this.walletInstance.getPublicKey();throw new Error(`${this.name}: getPublicKey not implemented`)}))})}getBalance(){return f(this,null,function*(){if(this.requireInstalled(),this.requireConnected(),this.walletInstance.getBalance){const e=B(yield this.walletInstance.getBalance(),this.name);return N(e,`${this.name}.getBalance`),e}throw new Error(`${this.name}: getBalance not implemented`)})}getNetwork(){return f(this,null,function*(){return this.requireInstalled(),yield this.safeCall("getNetwork",()=>f(this,null,function*(){if(this.walletInstance.getNetwork)return yield this.walletInstance.getNetwork();throw new Error(`${this.name}: getNetwork not implemented`)}))})}switchNetwork(e){return f(this,null,function*(){return this.requireInstalled(),yield this.safeCall("switchNetwork",()=>f(this,null,function*(){if(this.walletInstance.switchNetwork)return yield this.walletInstance.switchNetwork(e);throw new Error(`${this.name}: switchNetwork not implemented`)}))})}signMessage(e,t="ecdsa"){return f(this,null,function*(){if(this.requireInstalled(),this.requireConnected(),this.walletInstance.signMessage)return yield this.walletInstance.signMessage(e,t);throw new Error(`${this.name}: signMessage not implemented`)})}signPsbt(e){return f(this,arguments,function*(e,t={}){if(this.requireInstalled(),this.requireConnected(),this.walletInstance.signPsbt)return yield this.walletInstance.signPsbt(e,t);throw new Error(`${this.name}: signPsbt not implemented`)})}signPsbts(e){return f(this,arguments,function*(e,t={}){return this.requireInstalled(),this.requireConnected(),yield this.safeCall("signPsbts",()=>f(this,null,function*(){if(this.walletInstance.signPsbts)return yield this.walletInstance.signPsbts(e,t);const n=[];for(const r of e)n.push(yield this.signPsbt(r,t));return n}))})}pushPsbt(e){return f(this,null,function*(){return this.requireInstalled(),this.requireConnected(),yield this.safeCall("pushPsbt",()=>f(this,null,function*(){if(this.walletInstance.pushPsbt)return yield this.walletInstance.pushPsbt(e);throw new Error(`${this.name}: pushPsbt not implemented`)}))})}pushTx(e){return f(this,null,function*(){return this.requireInstalled(),this.requireConnected(),yield this.safeCall("pushTx",()=>f(this,null,function*(){if(this.walletInstance.pushTx)return yield this.walletInstance.pushTx(e);throw new Error(`${this.name}: pushTx not implemented`)}))})}sendBitcoin(e,t){return f(this,arguments,function*(e,t,n={}){if(this.requireInstalled(),this.requireConnected(),this.walletInstance.sendBitcoin)return yield this.walletInstance.sendBitcoin(e,t,n);throw new Error(`${this.name}: sendBitcoin not implemented`)})}sendInscription(e,t){return f(this,arguments,function*(e,t,n={}){return this.requireInstalled(),this.requireConnected(),yield this.safeCall("sendInscription",()=>f(this,null,function*(){if(this.walletInstance.sendInscription)return yield this.walletInstance.sendInscription(e,t,n);throw new Error(`${this.name}: sendInscription not implemented`)}))})}getInscriptions(e=0,t=100){return f(this,null,function*(){if(this.requireInstalled(),this.requireConnected(),this.walletInstance.getInscriptions)return yield this.walletInstance.getInscriptions(e,t);throw new Error(`${this.name}: getInscriptions not implemented`)})}getAllInscriptions(){return f(this,null,function*(){this.requireInstalled(),this.requireConnected();const e=[];let t=0,n=0;for(;n<100;){const r=yield this.getInscriptions(t,100),i=r.list||r.inscriptions||r;if(!Array.isArray(i)||0===i.length)break;if(e.push(...i),i.length<100)break;t+=100,n++}return n>=100&&((...e)=>{if("undefined"!=typeof window&&!0===window.NEXUS_WALLET_DEBUG){const t="undefined"!=typeof globalThis?globalThis.console:void 0;t&&"function"==typeof t.warn&&t.warn(...e)}})(`‚ö†Ô∏è ${this.name}: Reached pagination safety limit (10000 inscriptions)`),e})}inscribe(e){return f(this,arguments,function*(e,t={}){return this.requireInstalled(),this.requireConnected(),yield this.safeCall("inscribe",()=>f(this,null,function*(){if(this.walletInstance.inscribe)return yield this.walletInstance.inscribe(e,t);throw new Error(`${this.name}: inscribe not implemented`)}))})}getInfo(){return{name:this.name,isInstalled:!!this.walletInstance,isConnected:this.isConnected,address:this.address,publicKey:this.publicKey,features:this.features}}getState(){const e=this.paymentAddress||this.address||null,t=this.ordinalsAddress||this.address||null,n=this.paymentPublicKey||this.publicKey||null,r=this.ordinalsPublicKey||this.publicKey||null;return{wallet:this.name,connected:!!this.isConnected,network:"mainnet",paymentAddress:e,ordinalsAddress:t,paymentPublicKey:n,ordinalsPublicKey:r,address:this.address||t||e||null}}}function ne(e){return"string"==typeof e&&e.trim().length>0}function re(e,t="value"){if(!ne(e))throw new Error(`${t} must be a non-empty string`);return e}function ie(e,t="hex"){re(e,t);const n=e.trim();if(!/^[0-9a-fA-F]+$/.test(n)||n.length%2!=0)throw new Error(`${t} must be a hex string with even length`);return n}function se(e,t="psbt"){if(e instanceof Uint8Array){if(0===e.length)throw new Error(`${t} must not be empty`);return e}return re(e,t),e}function oe(e,t="amount"){const n="string"==typeof e?Number(e):e;if(!Number.isFinite(n)||n<=0)throw new Error(`${t} must be a positive number`);if(Number.isInteger(n)&&!Number.isSafeInteger(n))throw new Error(`${t} is too large`);return n}function ae(e,t="address"){if(re(e,t),!function(e){if(!ne(e))return!1;const t=e.trim();return/^(bc1|tb1|bcrt1|[13]|[mn2])[a-zA-HJ-NP-Z0-9]{20,90}$/.test(t)}(e))throw new Error(`${t} must look like a Bitcoin address`);return e.trim()}function le(e,t="items"){if(!Array.isArray(e)||0===e.length)throw new Error(`${t} must be a non-empty array`);return e}const ce=()=>"undefined"!=typeof window&&!0===window.NEXUS_WALLET_DEBUG,ue=(...e)=>{ce()&&console.log(...e)},de=(...e)=>{ce()&&console.warn(...e)},pe=e=>{const t=String(e||"").trim();return t.length>0&&/^[0-9a-fA-F]+$/.test(t)&&t.length%2==0},he=e=>{let t=String(e||"").trim();t=t.replace(/ /g,"+"),t=t.replace(/-/g,"+").replace(/_/g,"/");const n=t.length%4;return 2===n?t+="==":3===n&&(t+="="),t},fe=(e,t)=>{const n=("function"==typeof t?t:e=>he(e))(e);if("function"!=typeof atob)throw new Error("Base64 decode unavailable (atob missing)");let r;try{r=atob(n)}catch(s){throw new Error(`Invalid base64: ${(null==s?void 0:s.message)||s}`)}let i="";for(let o=0;o<r.length;o++)i+=r.charCodeAt(o).toString(16).padStart(2,"0");return i};class ge{constructor(){this.appName="NexusWallet",this.pendingRequests=new Map,this._listenersAttached=!1,this._onMessage=null,this._onFocus=null,this._onVisibility=null,this.setupResponseListener()}_getFromValue(){try{if("undefined"!=typeof window){const e=window.NEXUS_UNISAT_FROM;if("string"==typeof e&&e.trim())return e.trim()}}catch(e){}return this.appName}_normalizeBase64(e){return he(e)}isMobile(){if("undefined"==typeof window)return!1;const e=navigator.userAgent.toLowerCase();return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e)}hasExtension(){return"undefined"!=typeof window&&void 0!==window.unisat}shouldUseMobile(){return this.isMobile()&&!this.hasExtension()}generateNonce(){if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){const e=new Uint8Array(16);return window.crypto.getRandomValues(e),Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")+"-"+Date.now().toString(16)}return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Date.now().toString(36)}toBase64(e){try{const t=JSON.stringify(e);if("undefined"!=typeof TextEncoder){const e=(new TextEncoder).encode(t);let n="";for(let t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return btoa(n)}return btoa(unescape(encodeURIComponent(t)))}catch(t){throw new Error(`Failed to encode data: ${t.message}`)}}fromBase64(e){try{const t=this._normalizeBase64(e),n=atob(t);if("undefined"!=typeof TextDecoder){const e=Uint8Array.from(n,e=>e.charCodeAt(0)),t=(new TextDecoder).decode(e);return JSON.parse(t)}return JSON.parse(decodeURIComponent(escape(atob(t))))}catch(t){throw new Error(`Failed to decode data: ${t.message}`)}}buildDeeplink(e,t=null){const n=this.generateNonce(),r=this._getFromValue();let i=`unisat://request?method=${encodeURIComponent(e)}&from=${encodeURIComponent(r)}&nonce=${encodeURIComponent(n)}`;if(null!==t){const e=this.toBase64(t);i+=`&data=${encodeURIComponent(e)}`}return{url:i,nonce:n}}setupResponseListener(){if("undefined"!=typeof window&&!this._listenersAttached&&(this._listenersAttached=!0,"URLSearchParams"in window)){const e=()=>{if(0===this.pendingRequests.size)return;const e=e=>{try{const t=String(e||"").replace(/^\?/,"").replace(/^#/,"");return new URLSearchParams(t)}catch(t){return null}},t=e(window.location.search),n=e(window.location.hash),r=e=>e?{data:e.get("data")||e.get("unisat_data"),nonce:e.get("nonce")||e.get("unisat_nonce"),error:e.get("error")||e.get("unisat_error")}:{nonce:null,data:null,error:null},i=r(t),s=r(n),o=i.nonce&&(i.data||i.error)?i:s.nonce&&(s.data||s.error)?s:null;o&&(this.handleResponse({data:o.data,nonce:o.nonce,error:o.error}),window.history.replaceState({},"",window.location.pathname))};this._onFocus=()=>e(),window.addEventListener("focus",this._onFocus),"undefined"!=typeof document&&"function"==typeof document.addEventListener&&(this._onVisibility=()=>{"visible"===document.visibilityState&&e()},document.addEventListener("visibilitychange",this._onVisibility))}}destroy(){if("undefined"!=typeof window&&this._listenersAttached){if(this._onMessage){try{window.removeEventListener("message",this._onMessage)}catch(e){}this._onMessage=null}if(this._onFocus){try{window.removeEventListener("focus",this._onFocus)}catch(e){}this._onFocus=null}if(this._onVisibility&&"undefined"!=typeof document){try{document.removeEventListener("visibilitychange",this._onVisibility)}catch(e){}this._onVisibility=null}this._listenersAttached=!1}}handleResponse(e){const{data:t,error:n,nonce:r}=e;if(!r)return void de("‚ö†Ô∏è UniSat mobile response missing nonce");const i=this.pendingRequests.get(r);if(i){if(this.pendingRequests.delete(r),clearTimeout(i.timeout),n){let e;try{const t=this.fromBase64(n);e=(null==t?void 0:t.message)||String(n)}catch(s){e=String(n)}return void i.reject(new Error(e||"User rejected request"))}if(t)try{const e=this.fromBase64(t);i.resolve(e)}catch(o){i.reject(new Error(`Failed to parse response: ${o.message}`))}else i.reject(new Error("Invalid response from UniSat mobile"))}else de("‚ö†Ô∏è UniSat mobile response for unknown nonce:",r)}sendRequest(e,t=null,n=12e4){return f(this,null,function*(){return this.startRequest(e,t,n).promise})}startRequest(e,t=null,n=12e4){const{url:r,nonce:i}=this.buildDeeplink(e,t);try{"undefined"!=typeof sessionStorage&&(sessionStorage.setItem("nexus_unisat_pending_nonce",i),sessionStorage.setItem("nexus_unisat_pending_started_at",String(Date.now())))}catch(o){}const s=new Promise((e,t)=>{const s=setTimeout(()=>{this.pendingRequests.delete(i);try{"undefined"!=typeof sessionStorage&&sessionStorage.getItem("nexus_unisat_pending_nonce")===i&&(sessionStorage.removeItem("nexus_unisat_pending_nonce"),sessionStorage.removeItem("nexus_unisat_pending_started_at"))}catch(o){}t(new Error("UniSat mobile request timeout"))},n);this.pendingRequests.set(i,{resolve:e,reject:t,timeout:s}),ue("üì± Opening UniSat mobile:",r),window.location.href=r});return{url:r,nonce:i,promise:s}}submitResponseText(e){const t=String(e||"").trim();if(!t)throw new Error("No response provided");let n=t;const r=t.indexOf("?"),i=t.indexOf("#");-1!==r?n=t.slice(r+1):-1!==i&&(n=t.slice(i+1)),n=n.replace(/^\?/,"").replace(/^#/,"").replace(/ /g,"+");const s=new URLSearchParams(n),o=s.get("nonce")||s.get("unisat_nonce"),a=s.get("data")||s.get("unisat_data"),l=s.get("error")||s.get("unisat_error");if(!o)throw new Error("Missing nonce");if(this.pendingRequests.has(o))return this.handleResponse({nonce:o,data:a,error:l}),{nonce:o};let c=null;try{"undefined"!=typeof sessionStorage&&(c=sessionStorage.getItem("nexus_unisat_pending_nonce"))}catch(d){}if(!c||c!==o)throw new Error("UniSat response nonce does not match any pending request");if(l){let e;try{const t=this.fromBase64(l);e=(null==t?void 0:t.message)||String(l)}catch(d){e=String(l)}try{"undefined"!=typeof sessionStorage&&(sessionStorage.removeItem("nexus_unisat_pending_nonce"),sessionStorage.removeItem("nexus_unisat_pending_started_at"))}catch(d){}throw new Error(e||"User rejected request")}if(!a)throw new Error("UniSat response missing data");const u=this.fromBase64(a);try{"undefined"!=typeof sessionStorage&&(sessionStorage.removeItem("nexus_unisat_pending_nonce"),sessionStorage.removeItem("nexus_unisat_pending_started_at"))}catch(d){}return{nonce:o,result:u}}}class me extends te{constructor(){var e,t;super("UniSat"),this.mobile=new ge,(null==(t=null==(e=this.mobile)?void 0:e.shouldUseMobile)?void 0:t.call(e))?this.identity="unisat:mobile-deeplink":"undefined"!=typeof window&&window.unisat?this.identity="unisat:window.unisat":this.identity=null,this.refreshCapabilities()}refreshCapabilities(){var e,t;const n=!0===(null==(t=null==(e=this.mobile)?void 0:e.shouldUseMobile)?void 0:t.call(e));this.features={connect:!0,getAddress:!0,getPublicKey:!0,getBalance:!n,getNetwork:!n,switchNetwork:!0,signMessage:!0,signPsbt:!0,signPsbts:!0,pushPsbt:!n,pushTx:!n,sendBitcoin:!n,sendInscription:!1,getInscriptions:!n,getAllInscriptions:!n,inscribe:!n,brc20:{transfer:!n,deploy:!1,mint:!1,list:!n},runes:{send:!n,mint:!1,etch:!1},atomicals:{transfer:!1,mint:!1},arc20:{transfer:!1}}}set walletInstance(e){this._walletInstance=e}get walletInstance(){return"undefined"!=typeof window&&window.unisat?(this.identity="unisat:window.unisat",window.unisat):this._walletInstance||null}requireInstalled(){var e;if(!(null==(e=this.mobile)?void 0:e.shouldUseMobile()))return super.requireInstalled();this.identity="unisat:mobile-deeplink"}isInstalled(){return this.refreshCapabilities(),!!this.walletInstance||this.mobile.shouldUseMobile()}connect(){return f(this,null,function*(){if(this.refreshCapabilities(),this.mobile.shouldUseMobile()){let e;ue("üì± Connecting via UniSat mobile app");try{e=yield this.mobile.sendRequest("connect")}catch(t){const n=String((null==t?void 0:t.message)||t||"");if(!/method\s*\[connect\]\s*not\s*found/i.test(n))throw t;e=yield this.mobile.sendRequest("requestAccounts")}const n=(()=>{if(Array.isArray(e)){const t=e[0];return{address:"string"==typeof t?t:(null==t?void 0:t.address)||null,publicKey:(null==t?void 0:t.publicKey)||null}}if(e&&"object"==typeof e){if("string"==typeof e.address)return{address:e.address,publicKey:e.publicKey||null};const t=e.accounts;if(Array.isArray(t)&&t.length>0){const e=t[0];return{address:"string"==typeof e?e:(null==e?void 0:e.address)||null,publicKey:(null==e?void 0:e.publicKey)||null}}}return{address:null,publicKey:null}})();if(n.address)return this.address=n.address,this.publicKey=n.publicKey||null,this.isConnected=!0,ue("‚úÖ UniSat mobile connected:",n.address),{address:this.address,publicKey:this.publicKey};throw new Error("Failed to connect to UniSat mobile wallet")}this.requireInstalled();const e=yield this.walletInstance.requestAccounts();if(e&&e.length>0)return this.address=e[0],this.isConnected=!0,ue("‚úÖ UniSat connected"),{address:this.address};throw new Error("Failed to connect to UniSat wallet")})}getAddress(){return f(this,null,function*(){if(this.requireInstalled(),this.requireConnected(),this.address)return this.address;if(this.mobile.shouldUseMobile())return null;const e=yield this.walletInstance.getAccounts();return e&&e.length>0?e[0]:null})}getPublicKey(){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile()){if(this.publicKey)return this.publicKey;throw new Error("UniSat mobile: publicKey not available. Reconnect to fetch it.")}return yield this.walletInstance.getPublicKey()})}getBalance(){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: getBalance is not supported via deeplink");const e=yield this.walletInstance.getBalance();return L.balance(e,"UniSat")})}getNetwork(){return f(this,null,function*(){if(this.requireInstalled(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: getNetwork is not supported via deeplink");const e=yield this.walletInstance.getNetwork();return L.network(e)})}_toUniSatMobileChain(e){const t=String(e||"").trim();if("BITCOIN_MAINNET"===t||"BITCOIN_TESTNET"===t||"BITCOIN_TESTNET4"===t||"BITCOIN_SIGNET"===t||"FRACTAL_BITCOIN_MAINNET"===t||"FRACTAL_BITCOIN_TESTNET"===t)return t;const n=t.toLowerCase();return"mainnet"===n||"livenet"===n||"bitcoin_mainnet"===n?"BITCOIN_MAINNET":"testnet"===n||"bitcoin_testnet"===n?"BITCOIN_TESTNET":"testnet4"===n||"bitcoin_testnet4"===n?"BITCOIN_TESTNET4":"signet"===n||"bitcoin_signet"===n?"BITCOIN_SIGNET":t}switchNetwork(e){return f(this,null,function*(){if(this.mobile.shouldUseMobile()){const t=this._toUniSatMobileChain(e);return ue("üì± Switching network via UniSat mobile app"),yield this.mobile.sendRequest("switchChain",[t]),void ue("‚úÖ UniSat mobile network switched")}this.requireInstalled(),yield this.walletInstance.switchNetwork(e),ue("‚úÖ UniSat network switched")})}getChain(){return f(this,null,function*(){if(this.requireInstalled(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: getChain is not supported via deeplink");return yield this.walletInstance.getChain()})}switchChain(e){return f(this,null,function*(){if(this.mobile.shouldUseMobile()){const t=this._toUniSatMobileChain(e);return ue("üì± Switching chain via UniSat mobile app"),yield this.mobile.sendRequest("switchChain",[t]),void ue("‚úÖ UniSat mobile chain switched")}this.requireInstalled(),yield this.walletInstance.switchChain(e),ue("‚úÖ UniSat chain switched")})}signMessage(e,t="ecdsa"){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile()){ue("üì± Signing message via UniSat mobile app");const n=yield this.mobile.sendRequest("signMessage",[e,t]);return ue("‚úÖ UniSat mobile message signed"),n}return yield this.walletInstance.signMessage(e,t)})}multiSignMessage(e,t="ecdsa"){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: multiSignMessage is not supported via deeplink");return yield this.walletInstance.multiSignMessage(e,t)})}signData(e,t="ecdsa"){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: signData is not supported via deeplink");return yield this.walletInstance.signData(e,t)})}signPsbt(e){return f(this,arguments,function*(e,t={}){if(this.requireConnected(),!e||"string"!=typeof e)throw new Error("Invalid PSBT: must be a non-empty string");const n=(()=>{var t,n;const r=String(e).trim();if(pe(r))return r;try{return fe(r,null==(n=null==(t=this.mobile)?void 0:t._normalizeBase64)?void 0:n.bind(this.mobile))}catch(i){return r}})();if(this.mobile.shouldUseMobile()){ue("üì± Signing PSBT via UniSat mobile app");const e=yield this.mobile.sendRequest("signPsbt",[n,t]);return ue("‚úÖ UniSat mobile PSBT signed"),e}let r;ue("üîè UniSat: Signing PSBT...");try{r=yield this.walletInstance.signPsbt(n,t)}catch(i){const e=String((null==i?void 0:i.message)||i||"");if(/sighash\s*type\s*is\s*not\s*allowed/i.test(e)||/sighashTypes/i.test(e))throw new Error(e);if(/without\s*utxo\s*data/i.test(e)||/utxo\s*data/i.test(e))throw new Error(`UniSat signPsbt failed: ${e}. This usually means one or more PSBT inputs are missing witnessUtxo/nonWitnessUtxo (and for Taproot, tapInternalKey may be required).`);if(t&&Object.keys(t).length>0){if(!(/invalid\s*params/i.test(e)||/argument/i.test(e)||/parameters?/i.test(e)||/not\s*support/i.test(e)||/too\s*many/i.test(e)))throw new Error(e);de("‚ö†Ô∏è UniSat signPsbt(options) unsupported by this build, retrying without options"),r=yield this.walletInstance.signPsbt(n)}else r=yield this.walletInstance.signPsbt(n)}if(!r)throw new Error("No signed PSBT returned from UniSat");return ue("‚úÖ UniSat PSBT signed successfully"),r})}signPsbts(e){return f(this,arguments,function*(e,t=[]){if(this.requireConnected(),!Array.isArray(e))throw new Error("Invalid PSBTs: must be an array");const n=e.map((e,t)=>{var n,r;if("string"!=typeof e||0===e.length)throw new Error(`Invalid PSBT at index ${t}: must be a non-empty string`);const i=e.trim();if(pe(i))return i;try{return fe(i,null==(r=null==(n=this.mobile)?void 0:n._normalizeBase64)?void 0:r.bind(this.mobile))}catch(s){throw new Error(`Invalid PSBT at index ${t}: must be hex or base64`)}});if(this.mobile.shouldUseMobile()){ue("üì± Signing multiple PSBTs via UniSat mobile app");const e=yield this.mobile.sendRequest("signPsbts",[n,t]);return ue("‚úÖ UniSat mobile PSBTs signed"),e}return yield this.walletInstance.signPsbts(n,t)})}pushPsbt(e){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: pushPsbt is not supported via deeplink");const t=yield this.walletInstance.pushPsbt(e);return ue("‚úÖ UniSat PSBT pushed"),t})}pushTx(e){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: pushTx is not supported via deeplink");let t,n;if("string"==typeof e)t=e.trim();else{if(!e||"object"!=typeof e||"string"!=typeof e.rawtx)throw new Error("Invalid rawtx: expected hex string");t=e.rawtx.trim()}if(!pe(t))throw new Error("Invalid rawtx: expected hex string");try{n=yield this.walletInstance.pushTx(t)}catch(r){try{n=yield this.walletInstance.pushTx({rawtx:t})}catch(i){throw new Error(`UniSat pushTx failed (string & object attempts): ${(null==i?void 0:i.message)||i}`)}}if(!n||"string"!=typeof n)throw new Error("UniSat pushTx did not return a txid");return ue("‚úÖ UniSat raw TX pushed"),n})}verifyMessageOfBIP322Simple(e,t,n){return f(this,null,function*(){if(this.requireInstalled(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: verifyMessageOfBIP322Simple is not supported via deeplink");return yield this.walletInstance.verifyMessageOfBIP322Simple(e,t,n)})}sendBitcoin(e,t){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: sendBitcoin is not supported via deeplink");ae(e,"toAddress"),oe(t,"amount");const n=yield this.walletInstance.sendBitcoin(e,t);return ue("‚úÖ UniSat transaction sent"),n})}getBitcoinUtxos(){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: getBitcoinUtxos is not supported via deeplink");return yield this.walletInstance.getBitcoinUtxos()})}getInscriptions(e=0,t=100){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: getInscriptions is not supported via deeplink");const n=yield this.walletInstance.getInscriptions(e,t);return n&&n.list?(ue(`üì¶ UniSat returned ${n.list.length} inscriptions`),{list:n.list.map(e=>L.inscription(e,"UniSat")),total:n.total}):{list:[],total:0}})}inscribe(e){return f(this,arguments,function*(e,t={}){var n;if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: inscribe is not supported via deeplink");const{contentType:r="text/plain;charset=utf-8",feeRate:i=10,metadata:s}=t;if(r.includes("brc-20")||s&&s.brc20){let t;if(s&&s.brc20)t=s.brc20;else try{t=JSON.parse(e)}catch(o){throw new Error("Invalid BRC-20 content: expected JSON")}return yield this.inscribeTransfer(t.tick,t.amt)}return ue("üìù UniSat: PSBT signing supported (app builds commit+reveal)"),{method:"psbt",requiresPsbtBuilding:!0,walletSupportsSign:"function"==typeof(null==(n=this.walletInstance)?void 0:n.signPsbt),message:"Build commit+reveal PSBTs externally; wallet will sign/broadcast as requested."}})}inscribeTransfer(e,t){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: inscribeTransfer is not supported via deeplink");const n=yield this.walletInstance.inscribeTransfer(e,t);return ue("‚úÖ UniSat BRC-20 transfer inscribed"),n})}getBRC20List(){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: getBRC20List is not supported via deeplink");try{return this.walletInstance.getBRC20Summary?yield this.walletInstance.getBRC20Summary():(de("‚ö†Ô∏è UniSat BRC-20 listing not available in this wallet version"),[])}catch(e){throw de("‚ùå Failed to get BRC-20 list"),e}})}sendRunes(e,t,n){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: sendRunes is not supported via deeplink");ae(e,"toAddress"),re(t,"runeName"),oe(n,"amount");const r=yield this.walletInstance.sendRunes(e,t,n);return ue("‚úÖ UniSat runes sent"),r})}getAccounts(){return f(this,null,function*(){if(this.requireInstalled(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: getAccounts is not supported via deeplink");return yield this.walletInstance.getAccounts()})}getVersion(){return f(this,null,function*(){if(this.requireInstalled(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: getVersion is not supported via deeplink");return yield this.walletInstance.getVersion()})}getBalanceV2(){return f(this,null,function*(){if(this.requireConnected(),this.mobile.shouldUseMobile())throw new Error("UniSat mobile: getBalanceV2 is not supported via deeplink");return yield this.walletInstance.getBalanceV2()})}setupEventListeners(){if(!this.isInstalled())return;const e=this.walletInstance;e&&e.on&&(this._unisatHandlers&&this.removeEventListeners(),this._unisatHandlers={accountsChanged:e=>{ue("üë§ UniSat accounts changed"),e&&0!==e.length?this.address=e[0]:(this.address=null,this.publicKey=null,this.isConnected=!1)},networkChanged:e=>{ue("üåê UniSat network changed")}},e.on("accountsChanged",this._unisatHandlers.accountsChanged),e.on("networkChanged",this._unisatHandlers.networkChanged),ue("‚úÖ UniSat event listeners set up"))}removeEventListeners(){if(!this.isInstalled())return;const e=this.walletInstance,t=this._unisatHandlers;if(!e||!t)return;const n=e.off||e.removeListener;if("function"==typeof n){try{n.call(e,"accountsChanged",t.accountsChanged)}catch(r){}try{n.call(e,"networkChanged",t.networkChanged)}catch(r){}}this._unisatHandlers=null}disconnect(){return f(this,null,function*(){var e,t;try{this.removeEventListeners()}catch(n){}try{null==(t=null==(e=this.mobile)?void 0:e.destroy)||t.call(e)}catch(n){}return yield h(me.prototype,this,"disconnect").call(this)})}destroy(){var e,t;try{this.removeEventListeners()}catch(n){}try{null==(t=null==(e=this.mobile)?void 0:e.destroy)||t.call(e)}catch(n){}}}const ye=()=>"undefined"!=typeof window&&!0===window.NEXUS_WALLET_DEBUG,we=(...e)=>{if(ye()){const t="undefined"!=typeof globalThis?globalThis.console:void 0;t&&"function"==typeof t.log&&t.log(...e)}},be=(...e)=>{if(ye()){const t="undefined"!=typeof globalThis?globalThis.console:void 0;t&&"function"==typeof t.warn&&t.warn(...e)}},ve=(...e)=>{if(ye()){const t="undefined"!=typeof globalThis?globalThis.console:void 0;t&&"function"==typeof t.error&&t.error(...e)}},Ee=(...e)=>{"undefined"!=typeof window&&!0===window.NEXUS_WALLET_DEBUG&&console.log(...e)};class Se extends te{constructor(){var e,t;super("OKX"),this.identity="undefined"!=typeof window&&(null==(e=window.okxwallet)?void 0:e.bitcoin)?"okx:window.okxwallet.bitcoin":null,this._walletInstance=null,this._okxHandlers=null,this._listenersAttached=!1,this.walletInstance="undefined"!=typeof window?null==(t=window.okxwallet)?void 0:t.bitcoin:null,this.features={connect:!0,getAddress:!1,getPublicKey:!0,getBalance:!0,getNetwork:!0,switchNetwork:!1,signMessage:!0,signPsbt:!0,signPsbts:!0,pushPsbt:!1,pushTx:!1,sendBitcoin:!0,sendInscription:!0,getInscriptions:!0,getAllInscriptions:!0,inscribe:!0,brc20:{transfer:!0,deploy:!0,mint:!0},runes:{send:!1,mint:!1,etch:!1},atomicals:{transfer:!1,mint:!1},arc20:{transfer:!1}},this.refreshCapabilities()}set walletInstance(e){this._walletInstance=e}get walletInstance(){var e;const t="undefined"!=typeof window?null==(e=window.okxwallet)?void 0:e.bitcoin:null;return t&&(this.identity="okx:window.okxwallet.bitcoin"),t||this._walletInstance||null}refreshCapabilities(){const e=this.walletInstance;this.features.signPsbts=!!(null==e?void 0:e.signPsbts)}isInstalled(){return this.refreshCapabilities(),!!this.walletInstance}connect(){return f(this,null,function*(){this.requireInstalled();const e=yield this.walletInstance.connect();return this.address=e.address||e,this.publicKey=e.publicKey,this.isConnected=!0,this.refreshCapabilities(),this.setupEventListeners(),Ee("‚úÖ OKX connected"),e})}getAddress(){return f(this,null,function*(){this.requireConnected();const e=yield this.walletInstance.getAccounts();return e&&e.length>0?e[0]:this.address})}getPublicKey(){return f(this,null,function*(){return this.requireConnected(),yield this.walletInstance.getPublicKey()})}getBalance(){return f(this,null,function*(){this.requireConnected();const e=yield this.walletInstance.getBalance();return L.balance(e,"OKX")})}getNetwork(){return f(this,null,function*(){this.requireInstalled();const e=yield this.walletInstance.getNetwork();return L.network(e)})}signMessage(e,t="ecdsa"){return f(this,null,function*(){return this.requireConnected(),yield this.walletInstance.signMessage(e,t)})}signPsbt(e){return f(this,arguments,function*(e,t={}){this.requireConnected(),se(e,"psbt"),Ee("üîè OKX: Signing PSBT...");const n=L.psbtFormat(e,"OKX","input"),r=d({},t||{});!1===r.autoFinalized&&(r.autoFinalize=!1);const i=yield this.walletInstance.signPsbt(n,r);return Ee("‚úÖ OKX PSBT signed"),i})}signPsbts(e){return f(this,arguments,function*(e,t=[]){if(this.requireConnected(),le(e,"psbts"),Ee("üîè OKX: Signing multiple PSBTs..."),!Array.isArray(e))throw new Error("Invalid PSBTs: must be an array");const n=e.map((e,t)=>{try{return L.psbtFormat(e,"OKX","input")}catch(n){throw new Error(`Invalid PSBT at index ${t}: must be hex or base64`)}}),r=yield this.walletInstance.signPsbts(n,t);return Ee("‚úÖ OKX PSBTs signed"),r})}pushPsbt(e){return f(this,null,function*(){throw new Error("OKX broadcast not supported - use OrdNexus extension or Bitcoin Proxy")})}pushTx(e){return f(this,null,function*(){throw new Error("OKX broadcast not supported - use OrdNexus extension or Bitcoin Proxy")})}sendBitcoin(e,t){return f(this,null,function*(){this.requireConnected(),ae(e,"toAddress"),oe(t,"satoshis");const n=yield this.walletInstance.sendBitcoin(e,t);return Ee("‚úÖ OKX transaction sent"),n})}sendInscription(e,t){return f(this,arguments,function*(e,t,n={}){this.requireConnected();const r=yield this.walletInstance.sendInscription(e,t,n);return Ee("‚úÖ OKX inscription sent"),r})}getInscriptions(e=0,t=100){return f(this,null,function*(){this.requireConnected();const n=yield this.walletInstance.getInscriptions(e,t);return n&&n.list?{list:n.list.map(e=>L.inscription(e,"OKX")),total:n.total}:{list:[],total:0}})}inscribe(e){return f(this,arguments,function*(e,t={}){if(this.requireConnected(),"string"==typeof e&&e.length<=5&&!t.contentType&&!t.receiveAddress)return Ee("üé´ OKX: Creating BRC-20 transfer inscription"),yield this.walletInstance.inscribe({type:51,from:this.address,tick:e});Ee("üé® OKX: Creating general inscription via mint()");const n={contentType:t.contentType||"text/plain;charset=utf-8",body:e},r={type:61,from:this.address,inscriptions:[n]};return Ee("üîç OKX mint payload prepared"),yield this.walletInstance.mint(r)})}inscribeTransfer(e,t){return f(this,null,function*(){this.requireConnected();const t=yield this.walletInstance.inscribe({type:51,from:this.address,tick:e});return Ee("‚úÖ OKX BRC-20 transfer inscribed"),t})}getAccounts(){return f(this,null,function*(){return this.requireInstalled(),yield this.walletInstance.getAccounts()})}splitUtxo(e){return f(this,null,function*(){return this.requireConnected(),yield this.walletInstance.splitUtxo(e)})}transferNft(e,t){return f(this,null,function*(){return this.requireConnected(),yield this.walletInstance.transferNft(e,t)})}watchAsset(e){return f(this,null,function*(){return this.requireInstalled(),yield this.walletInstance.watchAsset(e)})}mint(e){return f(this,null,function*(){return this.requireConnected(),e.from||(e.from=this.address),yield this.walletInstance.mint(e)})}setupEventListeners(){if(!this.isInstalled())return;const e=this.walletInstance;e&&e.on&&(this._listenersAttached||(this._okxHandlers={accountsChanged:e=>{Ee("üë§ OKX accounts changed"),e&&0!==e.length?this.address=e[0]:(this.address=null,this.publicKey=null,this.isConnected=!1)},networkChanged:e=>{Ee("üåê OKX network changed")}},e.on("accountsChanged",this._okxHandlers.accountsChanged),e.on("networkChanged",this._okxHandlers.networkChanged),this._listenersAttached=!0,Ee("‚úÖ OKX event listeners set up")))}removeEventListeners(){var e,t;if(!this.isInstalled())return;const n=this.walletInstance;if(!n||!this._okxHandlers)return;const r=(null==(e=n.off)?void 0:e.bind(n))||(null==(t=n.removeListener)?void 0:t.bind(n));r&&(r("accountsChanged",this._okxHandlers.accountsChanged),r("networkChanged",this._okxHandlers.networkChanged)),this._listenersAttached=!1,this._okxHandlers=null}disconnect(){return f(this,null,function*(){this.removeEventListeners(),yield h(Se.prototype,this,"disconnect").call(this)})}destroy(){this.removeEventListeners()}}const Ie=()=>"undefined"!=typeof window&&!0===window.NEXUS_WALLET_DEBUG,Te=(...e)=>{Ie()&&console.log(...e)},Pe=(...e)=>{Ie()&&console.warn(...e)};class Ae extends te{constructor(){super("Leather"),this._walletInstance=null,this.walletInstance=this.getProvider(),this.identity=this.walletInstance?this.identity:null,this.features={connect:!0,getAddress:!0,getPublicKey:!1,getBalance:!1,getNetwork:!1,switchNetwork:!1,signMessage:!0,signPsbt:!0,signPsbts:!1,pushPsbt:!1,pushTx:!1,sendBitcoin:!1,sendInscription:!1,getInscriptions:!1,getAllInscriptions:!1,inscribe:!1,brc20:!1,runes:!1,atomicals:!1,arc20:!1,stacksSupport:!0,structuredData:!0,authentication:!0,stacksTransaction:!0,profileUpdate:!0,getProductInfo:!0,getURL:!0}}set walletInstance(e){this._walletInstance=e}get walletInstance(){return this.getProvider()||this._walletInstance||null}getProvider(){if("undefined"==typeof window)return null;if(window.LeatherProvider)return Te("üîç Found Leather at window.LeatherProvider"),this.identity="leather:window.LeatherProvider",window.LeatherProvider;if(window.HiroWalletProvider)return Te("üîç Found Hiro Wallet at window.HiroWalletProvider"),this.identity="leather:window.HiroWalletProvider",window.HiroWalletProvider;if(window.btc_providers&&Array.isArray(window.btc_providers))for(const e of window.btc_providers)if(("LeatherProvider"===e.id||"Leather"===e.name)&&"function"==typeof e.request){Te("üîç Found Leather provider in btc_providers");const t=e.id||e.name||"unknown";return this.identity=`leather:btc_providers:${t}`,e}return this.identity=null,null}isInstalled(){return!!this.walletInstance}connect(){return f(this,null,function*(){var e;this.requireInstalled();try{const t=this.getProvider();if(!t||"function"!=typeof t.request)throw new Error("Leather provider.request method not available");Te('üîç Calling Leather provider.request("getAddresses")...');const n=yield t.request("getAddresses"),r=(null==(e=n.result)?void 0:e.addresses)||n.addresses;if(!r||0===r.length)throw new Error("No addresses returned from Leather");Te("üîç Available address types from Leather:",r.map(e=>e.type));const i=r.find(e=>"p2tr"===e.type),s=r.find(e=>"p2wpkh"===e.type),o=i||s||r[0],a=s||i||r[0];return i&&s?Te("‚úÖ Using Taproot (ordinals) + SegWit (payments) for optimal setup"):i?Te("‚ÑπÔ∏è Using Taproot for both addresses (SegWit not available)"):s?Te("‚ÑπÔ∏è Using SegWit for both addresses (Taproot not available)"):Pe("‚ö†Ô∏è Unknown address type, using first available"),this.address=null==o?void 0:o.address,this.ordinalsAddress=null==o?void 0:o.address,this.paymentAddress=null==a?void 0:a.address,this.isConnected=!0,Te("‚úÖ Leather connected"),{address:this.address,ordinalsAddress:this.ordinalsAddress,paymentAddress:this.paymentAddress,allAddresses:r}}catch(t){throw Pe("‚ùå Leather connection failed"),t}})}getAddress(){return f(this,null,function*(){return this.requireConnected(),this.address})}getAccounts(){return f(this,null,function*(){var e;this.requireConnected();try{const t=this.getProvider(),n=yield t.request("getAddresses");return(null==(e=n.result)?void 0:e.addresses)||n.addresses}catch(t){throw Pe("‚ùå Failed to get accounts"),t}})}getProductInfo(){return f(this,null,function*(){this.requireInstalled();try{const e=this.getProvider(),t=yield e.getProductInfo();return Te("‚úÖ Leather product info received"),t}catch(e){throw Pe("‚ùå Failed to get product info"),e}})}getURL(){return f(this,null,function*(){this.requireInstalled();try{const e=this.getProvider();return yield e.getURL()}catch(e){throw Pe("‚ùå Failed to get URL"),e}})}signMessage(e){return f(this,arguments,function*(e,t={}){this.requireConnected();try{const n=this.getProvider();Te("üîè Leather: Signing message via signatureRequest...");const r=yield n.signatureRequest(d({message:e},t));return Te("‚úÖ Leather message signed"),r}catch(n){throw Pe("‚ùå Failed to sign message"),n}})}signStructuredData(e){return f(this,null,function*(){this.requireConnected();try{const t=this.getProvider();Te("üîè Leather: Signing structured data...");const n=yield t.structuredDataSignatureRequest(e);return Te("‚úÖ Leather structured data signed"),n}catch(t){throw Pe("‚ùå Failed to sign structured data"),t}})}signPsbt(e){return f(this,arguments,function*(e,t={}){var n,r,i;this.requireConnected(),re(e,"psbt");try{const c=this.getProvider();if(!c)throw new Error("Leather provider not available");Te("üîè Leather: Preparing PSBT for signing..."),Te("   Testing both HEX and BASE64 formats...");const u=(null==t?void 0:t.toSignInputs)||(null==t?void 0:t.inputsToSign)||[],d=Array.isArray(u)?u.map(e=>"number"==typeof(null==e?void 0:e.index)?e.index:null).filter(e=>null!==e):void 0,p={};Array.isArray(u)&&u.forEach(e=>{if("number"==typeof(null==e?void 0:e.index))if("number"==typeof e.sighashType)p[e.index]=e.sighashType;else if(Array.isArray(e.sighashTypes)&&e.sighashTypes.length>0){const t=e.sighashTypes.find(e=>0!==e&&0!==e);t&&(p[e.index]=t)}});const h=(e,n=!1)=>{const r=n?{psbt:e}:{hex:e};return"boolean"==typeof(null==t?void 0:t.broadcast)&&(r.broadcast=!!t.broadcast),(null==t?void 0:t.network)&&(r.network=t.network),d&&d.length>0&&(r.signAtIndex=d),Object.keys(p).length>0&&(r.inputSighashMap=p,Te("   üîç Passing sighash types to Leather")),r};try{Te("   Attempt 1: Sending HEX format");const t=yield c.request("signPsbt",h(e));return Te("‚úÖ HEX format worked"),(null==(n=null==t?void 0:t.result)?void 0:n.hex)||(null==t?void 0:t.hex)||(null==t?void 0:t.psbt)||t}catch(s){Pe("‚ùå HEX format failed")}try{Te("   Attempt 2: Sending BASE64 in hex parameter");const t=R(e,"Leather","input"),n=yield c.request("signPsbt",h(t));Te("‚úÖ BASE64 in hex parameter worked");const i=(null==(r=null==n?void 0:n.result)?void 0:r.hex)||(null==n?void 0:n.hex)||(null==n?void 0:n.psbt)||n;try{return R(i,"Leather","output")}catch(o){return i}}catch(a){Pe("‚ùå BASE64 format failed")}try{Te("   Attempt 3: Sending BASE64 in psbt parameter");const t=R(e,"Leather","input"),n=yield c.request("signPsbt",h(t,!0));Te("‚úÖ psbt parameter worked");const r=(null==(i=null==n?void 0:n.result)?void 0:i.hex)||(null==n?void 0:n.hex)||(null==n?void 0:n.psbt)||n;try{return R(r,"Leather","output")}catch(o){return r}}catch(l){throw Pe("‚ùå psbt parameter failed"),new Error("All PSBT format attempts failed.")}}catch(c){Pe("‚ùå Leather PSBT signing failed"),Pe("   Error message:",null==c?void 0:c.message);const e=(null==c?void 0:c.message)||(null==c?void 0:c.toString())||"Unknown Leather signing error";if(e.includes("User rejected")||e.includes("cancelled"))throw new Error("User rejected the signing request");throw new Error(`Leather signing failed: ${e}`)}})}authenticate(){return f(this,arguments,function*(e={}){this.requireInstalled();try{const t=this.getProvider();Te("üîè Leather: Requesting authentication...");const n=yield t.authenticationRequest(e);return Te("‚úÖ Leather authentication complete"),n}catch(t){throw Pe("‚ùå Authentication failed"),t}})}sendStacksTransaction(e){return f(this,null,function*(){this.requireConnected();try{const t=this.getProvider();Te("üîè Leather: Sending Stacks transaction...");const n=yield t.transactionRequest(e);return Te("‚úÖ Stacks transaction sent"),n}catch(t){throw Pe("‚ùå Stacks transaction failed"),t}})}updateProfile(e){return f(this,null,function*(){this.requireConnected();try{const t=this.getProvider();Te("üîè Leather: Updating profile...");const n=yield t.profileUpdateRequest(e);return Te("‚úÖ Profile updated"),n}catch(t){throw Pe("‚ùå Profile update failed"),t}})}disconnect(){return f(this,null,function*(){yield h(Ae.prototype,this,"disconnect").call(this)})}destroy(){}}const Be=()=>"undefined"!=typeof window&&!0===window.NEXUS_WALLET_DEBUG,Ne=(...e)=>{Be()&&console.log(...e)},xe=(...e)=>{Be()&&console.warn(...e)};class _e extends te{constructor(){var e,t;super("Phantom"),this.publicKey=null,this.paymentAddress=null,this.paymentPublicKey=null,this._walletInstance=null,this._phantomHandlers=null,this._listenersAttached=!1,this.walletInstance="undefined"!=typeof window?null==(e=window.phantom)?void 0:e.bitcoin:null,this.identity="undefined"!=typeof window&&(null==(t=window.phantom)?void 0:t.bitcoin)?"phantom:window.phantom.bitcoin":null,this.features={connect:!0,getAddress:!0,getPublicKey:!0,getBalance:!0,getNetwork:!0,signMessage:!0,signPsbt:!0,sendBitcoin:!0,eventListeners:!0},this.refreshCapabilities()}set walletInstance(e){this._walletInstance=e}get walletInstance(){var e;const t="undefined"!=typeof window?null==(e=window.phantom)?void 0:e.bitcoin:null;return t&&(this.identity="phantom:window.phantom.bitcoin"),t||this._walletInstance||null}refreshCapabilities(){const e=this.walletInstance;this.features.signPsbt=!!(null==e?void 0:e.signPSBT)||!!(null==e?void 0:e.signPsbt)||!!(null==e?void 0:e.request)}_looksLikeHex(e){return"string"==typeof e&&e.length>0&&e.length%2==0&&/^[0-9a-fA-F]+$/.test(e)}_normalizeBase64(e){if("string"!=typeof e||0===e.length)return"";let t=e.trim();t=t.replace(/\s+/g,""),t=t.replace(/-/g,"+").replace(/_/g,"/");const n=t.length%4;return n&&(t+="=".repeat(4-n)),t}_hexToBytes(e){if(!this._looksLikeHex(e))throw new Error("Invalid hex");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.slice(n,n+2),16);return t}_bytesToBase64(e){let t="";for(let n=0;n<e.length;n+=32768){const r=e.subarray(n,n+32768);t+=String.fromCharCode.apply(null,Array.from(r))}return btoa(t)}_base64ToBytes(e){const t=this._normalizeBase64(e),n=atob(t),r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}isInstalled(){return this.refreshCapabilities(),!!this.walletInstance}connect(){return f(this,null,function*(){this.requireInstalled();try{const e=yield this.walletInstance.requestAccounts();if(!e||!Array.isArray(e)||0===e.length)throw new Error("No accounts returned from Phantom wallet");Ne("üîç Phantom accounts received"),Ne("üîç Number of accounts:",e.length);const t=e.find(e=>"ordinals"===e.purpose),n=e.find(e=>"payment"===e.purpose);if(t&&n)Ne("‚úÖ Phantom dual address mode detected"),this.address=t.address,this.publicKey=t.publicKey,this.paymentAddress=n.address,this.paymentPublicKey=n.publicKey;else{Ne("‚úÖ Phantom single address mode detected (imported wallet or legacy)");const t=e[0];this.address=t.address,this.publicKey=t.publicKey,this.paymentAddress=t.address,this.paymentPublicKey=t.publicKey,xe("‚ö†Ô∏è Using same address for ordinals and payment"),xe("‚ö†Ô∏è For better security, consider creating a native Phantom wallet")}return this.isConnected=!0,this.refreshCapabilities(),this.setupEventListeners(),Ne("‚úÖ Phantom connected"),{address:this.address,ordinalsAddress:this.address===this.paymentAddress?null:this.address,paymentAddress:this.paymentAddress,publicKey:this.publicKey,paymentPublicKey:this.paymentPublicKey}}catch(e){throw xe("‚ùå Phantom connection failed"),e}})}getAddress(){return f(this,null,function*(){this.requireConnected();try{return(yield this.walletInstance.getAccounts())[0].address}catch(e){return xe("‚ùå Failed to get address"),this.address}})}getPublicKey(){return f(this,null,function*(){return this.requireConnected(),this.publicKey})}getAccounts(){return f(this,null,function*(){this.requireConnected();try{return[this.address]}catch(e){throw xe("‚ùå Failed to get accounts"),e}})}signMessage(e){return f(this,null,function*(){this.requireConnected();try{const t=yield this.walletInstance.signMessage(e);return"string"==typeof t?t:t.signature}catch(t){throw xe("‚ùå Failed to sign message"),t}})}signPsbt(e){return f(this,arguments,function*(e,t={}){this.requireConnected(),se(e,"psbt");try{if("string"==typeof e){const t=e.trim(),n=this._looksLikeHex(t)&&t.toLowerCase().startsWith("70736274ff"),r=t.startsWith("cHNidP")||t.startsWith("cHNidP8");if(n&&t.length<40||r&&t.length<30)throw new Error("Invalid PSBT: please provide a real PSBT (not just the PSBT header).")}}catch(n){throw n}try{Ne("üîç Phantom signPsbt called");let u=null,h=null,g=e;try{if("string"==typeof e&&e.toLowerCase().startsWith("70736274")&&this._looksLikeHex(e)){const t=this._hexToBytes(e);u=t,h=this._bytesToBase64(t),Ne("üß™ Phantom PSBT prepared from HEX")}else"string"==typeof e&&e.trim().startsWith("cHNidP")?(u=this._base64ToBytes(e),h=e,Ne("üß™ Phantom PSBT prepared from BASE64")):e instanceof Uint8Array&&(u=e,h=this._bytesToBase64(e),Ne("üß™ Phantom PSBT provided as Uint8Array"))}catch(r){xe("‚ö†Ô∏è PSBT conversion warning:",null==r?void 0:r.message)}const m=_(p(d({},t),{address:this.address}),"Phantom");let y;Ne("üîç Phantom normalized options prepared");const w=(e=null)=>f(this,null,function*(){Ne("üîè Using signPSBT (uppercase)"+(e?" with options...":"..."));const t=u||h||g;return e?yield this.walletInstance.signPSBT(t,e):yield this.walletInstance.signPSBT(t)}),b=(e=null)=>f(this,null,function*(){Ne("üîè Using signPsbt (lowercase)"+(e?" with options...":"..."));const t=u||h||g;return e?yield this.walletInstance.signPsbt(t,e):yield this.walletInstance.signPsbt(t)}),v=()=>f(this,null,function*(){if("function"!=typeof this.walletInstance.request)throw xe("‚ö†Ô∏è request() not available on Phantom provider"),new Error("Phantom Bitcoin API does not support request() method. Please ensure Phantom wallet is updated.");Ne('üîè Using request("signPSBT") EIP-1193 style...');try{return yield this.walletInstance.request({method:"signPSBT",params:{psbt:u||h||g,options:m}})}catch(e){return xe("‚ö†Ô∏è request({params: object}) failed, trying array params"),yield this.walletInstance.request({method:"signPSBT",params:[u||h||g,m]})}});if("function"==typeof this.walletInstance.signPSBT)try{y=yield w(null)}catch(i){xe("‚ö†Ô∏è signPSBT (no options) threw:",null==i?void 0:i.message);try{xe("‚ö†Ô∏è Retrying signPSBT with normalized options..."),y=yield w(m)}catch(s){xe("‚ö†Ô∏è signPSBT with options failed, trying with empty object");try{y=yield w({})}catch(o){if(xe("‚ö†Ô∏è All signPSBT attempts failed, trying lowercase method"),"function"==typeof this.walletInstance.signPsbt)try{y=yield b(null)}catch(a){try{y=yield b(m)}catch(l){xe("‚ö†Ô∏è No lowercase signPsbt available, trying request API...");try{y=yield v()}catch(c){xe("‚ùå All Phantom signing methods exhausted");const e=String((null==i?void 0:i.message)||i||"Unknown error");if(/\bfinalize\b/i.test(e))throw new Error("Phantom signing failed during PSBT finalize. This usually means the PSBT is incomplete/invalid for signing. Ensure each input has witnessUtxo/nonWitnessUtxo and the PSBT is a full, valid transaction (not a dummy header).");throw new Error(`Phantom signing failed: ${e}. Tried signPSBT and signPsbt methods.`)}}}else{xe("‚ö†Ô∏è No lowercase signPsbt available, trying request API...");try{y=yield v()}catch(a){xe("‚ùå All Phantom signing methods exhausted");const e=String((null==i?void 0:i.message)||i||"Unknown error");if(/\bfinalize\b/i.test(e))throw new Error("Phantom signing failed during PSBT finalize. This usually means the PSBT is incomplete/invalid for signing. Ensure each input has witnessUtxo/nonWitnessUtxo and the PSBT is a full, valid transaction (not a dummy header).");throw new Error(`Phantom signing failed: ${e}. Tried signPSBT, signPsbt, and request() methods.`)}}}}}else if("function"==typeof this.walletInstance.signPsbt)try{y=yield b(null)}catch(i){try{y=yield b(m)}catch(s){const e=String((null==s?void 0:s.message)||s||"Unknown error");if(/\bfinalize\b/i.test(e))throw new Error("Phantom signPsbt failed during PSBT finalize. This usually means the PSBT is incomplete/invalid for signing. Ensure each input has witnessUtxo/nonWitnessUtxo and the PSBT is a full, valid transaction (not a dummy header).");throw new Error(`Phantom signPsbt failed: ${e}`)}}else try{y=yield v()}catch(n){throw new Error("Phantom wallet does not have signPSBT, signPsbt, or request() methods available. Please update your Phantom wallet.")}let E;if(Ne("‚úÖ Phantom signed PSBT"),y instanceof Uint8Array)Ne("üîÑ Converting Uint8Array to HEX..."),E=Array.from(y,e=>e.toString(16).padStart(2,"0")).join(""),Ne("‚úÖ Converted to hex");else if("string"==typeof y)if(y.startsWith("cHNidP")){Ne("üîÑ Converting BASE64 to HEX...");const e=this._base64ToBytes(y);E=Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}else E=y;else if(null==y?void 0:y.signedPsbtHex)E=y.signedPsbtHex;else if(null==y?void 0:y.signedPsbt)E=y.signedPsbt;else{if(!(null==y?void 0:y.psbt))throw xe("‚ùå Unknown signed PSBT format"),new Error("Phantom returned unexpected PSBT format");E=y.psbt}return Ne("‚úÖ Final PSBT hex prepared"),E}catch(u){throw xe("‚ùå Failed to sign PSBT:",null==u?void 0:u.message),u}})}getBalance(){return f(this,null,function*(){this.requireConnected();try{return xe("‚ö†Ô∏è Phantom Bitcoin API has limited balance support"),{confirmedSats:0,unconfirmedSats:0,totalSats:0}}catch(e){throw xe("‚ùå Failed to get balance"),e}})}getNetwork(){return f(this,null,function*(){this.requireInstalled();try{return C(yield this.walletInstance.getNetwork())}catch(e){return xe("‚ùå Failed to get network"),"livenet"}})}sendBitcoin(e,t){return f(this,arguments,function*(e,t,n={}){this.requireConnected(),ae(e,"recipientAddress"),oe(t,"amount");try{const r=yield this.walletInstance.sendTransfer(d({recipientAddress:e,amount:t},n));return Ne("‚úÖ Phantom transaction sent"),r}catch(r){throw xe("‚ùå Failed to send Bitcoin"),r}})}setupEventListeners(){if(!this.isInstalled())return;if(this._listenersAttached)return;const e=this.walletInstance;(null==e?void 0:e.on)&&(this._phantomHandlers={accountsChanged:e=>{Ne("üë§ Phantom accounts changed"),e&&e.length>0?(this.address=e[0].address,this.publicKey=e[0].publicKey):(this.address=null,this.publicKey=null,this.isConnected=!1)}},e.on("accountsChanged",this._phantomHandlers.accountsChanged),this._listenersAttached=!0,Ne("‚úÖ Phantom event listeners set up"))}removeEventListeners(){var e,t;if(!this.isInstalled())return;const n=this.walletInstance;if(!n||!this._phantomHandlers)return;const r=(null==(e=n.off)?void 0:e.bind(n))||(null==(t=n.removeListener)?void 0:t.bind(n));r&&r("accountsChanged",this._phantomHandlers.accountsChanged),this._listenersAttached=!1,this._phantomHandlers=null,Ne("‚úÖ Phantom event listeners removed")}disconnect(){return f(this,null,function*(){this.removeEventListeners(),yield h(_e.prototype,this,"disconnect").call(this)})}destroy(){this.removeEventListeners()}}const Ce=()=>"undefined"!=typeof window&&!0===window.NEXUS_WALLET_DEBUG,ke=(...e)=>{Ce()&&console.log(...e)},Oe=(...e)=>{Ce()&&console.warn(...e)};class Ue extends te{constructor(){super("Wizz"),this._walletInstance=null,this._wizzHandlers=null,this._listenersAttached=!1,this.walletInstance="undefined"!=typeof window?window.wizz:null,this.features={connect:!0,getAddress:!0,getPublicKey:!0,getBalance:!0,getNetwork:!0,switchNetwork:!0,signMessage:!0,signPsbt:!0,signPsbts:!1,pushPsbt:!0,pushTx:!0,sendBitcoin:!0,sendInscription:!1,getInscriptions:!0,getAllInscriptions:!0,inscribe:!0,brc20:{transfer:!0,deploy:!0,mint:!0},runes:{send:!0,mint:!1,etch:!1},atomicals:{transfer:!0,mint:!0},arc20:{transfer:!0},biHelix:!0,cpfp:!0,mempoolInjection:!0,bip322:!0},this.refreshCapabilities()}set walletInstance(e){this._walletInstance=e}get walletInstance(){return("undefined"!=typeof window?window.wizz:null)||this._walletInstance||null}refreshCapabilities(){const e=this.walletInstance;this.features.signPsbts=!!(null==e?void 0:e.signPsbts)}isInstalled(){return this.refreshCapabilities(),!!this.walletInstance}connect(){return f(this,null,function*(){var e;this.requireInstalled();try{ke("üîç Connecting to Wizz wallet...");const e=this.walletInstance;let n=null;if("function"==typeof e.connect)ke("üîç Using connect() method..."),n=yield e.connect();else if("function"==typeof e.requestAccounts)ke("üîç Using requestAccounts() method..."),n=yield e.requestAccounts();else{if("function"!=typeof e.getAccounts)throw new Error("Wizz wallet has no connection methods available");ke("üîç Using getAccounts() method..."),n=yield e.getAccounts()}if(ke("üîç Wizz connect returned"),!n)throw new Error("No response from Wizz wallet");if("object"==typeof n&&n.address)this.address=n.address,this.publicKey=n.publicKey;else if(Array.isArray(n)&&n.length>0)this.address=n[0];else{if("string"!=typeof n)throw new Error("Unexpected response format from Wizz wallet");this.address=n}if(!this.address)throw new Error("Could not extract address from Wizz response");if(!this.publicKey&&"function"==typeof e.getPublicKey)try{this.publicKey=yield e.getPublicKey(),ke("   üìù Retrieved Public Key")}catch(t){Oe("‚ö†Ô∏è Could not get public key")}return this.isConnected=!0,ke("‚úÖ Wizz connected"),{address:this.address,publicKey:this.publicKey}}catch(n){if(Oe("‚ùå Wizz connection failed"),-32603===n.code)throw new Error("Wizz wallet error: Please unlock your wallet and refresh the page");if(null==(e=n.message)?void 0:e.includes("User rejected"))throw new Error("Connection request was rejected");throw n}})}getAddress(){return f(this,null,function*(){return this.requireConnected(),(yield this.walletInstance.getAccounts())[0]})}getPublicKey(){return f(this,null,function*(){return this.requireConnected(),yield this.walletInstance.getPublicKey()})}getAccounts(){return f(this,null,function*(){return this.requireInstalled(),yield this.walletInstance.getAccounts()})}getBalance(){return f(this,null,function*(){this.requireConnected();const e=yield this.walletInstance.getBalance();return L.balance(e,"Wizz")})}getNetwork(){return f(this,null,function*(){this.requireInstalled();try{const e=yield this.walletInstance.getNetwork();return L.network(e)}catch(e){return Oe("‚ùå Failed to get network"),"livenet"}})}switchNetwork(e){return f(this,null,function*(){this.requireInstalled(),yield this.walletInstance.switchNetwork(e),ke("‚úÖ Wizz network switched")})}getChain(){return f(this,null,function*(){return this.requireInstalled(),yield this.walletInstance.getChain()})}switchChain(e){return f(this,null,function*(){this.requireInstalled(),yield this.walletInstance.switchChain(e),ke("‚úÖ Wizz chain switched")})}signMessage(e,t="ecdsa"){return f(this,null,function*(){return this.requireConnected(),yield this.walletInstance.signMessage(e,t)})}verifyMessage(e,t,n){return f(this,null,function*(){return this.requireInstalled(),yield this.walletInstance.verifyMessage(e,t,n)})}verifyMessageOfBIP322Simple(e,t,n){return f(this,null,function*(){return this.requireInstalled(),yield this.walletInstance.verifyMessageOfBIP322Simple(e,t,n)})}signPsbt(e){return f(this,arguments,function*(e,t={}){return this.requireConnected(),se(e,"psbt"),yield this.walletInstance.signPsbt(e,t)})}pushPsbt(e){return f(this,null,function*(){this.requireConnected();const t=yield this.walletInstance.pushPsbt(e);return ke("‚úÖ Wizz PSBT broadcasted"),t})}pushTx(e){return f(this,null,function*(){this.requireConnected(),ie(e,"txHex");const t=yield this.walletInstance.pushTx({rawtx:e});return ke("‚úÖ Wizz raw TX broadcasted"),t})}sendBitcoin(e,t){return f(this,arguments,function*(e,t,n={}){this.requireConnected(),ae(e,"toAddress"),oe(t,"amount");const r=yield this.walletInstance.sendBitcoin(e,t,n);return ke("‚úÖ Wizz transaction sent"),r})}getBitcoinUtxos(){return f(this,null,function*(){return this.requireConnected(),yield this.walletInstance.getBitcoinUtxos()})}injectMempool(e){return f(this,null,function*(){return this.requireConnected(),yield this.walletInstance.injectMempool(e)})}requestCPFP(e){return f(this,null,function*(){this.requireConnected();const t=yield this.walletInstance.requestCPFP(e);return ke("‚úÖ Wizz CPFP transaction created"),t})}getInscriptions(e=0,t=100){return f(this,null,function*(){this.requireConnected();try{const n=this.walletInstance;let r=[];if("function"==typeof n.getInscriptions){ke("üì¶ Using getInscriptions method...");const i=yield n.getInscriptions(e,t);Array.isArray(i)?r=i:i&&i.list?r=i.list:i&&i.inscriptions?r=i.inscriptions:i&&i.result&&(r=i.result.inscriptions||i.result.list||[])}else{if("function"!=typeof n.getOrdinals)return Oe("‚ö†Ô∏è Wizz does not support inscription fetching"),{list:[],total:0};{ke("üì¶ Using getOrdinals method...");const i=yield n.getOrdinals(e,t);r=Array.isArray(i)?i:i.list||i.inscriptions||[]}}return ke(`üì¶ Wizz returned ${r.length} inscriptions`),{list:r.map(e=>L.inscription(e,"Wizz")),total:r.length}}catch(n){return Oe("‚ùå Failed to fetch Wizz inscriptions"),{list:[],total:0}}})}getInscriptionsByAddress(e,t=0,n=100){return f(this,null,function*(){return this.requireInstalled(),yield this.walletInstance.getInscriptionsByAddress(e,t,n)})}getAssets(){return f(this,null,function*(){return this.requireConnected(),yield this.walletInstance.getAssets()})}inscribe(e){return f(this,arguments,function*(e,t={}){var n;this.requireConnected();try{const{contentType:r="text/plain;charset=utf-8",encoding:i="utf8",feeRate:s,receiveAddress:o,serviceFee:a=0,metadata:l}=t,c={type:61,from:this.address,inscriptions:[{contentType:r,body:e}]};if(s&&(c.feeRate=s),r.includes("brc-20")||l&&l.brc20){c.type=51;const t=l.brc20||JSON.parse(e);c.tick=t.tick}r.startsWith("image/")&&(c.type=62);const u=yield this.walletInstance.inscribe(c);return ke("‚úÖ Wizz inscription created"),{inscriptionId:u.inscriptionId||(null==(n=u.revealTxs)?void 0:n[0]),txId:u.commitTx||u.txId,revealTxIds:u.revealTxs,commitTxFee:u.commitTxFee,revealTxFees:u.revealTxFees}}catch(r){throw Oe("‚ùå Wizz inscribe error"),new Error(`Inscription failed: ${r.message}`)}})}requestMint(e){return f(this,null,function*(){return this.requireConnected(),yield this.walletInstance.requestMint(e)})}sendARC20(e,t,n){return f(this,null,function*(){this.requireConnected();const r=yield this.walletInstance.sendARC20(e,t,n);return ke("‚úÖ Wizz ARC-20 sent"),r})}sendAtomicals(e){return f(this,null,function*(){this.requireConnected();const t=yield this.walletInstance.sendAtomicals(e);return ke("‚úÖ Wizz Atomicals sent"),t})}isAtomicalsEnabled(){return f(this,null,function*(){return this.requireInstalled(),yield this.walletInstance.isAtomicalsEnabled()})}isBiHelixAddress(e){return f(this,null,function*(){return this.requireInstalled(),yield this.walletInstance.isBiHelixAddress(e)})}getBiHelixDescriptor(){return f(this,null,function*(){return this.requireConnected(),yield this.walletInstance.getBiHelixDescriptor()})}viewAddress(e){return f(this,null,function*(){this.requireInstalled(),yield this.walletInstance.viewAddress(e)})}getVersion(){return f(this,null,function*(){return this.requireInstalled(),yield this.walletInstance.getVersion()})}setupEventListeners(){if(!this.isInstalled())return;const e=this.walletInstance;e&&e.on&&(this._listenersAttached||(this._wizzHandlers={accountsChanged:e=>{ke("üë§ Wizz accounts changed"),e&&0!==e.length?this.address=e[0]:(this.address=null,this.publicKey=null,this.isConnected=!1)},networkChanged:e=>{ke("üåê Wizz network changed")}},e.on("accountsChanged",this._wizzHandlers.accountsChanged),e.on("networkChanged",this._wizzHandlers.networkChanged),this._listenersAttached=!0,ke("‚úÖ Wizz event listeners set up")))}removeEventListeners(){var e,t;if(!this.isInstalled())return;const n=this.walletInstance;if(!n||!this._wizzHandlers)return;const r=(null==(e=n.off)?void 0:e.bind(n))||(null==(t=n.removeListener)?void 0:t.bind(n));r&&(r("accountsChanged",this._wizzHandlers.accountsChanged),r("networkChanged",this._wizzHandlers.networkChanged)),this._listenersAttached=!1,this._wizzHandlers=null}disconnect(){return f(this,null,function*(){this.removeEventListeners(),yield h(Ue.prototype,this,"disconnect").call(this)})}destroy(){this.removeEventListeners()}}const Re=()=>"undefined"!=typeof window&&!0===window.NEXUS_WALLET_DEBUG,Le=(...e)=>{Re()&&console.log(...e)},He=(...e)=>{Re()&&console.warn(...e)};class Me extends te{constructor(){super("MagicEden"),this.paymentAddress=null,this.ordinalsAddress=null,this._walletInstance=null,this._magicEdenHandlers=null,this._listenersAttached=!1,this._magicEdenProviderHint=null,this.walletInstance=this.getProvider(),this.features={connect:!0,getAddress:!0,getPublicKey:!1,getBalance:!1,getNetwork:!0,switchNetwork:!1,signMessage:!0,signPsbt:!0,signPsbts:!0,signTransaction:!0,pushPsbt:!1,pushTx:!1,sendBitcoin:!0,sendInscription:!1,getInscriptions:!1,getAllInscriptions:!1,inscribe:!1,brc20:{transfer:!1,deploy:!1,mint:!1},runes:{send:!1,mint:!1,etch:!1},atomicals:{transfer:!1,mint:!1},arc20:{transfer:!1},jwtAuth:!0,hardwareDetection:!0},this.refreshCapabilities()}set walletInstance(e){this._walletInstance=e}get walletInstance(){return this.getProvider()||this._walletInstance||null}refreshCapabilities(){const e=this.walletInstance;this.features.signPsbts=!1,this.features.signTransaction=!!(null==e?void 0:e.signTransaction),this.features.sendBitcoin=!!(null==e?void 0:e.sendBtcTransaction)}getProvider(){var e,t,n;if("undefined"==typeof window)return null;this._magicEdenProviderHint=null;const r=null==(e=window.magicEden)?void 0:e.bitcoin;if(r&&(r.isMagicEden||"function"==typeof r.connect||"function"==typeof r.request))return this._magicEdenProviderHint="namespace",r;if((null==(t=window.BitcoinProvider)?void 0:t.isMagicEden)&&"function"==typeof window.BitcoinProvider.connect)return this._magicEdenProviderHint="bitcoinprovider",window.BitcoinProvider;if(Array.isArray(window.btc_providers))for(const i of window.btc_providers){const e=String((null==i?void 0:i.name)||(null==i?void 0:i.id)||"").toLowerCase(),t=e.includes("magic")||e.includes("eden"),r="function"==typeof(null==i?void 0:i.connect)&&i||"function"==typeof(null==(n=null==i?void 0:i.provider)?void 0:n.connect)&&i.provider||null;if(r&&((null==r?void 0:r.isMagicEden)||t))return this._magicEdenProviderHint="btc_providers",r}return null}_isMagicEdenProvider(e){return!(!e||!e.isMagicEden&&null===this._magicEdenProviderHint)}isInstalled(){return this.refreshCapabilities(),!!this.walletInstance}connect(){return f(this,null,function*(){var e;this.requireInstalled();const t=this.walletInstance,n=!!(null==(e=window.XverseProviders)?void 0:e.BitcoinProvider)||Array.isArray(window.btc_providers)&&window.btc_providers.some(e=>String((null==e?void 0:e.name)||(null==e?void 0:e.id)||"").toLowerCase().includes("xverse")),r=void 0!==window.LeatherProvider||Array.isArray(window.btc_providers)&&window.btc_providers.some(e=>String((null==e?void 0:e.name)||(null==e?void 0:e.id)||"").toLowerCase().includes("leather"));if((n||r)&&!this._isMagicEdenProvider(t))throw new Error(`üö® WALLET CONFLICT DETECTED\n\nMagic Eden cannot coexist with other Bitcoin wallets.\nDetected: ${n?"Xverse ":""}${r?"Leather":""}\n\nSOLUTIONS:\n1. Disable Xverse and Leather extensions\n2. Refresh the page\n3. Try again\n\nOR use Xverse wallet instead (recommended for multi-wallet support)`);if(!t||!this._isMagicEdenProvider(t))throw new Error("‚ö†Ô∏è Magic Eden wallet is installed but cannot be accessed.\n\nThis happens when multiple Bitcoin wallets are installed.\n\nSOLUTION:\n1. Disable Xverse and Leather extensions\n2. Refresh the page\n3. Try again\n\nOR use Xverse wallet instead (recommended)");try{const e={purposes:["payment","ordinals"],message:"Connect to view your Bitcoin addresses",network:{type:"Mainnet"}},n=$(e);let r;try{r=yield t.connect(n)}catch(i){const n=String((null==i?void 0:i.message)||i||"").toLowerCase();if(!(n.includes("token")||n.includes("jwt")||n.includes("envelope")||n.includes("nonce")||n.includes("number")||n.includes("invalid")))throw i;r=yield t.connect(e)}if(!(null==r?void 0:r.addresses)||!Array.isArray(r.addresses))throw new Error("No addresses returned from Magic Eden wallet");const s=r.addresses.find(e=>"payment"===e.purpose),o=r.addresses.find(e=>"ordinals"===e.purpose);if(!s&&!o)throw new Error("No valid addresses returned");return this.paymentAddress=null==s?void 0:s.address,this.ordinalsAddress=null==o?void 0:o.address,this.address=(null==o?void 0:o.address)||(null==s?void 0:s.address),this.publicKey=(null==s?void 0:s.publicKey)||(null==o?void 0:o.publicKey),this.isConnected=!0,this.refreshCapabilities(),Le("‚úÖ Magic Eden connected"),{address:this.address,paymentAddress:this.paymentAddress,ordinalsAddress:this.ordinalsAddress,publicKey:this.publicKey}}catch(s){throw He("‚ùå Magic Eden connection failed"),s}})}getAddress(){return f(this,null,function*(){return this.requireConnected(),this.address})}getAccounts(){return f(this,null,function*(){return this.requireConnected(),[{address:this.paymentAddress,publicKey:this.publicKey,purpose:"payment"},{address:this.ordinalsAddress,publicKey:this.publicKey,purpose:"ordinals"}].filter(e=>e.address)})}getState(){const e=this.paymentAddress||this.address||null,t=this.ordinalsAddress||this.address||null;return{wallet:"MagicEden",connected:!!this.isConnected,network:"mainnet",paymentAddress:e,ordinalsAddress:t,paymentPublicKey:this.publicKey||null,ordinalsPublicKey:this.publicKey||null,address:this.address||t||e||null}}getBalance(){return f(this,null,function*(){return this.requireConnected(),Le("‚ÑπÔ∏è Magic Eden does not support getBalance - use their web interface"),{confirmedSats:0,unconfirmedSats:0,totalSats:0}})}getNetwork(){return f(this,null,function*(){return"mainnet"})}signMessage(e){return f(this,null,function*(){this.requireConnected();try{const t=$({address:this.address,message:e,protocol:"BIP322"}),n=yield this.walletInstance.signMessage(t);return Le("‚úÖ Magic Eden message signed"),n}catch(t){throw He("‚ùå Magic Eden sign message failed"),new Error(`Message signing failed: ${t.message}`)}})}signPsbt(e){return f(this,arguments,function*(e,t={}){var n;this.requireConnected(),re(e,"psbt");try{const n=e=>"string"==typeof e&&/^[0-9a-fA-F]+$/.test(e)&&e.length%2==0,r=e=>{if("string"!=typeof e||0===e.length)return"";let t=e.trim();t=t.replace(/\s+/g,""),t=t.replace(/-/g,"+").replace(/_/g,"/");const n=t.length%4;return n&&(t+="=".repeat(4-n)),t},i=e=>{const t=e.length,n=new Uint8Array(t/2);for(let r=0;r<t;r+=2)n[r/2]=parseInt(e.slice(r,r+2),16);return n},s=e=>{let t="";for(let n=0;n<e.length;n++)t+=e[n].toString(16).padStart(2,"0");return t},o=e=>{let t="";for(let n=0;n<e.length;n+=32768){const r=e.subarray(n,n+32768);t+=String.fromCharCode.apply(null,Array.from(r))}return btoa(t)},a=e=>{const t=atob(r(e)),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},l=e=>o(i(e)),c=e=>s(a(e));let u=e;n(e)&&(Le("üîß Magic Eden: Converting PSBT from hex to base64..."),u=l(e));const d=(()=>{const e=Array.isArray(null==t?void 0:t.toSignInputs)?t.toSignInputs:[],n=new Map;for(const t of e){if(!t||"object"!=typeof t)continue;const e=t.address||this.ordinalsAddress||this.paymentAddress||this.address,r=Number(t.index);!e||!Number.isFinite(r)||r<0||(n.has(e)||n.set(e,[]),n.get(e).push(r))}if(0===n.size){const e=this.ordinalsAddress||this.address;e&&n.set(e,[0])}return Array.from(n.entries()).map(([e,t])=>({address:e,signingIndexes:Array.from(new Set(t)).sort((e,t)=>e-t)}))})();Le("üîè Magic Eden: Signing PSBT..."),Le("  inputsToSign groups:",d.length);const p=$({network:{type:"Mainnet"},message:"Sign inscription transaction",psbtBase64:u,broadcast:!1,inputsToSign:d}),h=yield this.walletInstance.signTransaction(p);if(Le("‚úÖ Magic Eden PSBT signed"),null==h?void 0:h.psbtBase64)return n(e)?c(h.psbtBase64):h.psbtBase64;throw new Error("No signed PSBT returned from Magic Eden")}catch(r){if(He("‚ùå Magic Eden sign PSBT failed"),null==(n=r.message)?void 0:n.includes("Magic Number"))throw new Error("PSBT format error: Magic Eden expects base64 format. This error has been fixed - please try again.");throw new Error(`PSBT signing failed: ${r.message}`)}})}signPsbts(e){return f(this,arguments,function*(e,t=[]){this.requireConnected(),le(e,"psbts");try{Le(`üîè Magic Eden: Signing ${e.length} PSBTs...`);const n=[];for(let r=0;r<e.length;r++){const i=e[r],s=Array.isArray(t)?t[r]||{}:t;Le(`  Signing PSBT ${r+1}/${e.length}...`);const o=yield this.signPsbt(i,s);n.push(o)}return Le(`‚úÖ Magic Eden: All ${n.length} PSBTs signed`),n}catch(n){throw He("‚ùå Magic Eden sign PSBTs failed"),new Error(`Batch PSBT signing failed: ${n.message}`)}})}signTransaction(e){return f(this,null,function*(){this.requireConnected();const t=yield this.walletInstance.signTransaction(e);return Le("‚úÖ Transaction signed via Magic Eden"),t})}signMultipleTransactions(e){return f(this,null,function*(){this.requireConnected();const t=yield this.walletInstance.signMultipleTransactions(e);return Le(`‚úÖ ${t.length} transactions signed via Magic Eden`),t})}sendBitcoin(e,t){return f(this,null,function*(){this.requireConnected(),ae(e,"toAddress"),oe(t,"amount");try{const n=t>1e5?t:Math.floor(1e8*t);if(n<=0)throw new Error("Amount must be greater than 0");const r=this.paymentAddress;if(!r)throw new Error("Payment address not available. Please reconnect wallet.");const i=$({recipients:[{address:e,amountSats:n}],senderAddress:r}),s=yield this.walletInstance.sendBtcTransaction(i);return Le("‚úÖ Magic Eden BTC sent"),s}catch(n){He("‚ùå Magic Eden send BTC failed");let e=n.message||"Unknown error";throw e.includes("validation")?e="Invalid address format. Please check the recipient address.":e.includes("rejected")?e="Transaction was rejected by user":e.includes("insufficient")&&(e="Insufficient balance to complete transaction"),new Error(`Send transaction failed: ${e}`)}})}getInscriptions(e=0,t=100){return f(this,null,function*(){return this.requireConnected(),{list:[],total:0}})}isHardware(){return f(this,null,function*(){if(!this.walletInstance)throw new Error("Provider not initialized");try{return yield this.walletInstance.isHardware()}catch(e){return He("‚ö†Ô∏è isHardware method not supported"),!1}})}call(e){return f(this,arguments,function*(e,t={}){if(!this.walletInstance||!this.walletInstance.call)throw new Error("Magic Eden RPC call method not available");try{Le(`üîç Magic Eden RPC call: ${e}`);const n=yield this.walletInstance.call(e,t);return Le("‚úÖ Magic Eden RPC call succeeded"),n}catch(n){throw He("‚ùå Magic Eden RPC call failed"),new Error(`RPC call failed: ${n.message}`)}})}setupEventListeners(){if(!this.isInstalled())return;const e=this.walletInstance;e&&e.on&&(this._listenersAttached||(this._magicEdenHandlers={accountsChanged:e=>{Le("üë§ Magic Eden accounts changed"),e&&0!==e.length?(this.paymentAddress=e[0],this.ordinalsAddress=e[0]):(this.paymentAddress=null,this.ordinalsAddress=null,this.isConnected=!1)}},e.on("accountsChanged",this._magicEdenHandlers.accountsChanged),this._listenersAttached=!0,Le("‚úÖ Magic Eden event listeners set up")))}removeEventListeners(){var e,t;if(!this.isInstalled())return;const n=this.walletInstance;if(!n||!this._magicEdenHandlers)return;const r=(null==(e=n.off)?void 0:e.bind(n))||(null==(t=n.removeListener)?void 0:t.bind(n));r&&r("accountsChanged",this._magicEdenHandlers.accountsChanged),this._listenersAttached=!1,this._magicEdenHandlers=null}disconnect(){return f(this,null,function*(){this.removeEventListeners(),yield h(Me.prototype,this,"disconnect").call(this)})}destroy(){this.removeEventListeners()}}const We=()=>"undefined"!=typeof window&&!0===window.NEXUS_WALLET_DEBUG,qe=(...e)=>{We()&&console.log(...e)},Fe=(...e)=>{We()&&console.warn(...e)},Ke={},$e=()=>"undefined"!=typeof window&&!0===window.NEXUS_WALLET_DEBUG,De=(...e)=>{$e()&&console.log(...e)},Xe=(...e)=>{$e()&&console.warn(...e)};function Ve(){return f(this,null,function*(){return{normalizeInscription:A,normalizeBalance:B,assertSatsBalance:N,normalizeSighashTypes:x,normalizers:L||L,normalizePsbtOptions:_,normalizeNetwork:C,normalizeAddress:k}})}function je(){return f(this,null,function*(){return ee})}const Ge={BitmapWallet:{name:"BitmapWallet",detection:()=>{if("undefined"==typeof window)return!1;const e=void 0!==window.bitmapWallet&&"function"==typeof window.bitmapWallet.request;return e&&console.log("‚úÖ BitmapWallet found at window.bitmapWallet"),e},downloadUrl:"https://bitmapwallet.io",features:["Inscriptions","Bitmaps","UTXOs","Signing","Broadcasting","Rare Sats"]},UniSat:{name:"UniSat",detection:()=>"undefined"!=typeof window&&void 0!==window.unisat,downloadUrl:"https://unisat.io"},Xverse:{name:"Xverse",detection:()=>{if("undefined"==typeof window)return!1;if(void 0!==window.XverseProviders)return!0;if(void 0!==window.BitcoinProvider)return!0;if(Array.isArray(window.btc_providers)){const e=e=>{var t;return!!String((null==e?void 0:e.name)||(null==e?void 0:e.id)||"").toLowerCase().includes("leather")||"LeatherProvider"===(null==e?void 0:e.id)||"Leather"===(null==e?void 0:e.name)||!!(null==(t=null==e?void 0:e.provider)?void 0:t.isLeather)};return!!window.btc_providers.some(e=>String((null==e?void 0:e.name)||(null==e?void 0:e.id)||"").toLowerCase().includes("xverse"))||window.btc_providers.some(t=>{var n,r,i,s;return!e(t)&&!!("function"==typeof(null==t?void 0:t.request)&&t||"function"==typeof(null==(n=null==t?void 0:t.provider)?void 0:n.request)&&t.provider||"function"==typeof(null==(s=null==(i=null==(r=null==t?void 0:t.features)?void 0:r["sats-connect:"])?void 0:i.provider)?void 0:s.request)&&t.features["sats-connect:"].provider)})}return!1},downloadUrl:"https://www.xverse.app"},OKX:{name:"OKX",detection:()=>{var e;return"undefined"!=typeof window&&void 0!==(null==(e=window.okxwallet)?void 0:e.bitcoin)},downloadUrl:"https://www.okx.com/web3"},Leather:{name:"Leather",detection:()=>{try{if("undefined"==typeof window)return!1;if(window.btc_providers&&Array.isArray(window.btc_providers)&&window.btc_providers.some(e=>"LeatherProvider"===e.id||"Leather"===e.name||e.provider&&e.provider.isLeather))return console.log("‚úÖ Leather found in btc_providers array"),!0;const e=!(!window.LeatherProvider&&!window.HiroWalletProvider);return e&&console.log("‚úÖ Leather found in window object"),e}catch(e){return console.warn("‚ö†Ô∏è Leather detection error:",e),!1}},downloadUrl:"https://leather.io"},Phantom:{name:"Phantom",detection:()=>{var e;return"undefined"!=typeof window&&void 0!==(null==(e=window.phantom)?void 0:e.bitcoin)},downloadUrl:"https://phantom.app"},Wizz:{name:"Wizz",detection:()=>"undefined"!=typeof window&&void 0!==window.wizz,downloadUrl:"https://wizzwallet.io"},MagicEden:{name:"MagicEden",detection:()=>{var e,t;if("undefined"==typeof window)return!1;const n=null==(e=window.magicEden)?void 0:e.bitcoin;return!(!n||!n.isMagicEden&&"function"!=typeof n.connect&&"function"!=typeof n.request)||!(!(null==(t=window.BitcoinProvider)?void 0:t.isMagicEden)||"function"!=typeof window.BitcoinProvider.connect)||!!Array.isArray(window.btc_providers)&&window.btc_providers.some(e=>{var t;const n=String((null==e?void 0:e.name)||(null==e?void 0:e.id)||"").toLowerCase(),r=n.includes("magic")||n.includes("eden"),i="function"==typeof(null==e?void 0:e.connect)&&e||"function"==typeof(null==(t=null==e?void 0:e.provider)?void 0:t.connect)&&e.provider||null;return!!i&&((null==i?void 0:i.isMagicEden)||r)})},downloadUrl:"https://wallet.magiceden.io"},Oyl:{name:"Oyl",detection:()=>"undefined"!=typeof window&&void 0!==window.oyl,downloadUrl:"https://oyl.io"}};function ze(e){if(!e)return e;const t=String(e);return Object.keys(Ye).find(e=>e.toLowerCase()===t.toLowerCase())||t}const Ye={BitmapWallet:class extends te{constructor(){var e;super("BitmapWallet"),this._events=new Map,this._walletInstance=null,this._bitmapHandlers=null,this._listenersAttached=!1,this.walletInstance="undefined"!=typeof window&&window.bitmapWallet?window.bitmapWallet:null,this.isConnected=!!(null==(e=this.walletInstance)?void 0:e.isConnected),this.address=this.isConnected&&this.walletInstance.getAddress?this.walletInstance.getAddress():null}set walletInstance(e){this._walletInstance=e}get walletInstance(){return("undefined"!=typeof window&&window.bitmapWallet?window.bitmapWallet:null)||this._walletInstance||null}isInstalled(){return"undefined"!=typeof window&&window.bitmapWallet&&"function"==typeof window.bitmapWallet.request}setupEventListeners(){this.walletInstance&&(this._listenersAttached||"function"==typeof this.walletInstance.on&&(this._bitmapHandlers={accountsChanged:e=>{e&&e.length>0&&(this.address=e[0],this._emit("accountsChanged",{accounts:e,address:this.address}))},networkChanged:e=>{this._emit("networkChanged",{network:e})},disconnect:()=>{this.isConnected=!1,this.address=null,this._emit("disconnect")}},this.walletInstance.on("accountsChanged",this._bitmapHandlers.accountsChanged),this.walletInstance.on("networkChanged",this._bitmapHandlers.networkChanged),this.walletInstance.on("disconnect",this._bitmapHandlers.disconnect),this._listenersAttached=!0))}removeEventListeners(){var e,t;const n=this.walletInstance;if(!n||!this._bitmapHandlers)return;const r=(null==(e=n.off)?void 0:e.bind(n))||(null==(t=n.removeListener)?void 0:t.bind(n));r&&(r("accountsChanged",this._bitmapHandlers.accountsChanged),r("networkChanged",this._bitmapHandlers.networkChanged),r("disconnect",this._bitmapHandlers.disconnect)),this._listenersAttached=!1,this._bitmapHandlers=null}request(e,t){return f(this,null,function*(){let n,r;switch("object"==typeof e&&null!==e?(n=e.method,r=e.params):(n=e,r=t),n){case"connect":return yield this.connect(null==r?void 0:r.options);case"disconnect":return yield this.disconnect();case"requestAccounts":case"getAccounts":return yield this.getAccounts();case"getAddress":return yield this.getAddress();case"getBalance":return yield this.getBalance(r);case"getInscriptions":return yield this.getInscriptions(r||{});case"signMessage":return yield this.signMessage(r);case"signPsbt":return yield this.signPsbt((null==r?void 0:r.psbt)||r);case"signPsbts":return yield this.signPsbts((null==r?void 0:r.psbts)||r);case"pushPsbt":return yield this.pushPsbt((null==r?void 0:r.psbt)||r);case"pushTx":return yield this.pushTx((null==r?void 0:r.hex)||r);case"getUtxos":return yield this.getUtxos((null==r?void 0:r.address)||r);case"getFeeRate":return yield this.getFeeRate();case"getNetwork":return yield this.getNetwork();case"switchNetwork":return yield this.switchNetwork((null==r?void 0:r.network)||r);case"getSpendableUtxos":return yield this.getSpendableUtxos((null==r?void 0:r.address)||r);case"getRunes":return yield this.getRunes((null==r?void 0:r.address)||r);case"getRareSats":return yield this.getRareSats((null==r?void 0:r.address)||r);case"sendBitcoin":return yield this.sendBitcoin(null==r?void 0:r.toAddress,null==r?void 0:r.satoshis,null==r?void 0:r.options);case"sendInscription":return yield this.sendInscription(null==r?void 0:r.address,null==r?void 0:r.inscriptionId,null==r?void 0:r.options);case"detectBitmaps":return yield this.detectBitmaps();default:if(this.walletInstance&&"function"==typeof this.walletInstance.request)return yield this.walletInstance.request({method:n,params:r});throw new Error(`Unsupported method: ${n}`)}})}connect(){return f(this,arguments,function*(e={}){var t;if(De("üîå BitmapWalletProvider.connect() called",{hasInstance:!!this.walletInstance}),!this.walletInstance)throw new Error("BitmapWallet not installed or not detected at window.bitmapWallet");if(this.setupEventListeners(),"function"==typeof this.walletInstance.connect){De("üîå Calling window.bitmapWallet.connect()...");const r=yield this.walletInstance.connect(e);De("‚úÖ window.bitmapWallet.connect() returned"),this.isConnected=!0;try{this.address=yield this.getAddress(),De("‚úÖ Got address")}catch(n){Xe("‚ö†Ô∏è Could not get address after connect")}return p(d({},r),{address:this.address||r.address||(null==(t=r.accounts)?void 0:t[0]),connected:!0})}if("function"==typeof this.walletInstance.requestAccounts){De("üîå Calling window.bitmapWallet.requestAccounts()...");const e=yield this.walletInstance.requestAccounts();return De("‚úÖ requestAccounts() returned"),this.isConnected=!0,this.address=Array.isArray(e)?e[0]:e,{address:this.address,accounts:e,connected:!0}}Xe("‚ö†Ô∏è BitmapWallet has no connect() or requestAccounts() - assuming already connected"),this.isConnected=!0;try{this.address=yield this.getAddress(),De("‚úÖ Got address")}catch(n){throw Xe("‚ö†Ô∏è Could not get address"),new Error("BitmapWallet: Could not retrieve address. Wallet may not be connected.")}return this._emit("connect",{address:this.address}),{address:this.address,connected:!0}})}disconnect(){return f(this,null,function*(){var e;if(this.removeEventListeners(),null==(e=this.walletInstance)?void 0:e.disconnect){const e=yield this.walletInstance.disconnect();return this.isConnected=!1,this.address=null,this._emit("disconnect"),e}return this.isConnected=!1,this.address=null,this._emit("disconnect"),{disconnected:!0}})}destroy(){this.removeEventListeners()}getAccounts(){return f(this,null,function*(){var e;return(null==(e=this.walletInstance)?void 0:e.getAccounts)?yield this.walletInstance.getAccounts():this.address?[this.address]:[]})}getAddress(){return f(this,null,function*(){var e;return(null==(e=this.walletInstance)?void 0:e.getAddress)?yield this.walletInstance.getAddress():this.address})}getPublicKey(){return f(this,null,function*(){var e;if(null==(e=this.walletInstance)?void 0:e.getPublicKey)return yield this.walletInstance.getPublicKey();throw new Error("getPublicKey not available")})}getBalance(){return f(this,null,function*(){var e;if(null==(e=this.walletInstance)?void 0:e.getBalance){const e=yield this.walletInstance.getBalance();return L.balance(e,"BitmapWallet")}throw new Error("getBalance not available")})}getUtxos(e){return f(this,null,function*(){var t;if(null==(t=this.walletInstance)?void 0:t.getUtxos)return yield this.walletInstance.getUtxos(e);throw new Error("getUtxos not available")})}getInscriptions(){return f(this,arguments,function*({offset:e=0,limit:t=100}={}){var n;return(null==(n=this.walletInstance)?void 0:n.getInscriptions)?yield this.walletInstance.getInscriptions({offset:e,limit:t}):[]})}detectBitmaps(){return f(this,null,function*(){var e;return(null==(e=this.walletInstance)?void 0:e.detectBitmaps)?yield this.walletInstance.detectBitmaps():[]})}signMessage(){return f(this,arguments,function*({address:e,message:t,protocol:n="BIP322"}={}){var r;if(null==(r=this.walletInstance)?void 0:r.signMessage)return yield this.walletInstance.signMessage({address:e,message:t,protocol:n});throw new Error("signMessage not available")})}_isHexString(e){return"string"==typeof e&&/^[0-9a-fA-F]+$/.test(e)&&e.length%2==0}_looksLikePsbtBase64(e){return"string"==typeof e&&e.startsWith("cHNidP8")}_isMagicNumberError(e){const t=String((null==e?void 0:e.message)||e||"");return/magic\s*number/i.test(t)}_getBitcoinJs(){return f(this,null,function*(){var e;return"undefined"!=typeof window&&(null==(e=window.bitcoin)?void 0:e.Psbt)?window.bitcoin:yield function(e,t){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),r=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));n=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in Ke)return;Ke[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script"),i.crossOrigin="",i.href=e,r&&i.setAttribute("nonce",r),document.head.appendChild(i),t?new Promise((t,n)=>{i.addEventListener("load",t),i.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return n.then(e=>{for(const t of e||[])"rejected"===t.status&&r(t.reason);return Promise.resolve().then(()=>hu).catch(r)})}(0,__VITE_PRELOAD__)})}_convertPsbtString(e,t){return f(this,null,function*(){const n=yield this._getBitcoinJs();return"base64"===t?this._looksLikePsbtBase64(e)?e:this._isHexString(e)?n.Psbt.fromHex(e).toBase64():n.Psbt.fromBase64(e).toBase64():"hex"===t?this._isHexString(e)?e:this._looksLikePsbtBase64(e)?n.Psbt.fromBase64(e).toHex():n.Psbt.fromHex(e).toHex():e})}signPsbt(e){return f(this,arguments,function*(e,t={}){var n;if(re(e,"psbt"),!(null==(n=this.walletInstance)?void 0:n.signPsbt))throw new Error("signPsbt not available");const r=e,i=this._isHexString(r),s=this._looksLikePsbtBase64(r),o=i?"hex":s?"base64":null;try{return yield this.walletInstance.signPsbt(r,t)}catch(a){if(!this._isMagicNumberError(a))throw a;const e=i?"base64":s?"hex":"base64",n=yield this._convertPsbtString(r,e),l=yield this.walletInstance.signPsbt(n,t);return"string"==typeof l&&o&&o!==e?yield this._convertPsbtString(l,o):l}})}signPsbts(e){return f(this,arguments,function*(e,t={}){var n;if(le(e,"psbts"),null==(n=this.walletInstance)?void 0:n.signPsbts)try{return yield this.walletInstance.signPsbts(e,t)}catch(i){if(!this._isMagicNumberError(i))throw i}const r=[];for(let s=0;s<e.length;s++)r.push(yield this.signPsbt(e[s],t));return r})}pushPsbt(e){return f(this,null,function*(){var t;if(null==(t=this.walletInstance)?void 0:t.pushPsbt){let t=e;if("string"==typeof e&&!e.startsWith("02"))try{const n=yield this._getBitcoinJs();let r;r=this._isHexString(e)?n.Psbt.fromHex(e):n.Psbt.fromBase64(e),t=r.extractTransaction().toHex()}catch(n){Xe("‚ö†Ô∏è Could not extract transaction from PSBT, pushing as-is")}return yield this.walletInstance.pushPsbt(t)}throw new Error("pushPsbt not available")})}pushTx(e){return f(this,null,function*(){var t;if(ie(e,"hex"),null==(t=this.walletInstance)?void 0:t.pushTx)return yield this.walletInstance.pushTx(e);throw new Error("pushTx not available")})}getFeeRate(){return f(this,null,function*(){var e;if(null==(e=this.walletInstance)?void 0:e.getFeeRate)return yield this.walletInstance.getFeeRate();throw new Error("getFeeRate not available")})}getNetwork(){return f(this,null,function*(){var e;return(null==(e=this.walletInstance)?void 0:e.getNetwork)?yield this.walletInstance.getNetwork():"mainnet"})}switchNetwork(e){return f(this,null,function*(){var t;if(null==(t=this.walletInstance)?void 0:t.switchNetwork){const t=yield this.walletInstance.switchNetwork(e);return this._emit("networkChanged",{network:e}),t}throw new Error("switchNetwork not available")})}getSpendableUtxos(e){return f(this,null,function*(){var t,n;if(null==(t=this.walletInstance)?void 0:t.getSpendableUtxos)return yield this.walletInstance.getSpendableUtxos(e);if(null==(n=this.walletInstance)?void 0:n.getUtxos)return yield this.walletInstance.getUtxos(e);throw new Error("getSpendableUtxos not available")})}getRunes(e){return f(this,null,function*(){var t;return(null==(t=this.walletInstance)?void 0:t.getRunes)?yield this.walletInstance.getRunes(e):[]})}getRareSats(e){return f(this,null,function*(){var t;return(null==(t=this.walletInstance)?void 0:t.getRareSats)?yield this.walletInstance.getRareSats(e):[]})}sendBitcoin(e,t){return f(this,arguments,function*(e,t,n={}){var r;if(ae(e,"toAddress"),oe(t,"satoshis"),null==(r=this.walletInstance)?void 0:r.sendBitcoin)return yield this.walletInstance.sendBitcoin(e,t,n);throw new Error("sendBitcoin not available")})}sendInscription(e,t){return f(this,arguments,function*(e,t,n={}){var r;if(null==(r=this.walletInstance)?void 0:r.sendInscription)return yield this.walletInstance.sendInscription(e,t,n);throw new Error("sendInscription not available")})}on(e,t){return this._events.has(e)||this._events.set(e,new Set),this._events.get(e).add(t),()=>this._events.get(e).delete(t)}_emit(e,t){const n=this._events.get(e);if(n)for(const i of n)try{i(t)}catch(r){Xe("bitmapwallet event handler error")}}},UniSat:me,Xverse:class extends te{constructor(){var e;super("Xverse"),this.paymentAddress=null,this.ordinalsAddress=null,this.paymentPublicKey=null,this.ordinalsPublicKey=null,this.identity=null,"undefined"!=typeof window&&(null==(e=window.XverseProviders)?void 0:e.BitcoinProvider)&&(this.walletInstance=window.XverseProviders.BitcoinProvider,this.identity="xverse:window.XverseProviders.BitcoinProvider"),this.features={connect:!0,getAddress:!0,getPublicKey:!0,getBalance:!0,signMessage:!0,signPsbt:!0,signPsbts:!0,pushPsbt:!1,pushTx:!1,signTransaction:!0,signMultipleTransactions:!0,sendBtcTransaction:!0,getInscriptions:!0,sendInscription:!0,createInscription:!0,createRepeatInscriptions:!0,getUtxos:!1,getBitcoinUtxos:!1,getCapabilities:!0,runes:!0,eventListeners:!0,networkSwitch:!1,brc20:!1,arc20:!1,atomicals:!1}}isInstalled(){return!!this.getProvider()}getProvider(){var e,t,n,r;if("undefined"==typeof window)return null;if(window.XverseProviders&&window.XverseProviders.BitcoinProvider)return this.identity="xverse:window.XverseProviders.BitcoinProvider",window.XverseProviders.BitcoinProvider;if(window.btc_providers&&Array.isArray(window.btc_providers))for(const i of window.btc_providers){if(!String((null==i?void 0:i.name)||(null==i?void 0:i.id)||"").toLowerCase().includes("xverse"))continue;const s="function"==typeof(null==i?void 0:i.request)&&i||"function"==typeof(null==(e=null==i?void 0:i.provider)?void 0:e.request)&&i.provider||"function"==typeof(null==(r=null==(n=null==(t=null==i?void 0:i.features)?void 0:t["sats-connect:"])?void 0:n.provider)?void 0:r.request)&&i.features["sats-connect:"].provider||null;if(s)return this.identity=`xverse:btc_providers:${(null==i?void 0:i.name)||(null==i?void 0:i.id)||"xverse"}`,s}return null}connect(){return f(this,null,function*(){var e;this.requireInstalled();try{const t=this.getProvider();we("üîç Xverse: Requesting wallet_connect...");const n=yield t.request("wallet_connect");if(we("üîç Xverse response:",n),!(null==(e=null==n?void 0:n.result)?void 0:e.addresses))throw new Error("No addresses returned from Xverse");const r=n.result.addresses,i=r.find(e=>"ordinals"===e.purpose),s=r.find(e=>"payment"===e.purpose);if(!i||!s)throw new Error("Missing ordinals or payment address from Xverse");return this.paymentAddress=s.address,this.ordinalsAddress=i.address,this.paymentPublicKey=s.publicKey,this.ordinalsPublicKey=i.publicKey,this.address=this.ordinalsAddress,this.isConnected=!0,we("‚úÖ Xverse connected:",{ordinals:this.ordinalsAddress,payment:this.paymentAddress,ordinalsPublicKey:this.ordinalsPublicKey,paymentPublicKey:this.paymentPublicKey}),{address:this.address,paymentAddress:this.paymentAddress,ordinalsAddress:this.ordinalsAddress,paymentPublicKey:this.paymentPublicKey,ordinalsPublicKey:this.ordinalsPublicKey}}catch(t){throw ve("‚ùå Xverse connection failed:",t),t}})}getAddress(){return f(this,null,function*(){return this.requireConnected(),this.ordinalsAddress||this.address})}getAddresses(){return f(this,arguments,function*(e=["ordinals","payment"]){this.requireConnected();try{const t=this.getProvider();we("üîç Xverse: Requesting getAddresses with purposes:",e);const n=yield t.request("getAddresses",{purposes:e,message:"App requesting addresses"});return we("‚úÖ Xverse getAddresses response:",n),n&&n.result&&n.result.addresses?n.result.addresses:[{purpose:"ordinals",address:this.ordinalsAddress,publicKey:this.ordinalsPublicKey},{purpose:"payment",address:this.paymentAddress,publicKey:this.paymentPublicKey}]}catch(t){return be("‚ö†Ô∏è Xverse getAddresses failed, using cached addresses:",t),[{purpose:"ordinals",address:this.ordinalsAddress,publicKey:this.ordinalsPublicKey},{purpose:"payment",address:this.paymentAddress,publicKey:this.paymentPublicKey}]}})}getBalance(){return f(this,null,function*(){var e;this.requireConnected();try{const t=this.getProvider();if(!t||"function"!=typeof t.request)throw new Error("Xverse provider.request method not available");we("üîç Xverse: Requesting getBalance...");const n=yield t.request("getBalance",void 0);let r;if(we("üîç Xverse getBalance response:",n),n&&"2.0"===n.jsonrpc&&n.result)r=n.result;else{if(!n||"success"!==n.status||!n.result)throw n&&"error"===n.status?new Error((null==(e=n.error)?void 0:e.message)||"Failed to get balance from Xverse"):new Error("Unexpected response format from Xverse getBalance");r=n.result}const i=L.balance(r,"Xverse");return N(i,"Xverse.getBalance"),we("üí∞ Xverse balance (sats):",i),i}catch(t){throw ve("‚ùå Xverse getBalance failed:",t),t}})}getInscriptions(e=0,t=100){return f(this,null,function*(){var n;this.requireConnected();try{const r=this.getProvider(),i=this.ordinalsAddress||this.address;we(`üì¶ Xverse: Fetching inscriptions for ${i} (offset: ${e}, limit: ${t})`);const s=yield r.request("ord_getInscriptions",{offset:e,limit:t});if(we("‚úÖ Xverse inscriptions response:",s),s&&"error"===s.status)throw ve("Xverse inscriptions error:",s.error),new Error(s.error.message||"Failed to get inscriptions");return((null==(n=null==s?void 0:s.result)?void 0:n.inscriptions)||(null==s?void 0:s.inscriptions)||[]).map(e=>({inscriptionId:e.inscriptionId||e.id,inscriptionNumber:e.inscriptionNumber||e.number,contentType:e.contentType||e.content_type,contentLength:e.contentLength||e.content_length,contentBody:`/content/${e.inscriptionId||e.id}`,timestamp:e.timestamp,genesisTransaction:e.genesisTransaction||e.genesis_transaction,location:e.location,output:e.output,outputValue:e.outputValue||e.output_value}))}catch(r){throw ve("‚ùå Failed to fetch Xverse inscriptions:",r),r}})}signPSBT(e){return f(this,arguments,function*(e,t={}){var n,r;this.requireConnected(),re(e,"psbt");try{const s=this.getProvider();if(!s)throw new Error("Xverse provider not available");we("üîè Xverse: Input options:",JSON.stringify(t,null,2));const o=!!t.broadcast,a=(()=>{if(!t||"object"!=typeof t)return;const e=[];if(null!=t.sighashTypes&&(Array.isArray(t.sighashTypes)?e.push(...t.sighashTypes):e.push(t.sighashTypes)),Array.isArray(t.toSignInputs))for(const r of t.toSignInputs)r&&"object"==typeof r&&(null!=r.sighashTypes&&(Array.isArray(r.sighashTypes)?e.push(...r.sighashTypes):e.push(r.sighashTypes)),null!=r.sighashType&&e.push(r.sighashType));const n=x(e,"Xverse.signPSBT: sighashTypes");return Array.isArray(n)&&n.length?n:void 0})();let l=[];if(t.toSignInputs&&Array.isArray(t.toSignInputs)){we("üîß Converting toSignInputs to sats-connect inputsToSign format");const e={};t.toSignInputs.forEach(t=>{if(t.address&&void 0!==t.index){const n=t.address===this.paymentAddress,r=t.address===this.ordinalsAddress;n||r?we(`‚úÖ Input ${t.index}: ${n?"PAYMENT":"ORDINALS"} address`):(be(`‚ö†Ô∏è Unknown address in input ${t.index}: ${t.address}`),be(`   Expected payment: ${this.paymentAddress}`),be(`   Expected ordinals: ${this.ordinalsAddress}`)),e[t.address]||(e[t.address]=[]),e[t.address].push(t.index)}}),l=Object.entries(e).map(([e,t])=>({address:e,signingIndexes:t})),we("üîß Converted inputsToSign:",l),we("üîë Address/PubKey mapping:"),l.forEach(e=>{e.address===this.paymentAddress?we(`   ${e.address} (PAYMENT) -> pubkey: ${this.paymentPublicKey}`):e.address===this.ordinalsAddress&&we(`   ${e.address} (ORDINALS) -> pubkey: ${this.ordinalsPublicKey}`)})}else t.signInputs&&"object"==typeof t.signInputs&&(we("üîß Converting signInputs to inputsToSign format"),l=Object.entries(t.signInputs).map(([e,t])=>({address:e,signingIndexes:t})),we("üîß Converted from signInputs:",l));const c={};if(l.forEach(e=>{var t;Array.isArray(e.signingIndexes)&&e.signingIndexes.length>0?(c[e.address]=e.signingIndexes,we(`‚úÖ Including ${e.address.slice(0,10)}... with ${e.signingIndexes.length} input(s): [${e.signingIndexes.join(", ")}]`)):be(`‚ö†Ô∏è Skipping address ${e.address} - no inputs to sign (${(null==(t=e.signingIndexes)?void 0:t.length)||0} indexes)`)}),0===Object.keys(c).length)throw new Error("signInputs is empty - no addresses with inputs to sign!");we("‚úÖ Final signInputs (filtered):",JSON.stringify(c,null,2));const u=/^[0-9a-fA-F]+$/.test(e),d=/^[A-Za-z0-9+/]+=*$/.test(e)&&!u;we("üîç PSBT Diagnostic:"),we("   PSBT format: "+(u?"HEX":d?"BASE64":"UNKNOWN")),we(`   Addresses in signInputs: ${Object.keys(c).length}`),Object.keys(c).forEach(e=>{const t=e.startsWith("bc1p")||e.startsWith("tb1p"),n=e.startsWith("bc1q")||e.startsWith("tb1q"),r=e.startsWith("3")||e.startsWith("2");we(`   - ${e.slice(0,10)}...: ${t?"P2TR (Taproot)":n?"P2WPKH (Native SegWit)":r?"P2SH-P2WPKH (Wrapped SegWit)":"Unknown"} - inputs: [${c[e].join(", ")}]`)});try{const t=u?e:L.psbtFormat(e,"Xverse","output");if(t.startsWith("70736274ff")){const e=(t.match(/0000000000/g)||[]).length;we(`   üìã PSBT appears to have ~${e} input(s) total`),we(`   üìã We're asking Xverse to sign ${Object.values(c).flat().length} of them`),e>Object.values(c).flat().length&&(be("   ‚ö†Ô∏è  PSBT has MORE inputs than we're signing!"),be(`   ‚ö†Ô∏è  This might mean input ${e-1} is unsigned (e.g., inscription tapscript)`),be("   ‚ö†Ô∏è  Xverse might be confused by the unsigned Taproot input"))}}catch(i){we(`   ‚ÑπÔ∏è  Could not decode PSBT for diagnostic: ${i.message}`)}let p;if(u)we("üì¶ Converting PSBT from HEX to BASE64 for Xverse..."),p=L.psbtFormat(e,"Xverse","input"),we("   Original HEX length:",e.length,"chars"),we("   Converted BASE64 length:",p.length,"chars"),we("   First 50 chars of BASE64:",p.substring(0,50));else{if(!d)throw new Error("Invalid PSBT format: neither HEX nor BASE64");we("‚úÖ PSBT already in BASE64 format"),p=e}we('üîè Xverse: Calling request("signPsbt") with Sats Connect format'),we("   signInputs:",JSON.stringify(c,null,2)),we("   broadcast:",o);const h={psbt:p,signInputs:c,broadcast:o};Array.isArray(a)&&a.length&&(h.sighashTypes=a,h.allowedSighashTypes=a,h.allowedSighash=a);const f=yield s.request("signPsbt",h);if(we('üîç Xverse request("signPsbt") response:',f),f&&"2.0"===f.jsonrpc&&f.error){const e=f.error.code,t=f.error.message||"PSBT signing failed";if(ve("‚ùå Xverse JSON-RPC error:",e,t),"USER_REJECTION"===e||4001===e)throw new Error("User rejected the signing request");if(t.includes("No taproot scripts signed")||t.includes("taproot"))throw ve("üö® XVERSE LIMITATION DETECTED:"),ve('   Error: "No taproot scripts signed"'),ve("   "),ve("   This happens when:"),ve("   1. PSBT has multiple inputs (e.g., parent + inscription)"),ve("   2. Some inputs are Taproot tapscript (inscription input)"),ve("   3. Xverse tries to sign ALL Taproot inputs, not just the ones specified"),ve("   "),ve("   WORKAROUND OPTIONS:"),ve("   A) Use Magic Eden or UniSat wallet (better Taproot support)"),ve("   B) Use single-input inscriptions (no parent)"),ve("   C) Wait for Xverse to fix multi-input Taproot PSBT handling"),ve("   "),ve("   Technical: Reveal PSBT has 2 inputs:"),ve("     - Input 0: Parent inscription (key-path, wallet signs)"),ve("     - Input 1: Inscription output (tapscript, local signing)"),ve("   Xverse sees input 1 and tries to sign it, but cannot."),new Error("Xverse cannot sign parent-child inscriptions. This is a known Xverse limitation with multi-input Taproot PSBTs. Please use Magic Eden or UniSat wallet for parent-child inscriptions, or create inscriptions without parents.");throw new Error(t)}if(f&&f.result&&f.result.txid&&!f.result.psbtBase64&&!f.result.psbt)return we("‚úÖ Xverse broadcast successful! Transaction ID:",f.result.txid),we("   (No signed PSBT returned - wallet broadcasted directly)"),{broadcasted:!0,txid:f.result.txid,message:"Xverse broadcasted transaction automatically"};if(f&&"success"===f.status&&f.result){const e=f.result.psbtBase64||f.result.psbt||f.result;if(!e)throw new Error("No signed PSBT in response result");we('‚úÖ Xverse PSBT signed successfully via request("signPsbt")'),we("   ‚ÑπÔ∏è  Xverse v1.6.1 ignores broadcast flag - manual broadcast required");const t=L.psbtFormat(e,"Xverse","output");return we("üîß Converted signed PSBT: BASE64 ‚Üí HEX for downstream processing"),t}if(f&&"error"===f.status){const e=null==(n=f.error)?void 0:n.code;if("USER_REJECTION"===e||4001===e)throw new Error("User rejected the signing request");throw new Error((null==(r=f.error)?void 0:r.message)||"PSBT signing failed")}if(f&&"2.0"===f.jsonrpc&&f.result){if(f.result.txid&&!f.result.psbt&&!f.result.psbtBase64)return we("‚úÖ Xverse broadcast successful! Transaction ID:",f.result.txid),{broadcasted:!0,txid:f.result.txid,message:"Xverse broadcasted transaction automatically"};const e=f.result.psbt||f.result.psbtBase64;if(!e)throw new Error("No signed PSBT in JSON-RPC result");we("‚úÖ Xverse PSBT signed successfully (JSON-RPC format)"),we("   ‚ÑπÔ∏è  Xverse v1.6.1 ignores broadcast flag - manual broadcast required");const t=L.psbtFormat(e,"Xverse","output");return we("üîß Converted signed PSBT: BASE64 ‚Üí HEX for downstream processing"),t}if(f&&f.psbtBase64){we("‚úÖ Xverse PSBT signed successfully (direct format)");const e=L.psbtFormat(f.psbtBase64,"Xverse","output");return we("üîß Converted signed PSBT: BASE64 ‚Üí HEX for downstream processing"),e}throw new Error("Invalid response format from Xverse wallet")}catch(s){ve("‚ùå Xverse PSBT signing failed:",s);const e=(null==s?void 0:s.message)||"Unknown Xverse signing error";throw new Error(`Xverse: ${e}`)}})}signPsbt(e){return f(this,arguments,function*(e,t={}){return yield this.signPSBT(e,t)})}pushPsbt(e){return f(this,arguments,function*(e,t={}){be("‚ö†Ô∏è Xverse: Manual broadcast required"),be("   (Automatic broadcast via signPsbt should be attempted first)"),be("   Throwing error to trigger manual broadcast UI...");const n=new Error("Xverse requires manual broadcast");throw n.walletType="Xverse",n.requiresManualBroadcast=!0,n})}pushTx(e){return f(this,null,function*(){be("‚ö†Ô∏è Xverse: Manual broadcast required"),be("   (Automatic broadcast via signPsbt should be attempted first)"),be("   Throwing error to trigger manual broadcast UI...");const e=new Error("Xverse requires manual broadcast");throw e.walletType="Xverse",e.requiresManualBroadcast=!0,e})}sendBitcoin(e,t){return f(this,null,function*(){this.requireConnected(),ae(e,"toAddress"),oe(t,"amount");try{const n=this.getProvider(),r=yield n.request({method:"sendTransfer",params:{recipients:[{address:e,amountSats:t}]}});return we("‚úÖ Transaction sent:",null==r?void 0:r.txid),r.txid}catch(n){throw ve("‚ùå Failed to send Bitcoin:",n),n}})}getCapabilities(){return f(this,null,function*(){this.requireConnected();try{return{walletType:"Xverse",methods:Object.keys(this.features).filter(e=>!0===this.features[e]),features:{multiAddress:!0,runes:!0,inscriptions:!0,batchOperations:!0,utxos:!1},addresses:{payment:this.paymentAddress,ordinals:this.ordinalsAddress}}}catch(e){throw ve("‚ùå Failed to get capabilities:",e),e}})}signMessage(e){return f(this,null,function*(){this.requireConnected();try{const t=this.getProvider();return yield t.request("signMessage",{address:this.ordinalsAddress||this.address,message:e})}catch(t){throw ve("‚ùå Failed to sign message:",t),t}})}signTransaction(e){return f(this,arguments,function*(e,t={}){this.requireConnected();try{const n=this.getProvider(),r=yield n.signTransaction(e,t);return we("‚úÖ Transaction signed via Xverse signTransaction"),r}catch(n){throw ve("‚ùå Failed to sign transaction:",n),n}})}signMultipleTransactions(e){return f(this,arguments,function*(e,t={}){this.requireConnected();try{const n=this.getProvider(),r=yield n.signMultipleTransactions(e,t);return we(`‚úÖ ${r.length} transactions signed via Xverse`),r}catch(n){throw ve("‚ùå Failed to sign multiple transactions:",n),n}})}createInscription(e){return f(this,arguments,function*(e,t={}){this.requireConnected();try{const n=this.getProvider(),r=yield n.createInscription(d(d({},e),t));return we("‚úÖ Inscription created via Xverse:",r),r}catch(n){throw ve("‚ùå Failed to create inscription:",n),n}})}createRepeatInscriptions(e){return f(this,null,function*(){var t;this.requireConnected();try{const t=this.getProvider();if(!t)throw new Error("Xverse provider not found");we("üîç Xverse: Creating repeat inscriptions with payload:",{repeat:e.repeat,contentType:e.contentType,payloadType:e.payloadType,feeRate:e.suggestedMinerFeeRate});const n=$(e);we("üîç Xverse: Created JWT token for repeat inscriptions request");const r=yield t.createRepeatInscriptions(n);if(we("‚úÖ Xverse repeat inscriptions response:",r),!r)throw new Error("No response from Xverse wallet");if(r.error)throw new Error(r.error.message||"Provider returned an error");const i={txId:r.txId,inscriptionIds:r.inscriptionIds||[],count:e.repeat};return we(`‚úÖ ${e.repeat} inscriptions created via Xverse:`,i),i}catch(n){if(ve("‚ùå Failed to create repeat inscriptions:",n),4001===n.code||(null==(t=n.message)?void 0:t.includes("cancel")))throw new Error("Batch inscription cancelled by user");throw new Error(`Batch inscription failed: ${n.message}`)}})}getNetwork(){return f(this,null,function*(){return"mainnet"})}getPublicKey(){return f(this,null,function*(){return this.requireConnected(),this.ordinalsPublicKey||this.paymentPublicKey})}getAccounts(){return f(this,null,function*(){return this.requireConnected(),[{purpose:"ordinals",address:this.ordinalsAddress,publicKey:this.ordinalsPublicKey},{purpose:"payment",address:this.paymentAddress,publicKey:this.paymentPublicKey}]})}getState(){return{wallet:"Xverse",connected:!!this.isConnected,network:"mainnet",paymentAddress:this.paymentAddress,ordinalsAddress:this.ordinalsAddress,paymentPublicKey:this.paymentPublicKey,ordinalsPublicKey:this.ordinalsPublicKey}}inscribe(e){return f(this,arguments,function*(e,t={}){var n;this.requireConnected();try{const n=this.getProvider();if(!n)throw new Error("Xverse provider not found");const{contentType:r="text/plain;charset=utf-8",feeRate:i=10,receiverAddress:s,devAddress:o,devFee:a=0}=t;let l="PLAIN_TEXT",c=e;if((e instanceof ArrayBuffer||r.startsWith("image/"))&&(l="BASE_64",e instanceof ArrayBuffer)){const t=new Uint8Array(e);let n="";for(let e=0;e<t.byteLength;e++)n+=String.fromCharCode(t[e]);c=btoa(n)}const u={contentType:r,content:c,payloadType:l,network:{type:"Mainnet"}};i&&(u.suggestedMinerFeeRate=i),o&&a>0&&(u.appFeeAddress=o,u.appFee=a),we("üîç Xverse: Creating inscription with payload:",{contentType:u.contentType,payloadType:u.payloadType,contentLength:c.length,feeRate:u.suggestedMinerFeeRate,hasServiceFee:!(!o||!a)});const d=$(u);we("üîç Xverse: Created JWT token for inscription request");const p=yield n.createInscription(d);if(we("‚úÖ Xverse inscription response:",p),!p)throw new Error("No response from Xverse wallet");if(p.error)throw new Error(p.error.message||"Provider returned an error");const h={txId:p.txId,inscriptionId:p.inscriptionId||p.txId};return we("‚úÖ Xverse inscription created:",h),h}catch(r){if(ve("‚ùå Xverse inscribe error:",r),4001===r.code||(null==(n=r.message)?void 0:n.includes("cancel")))throw new Error("Inscription cancelled by user");throw new Error(`Inscription failed: ${r.message}`)}})}getRunesBalance(){return f(this,null,function*(){this.requireConnected();try{const e=this.getProvider();we("üîç Xverse: Requesting runes_getBalance...");const t=yield e.request("runes_getBalance",void 0);return we("‚úÖ Xverse runes balance:",t),t&&t.result?t.result:t}catch(e){throw ve("‚ùå Xverse getRunesBalance failed:",e),e}})}transferRunes(e){return f(this,null,function*(){this.requireConnected();try{const t=this.getProvider();we("üîç Xverse: Transferring runes:",e);const n=yield t.request("runes_transfer",e);return we("‚úÖ Xverse runes transfer:",n),n}catch(t){throw ve("‚ùå Xverse transferRunes failed:",t),t}})}mintRunes(e){return f(this,null,function*(){this.requireConnected();try{const t=this.getProvider();we("üîç Xverse: Minting runes:",e);const n=yield t.request("runes_mint",e);return we("‚úÖ Xverse runes mint:",n),n}catch(t){throw ve("‚ùå Xverse mintRunes failed:",t),t}})}etchRunes(e){return f(this,null,function*(){this.requireConnected();try{const t=this.getProvider();we("üîç Xverse: Etching runes:",e);const n=yield t.request("runes_etch",e);return we("‚úÖ Xverse runes etch:",n),n}catch(t){throw ve("‚ùå Xverse etchRunes failed:",t),t}})}getRunesOrder(e){return f(this,null,function*(){this.requireConnected();try{const t=this.getProvider();we("üîç Xverse: Getting runes order:",e);const n=yield t.request("runes_getOrder",{orderId:e});return we("‚úÖ Xverse runes order:",n),n}catch(t){throw ve("‚ùå Xverse getRunesOrder failed:",t),t}})}sendInscriptions(e){return f(this,null,function*(){this.requireConnected();try{const t=this.getProvider();we("üîç Xverse: Sending inscriptions:",e);const n=yield t.request("ord_sendInscriptions",e);return we("‚úÖ Xverse inscriptions sent:",n),n}catch(t){throw ve("‚ùå Xverse sendInscriptions failed:",t),t}})}},OKX:Se,Leather:Ae,Phantom:_e,Wizz:Ue,MagicEden:Me,Oyl:class extends te{constructor(){super("Oyl"),this.paymentAddress=null,this.ordinalsAddress=null,this._walletInstance=null,this.walletInstance="undefined"!=typeof window?window.oyl:null,this.features={connect:!0,getAddress:!0,getPublicKey:!1,getBalance:!0,getNetwork:!0,switchNetwork:!0,signMessage:!0,signPsbt:!0,signPsbts:!0,pushPsbt:!0,pushTx:!1,sendBitcoin:!0,sendInscription:!1,getInscriptions:!0,getAllInscriptions:!0,inscribe:!1,brc20:{transfer:!1,deploy:!1,mint:!1},runes:{send:!1,mint:!1,etch:!1},atomicals:{transfer:!1,mint:!1},arc20:{transfer:!1},relayProvider:!0},this.refreshCapabilities()}set walletInstance(e){this._walletInstance=e}get walletInstance(){return("undefined"!=typeof window?window.oyl:null)||this._walletInstance||null}refreshCapabilities(){const e=this.walletInstance;this.features.signPsbts=!!(null==e?void 0:e.signPsbts),this.features.getBalance=!!(null==e?void 0:e.getBalance),this.features.getNetwork=!!(null==e?void 0:e.getNetwork),this.features.switchNetwork=!!(null==e?void 0:e.switchNetwork),this.features.getInscriptions=!!(null==e?void 0:e.getInscriptions)}isInstalled(){return this.refreshCapabilities(),!!this.walletInstance}connect(){return f(this,null,function*(){this.requireInstalled();try{qe("üîç Connecting to Oyl wallet...");const e=this.walletInstance,t=yield e.getAddresses();if(qe("üîç Oyl addresses received"),!t)throw new Error("No response from Oyl wallet");if(t.taproot&&t.taproot.address&&(this.address=t.taproot.address,this.ordinalsAddress=t.taproot.address,this.publicKey=t.taproot.publicKey),t.nativeSegwit&&t.nativeSegwit.address&&(this.paymentAddress=t.nativeSegwit.address,this.address||(this.address=t.nativeSegwit.address)),!this.address)throw new Error("No valid address returned from Oyl wallet");return this.isConnected=!0,this.refreshCapabilities(),qe("‚úÖ Oyl connected"),{address:this.address,ordinalsAddress:this.ordinalsAddress,paymentAddress:this.paymentAddress,publicKey:this.publicKey}}catch(e){throw Fe("‚ùå Oyl connection failed"),e}})}disconnect(){return f(this,null,function*(){var e;(null==(e=this.walletInstance)?void 0:e.disconnect)&&(yield this.walletInstance.disconnect()),this.isConnected=!1,this.address=null,this.ordinalsAddress=null,this.paymentAddress=null,qe("‚úÖ Oyl disconnected")})}isConnectedCheck(){return f(this,null,function*(){if(!this.isInstalled())return!1;try{return yield this.walletInstance.isConnected()}catch(e){return this.isConnected}})}getAddress(){return f(this,null,function*(){this.requireConnected();try{const e=yield this.walletInstance.getAddresses();return e&&e.taproot&&e.taproot.address?e.taproot.address:this.address}catch(e){return Fe("‚ùå Failed to get address"),this.address}})}getAccounts(){return f(this,null,function*(){this.requireInstalled();try{const e=yield this.walletInstance.getAddresses();return e&&e.taproot?[e.taproot.address,e.nativeSegwit.address]:[]}catch(e){throw Fe("‚ùå Failed to get accounts"),e}})}getBalance(){return f(this,null,function*(){this.requireConnected();try{if("function"==typeof this.walletInstance.getBalance){const e=yield this.walletInstance.getBalance();return L.balance(e,"Oyl")}throw new Error("Oyl wallet does not support balance fetching")}catch(e){throw new Error(`Failed to get Oyl balance: ${e.message}`)}})}getNetwork(){return f(this,null,function*(){this.requireInstalled();try{if("function"==typeof this.walletInstance.getNetwork){const e=yield this.walletInstance.getNetwork();return L.network(e)}return"livenet"}catch(e){return Fe("‚ùå Failed to get network"),"livenet"}})}switchNetwork(e){return f(this,null,function*(){this.requireInstalled(),yield this.walletInstance.switchNetwork(e),qe("‚úÖ Oyl network switched")})}signMessage(e){return f(this,arguments,function*(e,t={}){this.requireConnected();const n=t.toSignAddress||this.paymentAddress||this.address,r=yield this.walletInstance.signMessage({address:n,message:e,protocol:t.protocol});return(null==r?void 0:r.signature)||r})}signPsbt(e){return f(this,arguments,function*(e,t={}){var n,r,i;this.requireConnected(),se(e,"psbt"),qe("üîç OYL signPsbt called");try{let a,l=e;if(e instanceof Uint8Array?(qe("üîÑ Converting PSBT from Uint8Array to HEX for OYL..."),l=Array.from(e,e=>e.toString(16).padStart(2,"0")).join(""),qe("‚úÖ Converted Uint8Array to hex")):l=L.psbtFormat(e,"Oyl","input"),!l.toLowerCase().startsWith("70736274"))throw Fe("‚ùå PSBT does not start with magic bytes (70736274)"),new Error("Invalid PSBT: missing magic bytes");qe("üîè Calling OYL wallet.signPsbt..."),qe("   PSBT hex length:",l.length,"chars");try{const e={psbt:l,finalize:null!=(r=null!=(n=t.autoFinalized)?n:t.finalize)&&r,broadcast:null!=(i=t.broadcast)&&i};qe("üîÑ OYL calling: signPsbt({ psbt, finalize, broadcast })"),a=yield this.walletInstance.signPsbt(e),qe("‚úÖ OYL signed PSBT successfully")}catch(s){throw Fe("‚ùå OYL signPsbt failed:",null==s?void 0:s.message),new Error(`OYL wallet failed to sign PSBT: ${null==s?void 0:s.message}. Make sure you are connected to OYL wallet and try again.`)}let c=(null==a?void 0:a.psbt)||a;if(!c)throw new Error("OYL returned invalid response - no psbt property found");qe("‚úÖ OYL signed PSBT");try{return L.psbtFormat(c,"Oyl","output")}catch(o){return c}}catch(s){throw Fe("‚ùå OYL signPsbt failed:",null==s?void 0:s.message),s}})}signPsbts(e){return f(this,arguments,function*(e,t={}){this.requireConnected(),le(e,"psbts"),qe("üîç OYL signPsbts called with:",null==e?void 0:e.length,"PSBTs");const n=(e||[]).map((e,t)=>{try{return L.psbtFormat(e,"Oyl","input")}catch(n){throw new Error(`Invalid PSBT at index ${t}: must be hex or base64`)}}).map(e=>{var n,r,i;return{psbt:e,finalize:null!=(r=null!=(n=t.autoFinalized)?n:t.finalize)&&r,broadcast:null!=(i=t.broadcast)&&i}});qe("üîÑ OYL calling: signPsbts([{ psbt, finalize, broadcast }, ...])");const r=yield this.walletInstance.signPsbts(n);return qe("‚úÖ OYL signed",null==r?void 0:r.length,"PSBTs"),Array.isArray(r)?r.map(e=>{const t=(null==e?void 0:e.psbt)||e;try{return L.psbtFormat(t,"Oyl","output")}catch(n){return t}}):r})}pushPsbt(e){return f(this,null,function*(){this.requireConnected();const t=yield this.walletInstance.pushPsbt({psbt:e}),n=(null==t?void 0:t.txid)||t;return qe("‚úÖ Oyl PSBT pushed"),n})}sendBitcoin(e,t){return f(this,null,function*(){if(this.requireConnected(),ae(e,"toAddress"),oe(t,"amount"),"function"!=typeof this.walletInstance.sendBitcoin)throw Fe("‚ö†Ô∏è Oyl wallet may not support sendBitcoin directly"),new Error("Oyl wallet does not support sendBitcoin() method.\nUse sendToRelayProvider() or external transaction building.");try{const n=yield this.walletInstance.sendBitcoin(e,t);return qe("‚úÖ Oyl transaction sent"),n}catch(n){throw Fe("‚ùå Failed to send Bitcoin"),n}})}getInscriptions(e=0,t=100){return f(this,null,function*(){this.requireConnected();try{if("function"!=typeof this.walletInstance.getInscriptions)return Fe("‚ö†Ô∏è Oyl wallet does not support inscription fetching"),{list:[],total:0};const n=yield this.walletInstance.getInscriptions(e,t),r=Array.isArray(n)?n:n.list||[];return{list:r.map(e=>L.inscription(e,"Oyl")),total:r.length}}catch(n){return Fe("‚ùå Failed to fetch Oyl inscriptions"),{list:[],total:0}}})}sendToRelayProvider(e){return f(this,null,function*(){if(this.requireInstalled(),"function"!=typeof this.walletInstance.sendToRelayProvider)throw new Error("Oyl wallet does not support sendToRelayProvider()");return yield this.walletInstance.sendToRelayProvider(e)})}destroy(){}}};let Je={isConnected:!1,walletType:null,address:null,publicKey:null,balance:null,provider:null},Qe=null;const Ze=new Set;function et(e){Je=d(d({},Je),e),Ze.forEach(e=>e(Je))}function tt(){return d({},Je)}function nt(e){return Ze.add(e),()=>Ze.delete(e)}function rt(){return Je.provider}function it(){return Qe?d({},Qe):null}function st(e){var t,n,r,i,s,o;const a=(null==Qe?void 0:Qe.provider)||Zt("UniSat");if("function"!=typeof(null==(t=null==a?void 0:a.mobile)?void 0:t.submitResponseText))throw new Error("UniSat mobile response handler unavailable");const l=a.mobile.submitResponseText(e),c=null==l?void 0:l.result;if(c){const e="string"==typeof(null==c?void 0:c.address)&&c.address||(Array.isArray(c)&&"string"==typeof(null==c?void 0:c[0])?c[0]:null)||(Array.isArray(null==c?void 0:c.accounts)&&"string"==typeof(null==(n=c.accounts)?void 0:n[0])?c.accounts[0]:null)||(Array.isArray(null==c?void 0:c.accounts)&&"string"==typeof(null==(i=null==(r=c.accounts)?void 0:r[0])?void 0:i.address)?c.accounts[0].address:null)||null,t="string"==typeof(null==c?void 0:c.publicKey)&&c.publicKey||(Array.isArray(null==c?void 0:c.accounts)&&"string"==typeof(null==(o=null==(s=c.accounts)?void 0:s[0])?void 0:o.publicKey)?c.accounts[0].publicKey:null)||null;e&&(a.address=e,a.publicKey=t,a.isConnected=!0,et({isConnected:!0,walletType:"UniSat",address:e,publicKey:t||null,provider:a}))}return Qe=null,l}function ot(){return f(this,null,function*(){if(Je.provider)try{yield Je.provider.disconnect()}catch(e){console.warn("Disconnect failed:",e)}et({isConnected:!1,walletType:null,address:null,publicKey:null,balance:null,provider:null})})}function at(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");const e=B(yield Je.provider.getBalance(),Je.walletType||void 0);return N(e,"dev-loader.getBalance"),et({balance:e}),e})}function lt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");const t=yield Je.provider.getInscriptions(...e);let n=[];t&&"object"==typeof t&&Array.isArray(t.list)?n=t.list:Array.isArray(t)&&(n=t);const r=Je.walletType||"Unknown";if("BitmapWallet"===r&&n.length>0&&n[0].inscriptions){console.log("üîÑ Flattening BitmapWallet UTXO format to inscription list");const e=[];n.forEach(t=>{t.inscriptions&&Array.isArray(t.inscriptions)&&t.inscriptions.forEach(n=>{e.push({inscriptionId:n,txid:t.txid,vout:t.vout,output:`${t.txid}:${t.vout}`})})}),n=e,console.log(`‚úÖ Flattened to ${n.length} inscriptions`)}n.length>0&&console.log("üîç Raw inscription data from wallet:",n[0]);const i=n.map(e=>A(e,r));return i.length>0&&console.log("‚úÖ Normalized inscription data:",i[0]),i})}function ct(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.getAllInscriptions()})}function ut(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.signMessage(...e)})}function dt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.signPsbt(...e)})}function pt(...e){return f(this,null,function*(){return yield dt(...e)})}function ht(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.signPsbts(...e)})}function ft(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.sendBitcoin(...e)})}function gt(...e){return f(this,null,function*(){return yield ft(...e)})}function mt(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.getNetwork()})}function yt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.switchNetwork(...e)})}function wt(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.getPublicKey()})}function bt(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.getAddress()})}function vt(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.getAccounts()})}function Et(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.pushPsbt(...e)})}function St(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.pushTx(...e)})}function It(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.sendInscription(...e)})}function Tt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.inscribe(...e)})}function Pt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");return yield Je.provider.sendRunes(...e)})}function At(){if(!Je.provider)throw new Error("No wallet connected");return Je.provider.getInfo()}function Bt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.getAddresses)throw new Error(`${Je.walletType} does not support getAddresses()`);return yield Je.provider.getAddresses(...e)})}function Nt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.createRepeatInscriptions)throw new Error(`${Je.walletType} does not support batch inscriptions`);return yield Je.provider.createRepeatInscriptions(...e)})}function xt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.sendInscriptions)throw new Error(`${Je.walletType} does not support sendInscriptions()`);return yield Je.provider.sendInscriptions(...e)})}function _t(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.getRunesBalance)throw new Error(`${Je.walletType} does not support Runes`);return yield Je.provider.getRunesBalance()})}function Ct(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.transferRunes)throw new Error(`${Je.walletType} does not support Runes transfer`);return yield Je.provider.transferRunes(...e)})}function kt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.mintRunes)throw new Error(`${Je.walletType} does not support Runes minting`);return yield Je.provider.mintRunes(...e)})}function Ot(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.etchRunes)throw new Error(`${Je.walletType} does not support Runes etching`);return yield Je.provider.etchRunes(...e)})}function Ut(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.getRunesOrder)throw new Error(`${Je.walletType} does not support getRunesOrder()`);return yield Je.provider.getRunesOrder(...e)})}function Rt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.signMultipleTransactions)throw new Error(`${Je.walletType} does not support signMultipleTransactions()`);return yield Je.provider.signMultipleTransactions(...e)})}function Lt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.createInscription)throw new Error(`${Je.walletType} does not support createInscription()`);return yield Je.provider.createInscription(...e)})}function Ht(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.getProductInfo)throw new Error(`${Je.walletType} does not support getProductInfo() (Leather only)`);return yield Je.provider.getProductInfo()})}function Mt(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.getURL)throw new Error(`${Je.walletType} does not support getURL() (Leather only)`);return yield Je.provider.getURL()})}function Wt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.signStructuredData)throw new Error(`${Je.walletType} does not support signStructuredData() (Leather only)`);return yield Je.provider.signStructuredData(...e)})}function qt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.authenticate)throw new Error(`${Je.walletType} does not support authenticate() (Leather only)`);return yield Je.provider.authenticate(...e)})}function Ft(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.sendStacksTransaction)throw new Error(`${Je.walletType} does not support Stacks transactions (Leather only)`);return yield Je.provider.sendStacksTransaction(...e)})}function Kt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.updateProfile)throw new Error(`${Je.walletType} does not support updateProfile() (Leather only)`);return yield Je.provider.updateProfile(...e)})}function $t(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.isHardware)throw new Error(`${Je.walletType} does not support isHardware() (MagicEden only)`);return yield Je.provider.isHardware()})}function Dt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.call)throw new Error(`${Je.walletType} does not support call() (MagicEden only)`);return yield Je.provider.call(...e)})}function Xt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.inscribeTransfer)throw new Error(`${Je.walletType} does not support inscribeTransfer()`);return yield Je.provider.inscribeTransfer(...e)})}function Vt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.splitUtxo)throw new Error(`${Je.walletType} does not support splitUtxo() (OKX only)`);return yield Je.provider.splitUtxo(...e)})}function jt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.transferNft)throw new Error(`${Je.walletType} does not support transferNft() (OKX only)`);return yield Je.provider.transferNft(...e)})}function Gt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.watchAsset)throw new Error(`${Je.walletType} does not support watchAsset() (OKX only)`);return yield Je.provider.watchAsset(...e)})}function zt(...e){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.mint)throw new Error(`${Je.walletType} does not support mint() (OKX only)`);return yield Je.provider.mint(...e)})}function Yt(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.getCapabilities)throw new Error(`${Je.walletType} does not support getCapabilities()`);return yield Je.provider.getCapabilities()})}function Jt(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if(console.log(`üîç getUtxos: Checking ${Je.walletType} provider capabilities...`),console.log(`  - hasGetUtxos: ${"function"==typeof Je.provider.getUtxos}`),console.log(`  - hasGetBitcoinUtxos: ${"function"==typeof Je.provider.getBitcoinUtxos}`),console.log(`  - hasSplitUtxo: ${"function"==typeof Je.provider.splitUtxo}`),"function"!=typeof Je.provider.getUtxos&&"function"!=typeof Je.provider.getBitcoinUtxos&&"function"!=typeof Je.provider.splitUtxo)throw new Error(`${Je.walletType} does not support UTXO fetching. Only UniSat and Wizz provide confirmed UTXO access. OKX has splitUtxo() method with different API.`);let e;return"function"==typeof Je.provider.getUtxos?e=yield Je.provider.getUtxos():"function"==typeof Je.provider.getBitcoinUtxos?e=yield Je.provider.getBitcoinUtxos():"function"==typeof Je.provider.splitUtxo&&(console.log("üîç Using OKX splitUtxo method for UTXO access..."),e=(yield Je.provider.splitUtxo({from:Je.address,amount:2})).utxos||[]),console.log("‚úÖ getUtxos result:",e),e})}function Qt(){return f(this,null,function*(){if(!Je.provider)throw new Error("No wallet connected");if("function"!=typeof Je.provider.getBRC20List&&"function"!=typeof Je.provider.getBRC20Summary)throw new Error(`${Je.walletType} does not support BRC-20 listing. Only UniSat provides BRC-20 token listing.`);return"function"==typeof Je.provider.getBRC20List?yield Je.provider.getBRC20List():yield Je.provider.getBRC20Summary()})}function Zt(e){const t=ze(e),n=Ye[t];if(!n)throw new Error(`Unknown wallet: ${e}`);return new n}function en(){try{return"undefined"!=typeof navigator&&/Android|iPhone|iPad|iPod/i.test(navigator.userAgent||"")}catch(e){return!1}}function tn(e,t){var n,r,i;if("undefined"==typeof window)return null;const s=ze(e),o=t||(null==(n=window.location)?void 0:n.href);if(!o)return null;if("Phantom"===s){const e=(null==(r=window.location)?void 0:r.origin)||(null==(i=window.location)?void 0:i.href)||o;return`https://phantom.app/ul/browse/${encodeURIComponent(o)}?ref=${encodeURIComponent(e)}`}return"Xverse"===s?`https://connect.xverse.app/browser?url=${encodeURIComponent(o)}`:null}function nn(e,t){return f(this,null,function*(){const n=tn(e,t);if(!n)throw new Error(`No mobile open URL configured for ${e}`);return window.location.href=n,n})}function rn(){console.log("üîç Checking for Leather wallet..."),console.log("  - window.LeatherProvider:",typeof window.LeatherProvider),console.log("  - window.HiroWalletProvider:",typeof window.HiroWalletProvider),console.log("  - window.btc_providers:",window.btc_providers);const e=[];for(const[t,n]of Object.entries(Ge))n.detection&&n.detection()&&e.push(d({name:t},n));return console.log(`‚úÖ Found ${e.length} installed wallets:`,e.map(e=>e.name)),e}function sn(e){return f(this,null,function*(){const t=ze(e);console.log(`üîå Connecting to ${t}...`);const n=Zt(t);if(!(n.isInstalled()||"UniSat"===t&&en()))throw function(e){const t=ze(e),n=Ge[t];return new Error(`${e} wallet is not installed.\n\nDownload: ${(null==n?void 0:n.downloadUrl)||"Visit wallet website"}`)}(t);try{const e=yield n.connect();et({isConnected:!0,walletType:t,address:e.address||n.address,publicKey:e.publicKey||n.publicKey,provider:n}),console.log(`‚úÖ Connected to ${t}`);try{const e=B(yield n.getBalance(),t);N(e,`dev-loader.connect(${t}).balance`),et({balance:e}),console.log("üí∞ Balance fetched (sats):",e)}catch(r){console.warn("‚ö†Ô∏è Could not fetch balance:",r.message),et({balance:null})}return n}catch(i){throw console.error(`‚ùå Failed to connect to ${t}:`,i),i}})}function on(e){return f(this,arguments,function*(e,t={}){var n,r,i;const s=ze(e),o=null==t?void 0:t.targetUrl,a=en();if("UniSat"===s){const e=Zt("UniSat");if(!0===(null==(r=null==(n=null==e?void 0:e.mobile)?void 0:n.shouldUseMobile)?void 0:r.call(n))&&"function"==typeof(null==(i=null==e?void 0:e.mobile)?void 0:i.startRequest)){Qe=null;const t=t=>e.mobile.startRequest(t,null,12e4);let n=t("connect");return Qe={walletType:"UniSat",deepLink:(null==n?void 0:n.url)||null,nonce:(null==n?void 0:n.nonce)||null,startedAt:Date.now(),provider:e},Promise.resolve(n.promise).catch(r=>{const i=String((null==r?void 0:r.message)||r||"");if(/method\s*\[connect\]\s*not\s*found/i.test(i))return n=t("requestAccounts"),Qe={walletType:"UniSat",deepLink:(null==n?void 0:n.url)||null,nonce:(null==n?void 0:n.nonce)||null,startedAt:Date.now(),provider:e},n.promise;throw r}).then(t=>{t&&t.address&&et({isConnected:!0,walletType:"UniSat",address:t.address,publicKey:t.publicKey||null,provider:e}),Qe=null}).catch(e=>{console.warn("‚ö†Ô∏è UniSat mobile connect failed:",(null==e?void 0:e.message)||e),Qe=null}),{redirected:!0,walletType:"UniSat",deepLink:n.url,nonce:n.nonce}}}if(a)try{return yield sn(e)}catch(l){const e=String((null==l?void 0:l.message)||l||"").toLowerCase();if(e.includes("not installed")||e.includes("not detected")||e.includes("no provider"))return{redirected:!0,walletType:s,deepLink:yield nn(s,o)};throw l}return yield sn(e)})}function an(e){return Ge[e]||null}function ln(){return d({},Ge)}const cn={createProvider:Zt,detectWallets:rn,connect:sn,connectSmart:on,getMobileOpenUrl:tn,openMobileWallet:nn,disconnect:ot,getState:tt,subscribe:nt,getCurrentProvider:rt,getPendingMobile:it,submitUniSatMobileResponse:st,getWalletInfo:an,getAllWalletInfo:ln,loadNormalizers:Ve,loadWalletConnector:je,getBalance:at,getInscriptions:lt,getAllInscriptions:ct,signMessage:ut,signPSBT:pt,signPsbt:dt,signPsbts:ht,sendBitcoin:ft,sendBTC:gt,getNetwork:mt,switchNetwork:yt,getPublicKey:wt,getAddress:bt,getAccounts:vt,pushPsbt:Et,pushTx:St,sendInscription:It,inscribe:Tt,sendRunes:Pt,getWalletFeatures:At,getAddresses:Bt,createRepeatInscriptions:Nt,sendInscriptions:xt,getRunesBalance:_t,transferRunes:Ct,mintRunes:kt,etchRunes:Ot,getRunesOrder:Ut,signMultipleTransactions:Rt,createInscription:Lt,getProductInfo:Ht,getURL:Mt,signStructuredData:Wt,authenticate:qt,sendStacksTransaction:Ft,updateProfile:Kt,isHardware:$t,call:Dt,inscribeTransfer:Xt,splitUtxo:Vt,transferNft:jt,watchAsset:Gt,mint:zt,getCapabilities:Yt,getUtxos:Jt,getBRC20List:Qt,WALLET_INFO:Ge},un=Object.freeze(Object.defineProperty({__proto__:null,authenticate:qt,call:Dt,connect:sn,connectSmart:on,createInscription:Lt,createProvider:Zt,createRepeatInscriptions:Nt,default:cn,detectWallets:rn,disconnect:ot,etchRunes:Ot,getAccounts:vt,getAddress:bt,getAddresses:Bt,getAllInscriptions:ct,getAllWalletInfo:ln,getBRC20List:Qt,getBalance:at,getCapabilities:Yt,getCurrentProvider:rt,getInscriptions:lt,getMobileOpenUrl:tn,getNetwork:mt,getPendingMobile:it,getProductInfo:Ht,getPublicKey:wt,getRunesBalance:_t,getRunesOrder:Ut,getState:tt,getURL:Mt,getUtxos:Jt,getWalletFeatures:At,getWalletInfo:an,inscribe:Tt,inscribeTransfer:Xt,isHardware:$t,loadNormalizers:Ve,loadWalletConnector:je,mint:zt,mintRunes:kt,openMobileWallet:nn,pushPsbt:Et,pushTx:St,sendBTC:gt,sendBitcoin:ft,sendInscription:It,sendInscriptions:xt,sendRunes:Pt,sendStacksTransaction:Ft,signMessage:ut,signMultipleTransactions:Rt,signPSBT:pt,signPsbt:dt,signPsbts:ht,signStructuredData:Wt,splitUtxo:Vt,submitUniSatMobileResponse:st,subscribe:nt,switchNetwork:yt,transferNft:jt,transferRunes:Ct,updateProfile:Kt,watchAsset:Gt},Symbol.toStringTag,{value:"Module"}));function dn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}window.NexusWalletConnect=un,v.createRoot(document.getElementById("root")).render(g.createElement(P,null));var pn={},hn={},fn={};Object.defineProperty(fn,"__esModule",{value:!0}),fn.testnet=fn.regtest=fn.bitcoin=void 0,fn.bitcoin={messagePrefix:"Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},fn.regtest={messagePrefix:"Bitcoin Signed Message:\n",bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},fn.testnet={messagePrefix:"Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239};var gn={},mn={},yn={},wn={};Object.defineProperty(wn,"__esModule",{value:!0}),wn.encode=wn.decode=wn.check=void 0,wn.check=function(e){if(e.length<8)return!1;if(e.length>72)return!1;if(48!==e[0])return!1;if(e[1]!==e.length-2)return!1;if(2!==e[2])return!1;const t=e[3];if(0===t)return!1;if(5+t>=e.length)return!1;if(2!==e[4+t])return!1;const n=e[5+t];return!(0===n||6+t+n!==e.length||128&e[4]||t>1&&0===e[4]&&!(128&e[5])||128&e[t+6]||n>1&&0===e[t+6]&&!(128&e[t+7]))},wn.decode=function(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(48!==e[0])throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(2!==e[2])throw new Error("Expected DER integer");const t=e[3];if(0===t)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(2!==e[4+t])throw new Error("Expected DER integer (2)");const n=e[5+t];if(0===n)throw new Error("S length is zero");if(6+t+n!==e.length)throw new Error("S length is invalid");if(128&e[4])throw new Error("R value is negative");if(t>1&&0===e[4]&&!(128&e[5]))throw new Error("R value excessively padded");if(128&e[t+6])throw new Error("S value is negative");if(n>1&&0===e[t+6]&&!(128&e[t+7]))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}},wn.encode=function(e,t){const n=e.length,r=t.length;if(0===n)throw new Error("R length is zero");if(0===r)throw new Error("S length is zero");if(n>33)throw new Error("R length is too long");if(r>33)throw new Error("S length is too long");if(128&e[0])throw new Error("R value is negative");if(128&t[0])throw new Error("S value is negative");if(n>1&&0===e[0]&&!(128&e[1]))throw new Error("R value excessively padded");if(r>1&&0===t[0]&&!(128&t[1]))throw new Error("S value excessively padded");const i=Buffer.allocUnsafe(6+n+r);return i[0]=48,i[1]=i.length-2,i[2]=2,i[3]=e.length,e.copy(i,4),i[4+n]=2,i[5+n]=t.length,t.copy(i,6+n),i};var bn={};Object.defineProperty(bn,"__esModule",{value:!0}),bn.REVERSE_OPS=bn.OPS=void 0;const vn={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_CHECKLOCKTIMEVERIFY:177,OP_NOP3:178,OP_CHECKSEQUENCEVERIFY:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_CHECKSIGADD:186,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255};bn.OPS=vn;const En={};bn.REVERSE_OPS=En;for(const c of Object.keys(vn))En[vn[c]]=c;var Sn={};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.decode=Sn.encode=Sn.encodingLength=void 0;const In=bn;function Tn(e){return e<In.OPS.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}Sn.encodingLength=Tn,Sn.encode=function(e,t,n){const r=Tn(t);return 1===r?e.writeUInt8(t,n):2===r?(e.writeUInt8(In.OPS.OP_PUSHDATA1,n),e.writeUInt8(t,n+1)):3===r?(e.writeUInt8(In.OPS.OP_PUSHDATA2,n),e.writeUInt16LE(t,n+1)):(e.writeUInt8(In.OPS.OP_PUSHDATA4,n),e.writeUInt32LE(t,n+1)),r},Sn.decode=function(e,t){const n=e.readUInt8(t);let r,i;if(n<In.OPS.OP_PUSHDATA1)r=n,i=1;else if(n===In.OPS.OP_PUSHDATA1){if(t+2>e.length)return null;r=e.readUInt8(t+1),i=2}else if(n===In.OPS.OP_PUSHDATA2){if(t+3>e.length)return null;r=e.readUInt16LE(t+1),i=3}else{if(t+5>e.length)return null;if(n!==In.OPS.OP_PUSHDATA4)throw new Error("Unexpected opcode");r=e.readUInt32LE(t+1),i=5}return{opcode:n,number:r,size:i}};var Pn={};Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.encode=Pn.decode=void 0,Pn.decode=function(e,t,n){t=t||4,n=void 0===n||n;const r=e.length;if(0===r)return 0;if(r>t)throw new TypeError("Script number overflow");if(n&&!(127&e[r-1]||!(r<=1)&&128&e[r-2]))throw new Error("Non-minimally encoded script number");if(5===r){const t=e.readUInt32LE(0),n=e.readUInt8(4);return 128&n?-(4294967296*(-129&n)+t):4294967296*n+t}let i=0;for(let s=0;s<r;++s)i|=e[s]<<8*s;return 128&e[r-1]?-(i&~(128<<8*(r-1))):i},Pn.encode=function(e){let t=Math.abs(e);const n=(r=t)>2147483647?5:r>8388607?4:r>32767?3:r>127?2:r>0?1:0;var r;const i=Buffer.allocUnsafe(n),s=e<0;for(let o=0;o<n;++o)i.writeUInt8(255&t,o),t>>=8;return 128&i[n-1]?i.writeUInt8(s?128:0,n-1):s&&(i[n-1]|=128),i};for(var An={},Bn={},Nn={},xn={byteLength:function(e){var t=Rn(e),n=t[0],r=t[1];return 3*(n+r)/4-r},toByteArray:function(e){var t,n,r=Rn(e),i=r[0],s=r[1],o=new kn(function(e,t,n){return 3*(t+n)/4-n}(0,i,s)),a=0,l=s>0?i-4:i;for(n=0;n<l;n+=4)t=Cn[e.charCodeAt(n)]<<18|Cn[e.charCodeAt(n+1)]<<12|Cn[e.charCodeAt(n+2)]<<6|Cn[e.charCodeAt(n+3)],o[a++]=t>>16&255,o[a++]=t>>8&255,o[a++]=255&t;return 2===s&&(t=Cn[e.charCodeAt(n)]<<2|Cn[e.charCodeAt(n+1)]>>4,o[a++]=255&t),1===s&&(t=Cn[e.charCodeAt(n)]<<10|Cn[e.charCodeAt(n+1)]<<4|Cn[e.charCodeAt(n+2)]>>2,o[a++]=t>>8&255,o[a++]=255&t),o},fromByteArray:function(e){for(var t,n=e.length,r=n%3,i=[],s=16383,o=0,a=n-r;o<a;o+=s)i.push(Hn(e,o,o+s>a?a:o+s));return 1===r?(t=e[n-1],i.push(_n[t>>2]+_n[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(_n[t>>10]+_n[t>>4&63]+_n[t<<2&63]+"=")),i.join("")}},_n=[],Cn=[],kn="undefined"!=typeof Uint8Array?Uint8Array:Array,On="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Un=0;Un<64;++Un)_n[Un]=On[Un],Cn[On.charCodeAt(Un)]=Un;function Rn(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function Ln(e){return _n[e>>18&63]+_n[e>>12&63]+_n[e>>6&63]+_n[63&e]}function Hn(e,t,n){for(var r,i=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(Ln(r));return i.join("")}Cn["-".charCodeAt(0)]=62,Cn["_".charCodeAt(0)]=63;var Mn={read:function(e,t,n,r,i){var s,o,a=8*i-r-1,l=(1<<a)-1,c=l>>1,u=-7,d=n?i-1:0,p=n?-1:1,h=e[t+d];for(d+=p,s=h&(1<<-u)-1,h>>=-u,u+=a;u>0;s=256*s+e[t+d],d+=p,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=r;u>0;o=256*o+e[t+d],d+=p,u-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,r),s-=c}return(h?-1:1)*o*Math.pow(2,s-r)},write:function(e,t,n,r,i,s){var o,a,l,c=8*s-i-1,u=(1<<c)-1,d=u>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:s-1,f=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(o++,l/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(t*l-1)*Math.pow(2,i),o+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[n+h]=255&a,h+=f,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;e[n+h]=255&o,h+=f,o/=256,c-=8);e[n+h-f]|=128*g}};!function(e){const t=xn,n=Mn,r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},e.INSPECT_MAX_BYTES=50;const i=2147483647;function s(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return a(e,t,n)}function a(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!o.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|f(e,t);let r=s(n);const i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(G(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer))return p(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(G(e,SharedArrayBuffer)||e&&G(e.buffer,SharedArrayBuffer)))return p(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return o.from(r,t,n);const i=function(e){if(o.isBuffer(e)){const t=0|h(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||z(e.length)?s(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return l(e),s(e<0?0:0|h(e))}function d(e){const t=e.length<0?0:0|h(e.length),n=s(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function p(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,o.prototype),r}function h(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function f(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return X(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(e).length;default:if(i)return r?-1:X(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return x(this,t,n);case"utf8":case"utf-8":return P(this,t,n);case"ascii":return B(this,t,n);case"latin1":case"binary":return N(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),z(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:w(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):w(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,i){let s,o=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,a/=2,l/=2,n/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let r=-1;for(s=n;s<a;s++)if(c(e,s)===c(t,-1===r?0:s-r)){if(-1===r&&(r=s),s-r+1===l)return r*o}else-1!==r&&(s-=s-r),r=-1}else for(n+l>a&&(n=a-l),s=n;s>=0;s--){let n=!0;for(let r=0;r<l;r++)if(c(e,s+r)!==c(t,r)){n=!1;break}if(n)return s}return-1}function b(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const s=t.length;let o;for(r>s/2&&(r=s/2),o=0;o<r;++o){const r=parseInt(t.substr(2*o,2),16);if(z(r))return o;e[n+o]=r}return o}function v(e,t,n,r){return j(X(t,e.length-n),e,n,r)}function E(e,t,n,r){return j(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function S(e,t,n,r){return j(V(t),e,n,r)}function I(e,t,n,r){return j(function(e,t){let n,r,i;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,i=n%256,s.push(i),s.push(r);return s}(t,e.length-n),e,n,r)}function T(e,n,r){return 0===n&&r===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(n,r))}function P(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=n){let n,r,a,l;switch(o){case 1:t<128&&(s=t);break;case 2:n=e[i+1],128==(192&n)&&(l=(31&t)<<6|63&n,l>127&&(s=l));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(l=(15&t)<<12|(63&n)<<6|63&r,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(l=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,l>65535&&l<1114112&&(s=l))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),i+=o}return function(e){const t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=A));return n}(r)}e.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,n){return a(e,t,n)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,n){return function(e,t,n){return l(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}(e,t,n)},o.allocUnsafe=function(e){return u(e)},o.allocUnsafeSlow=function(e){return u(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(G(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=o.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(G(t,Uint8Array))i+t.length>r.length?(o.isBuffer(t)||(t=o.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!o.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},o.byteLength=f,o.prototype._isBuffer=!0,o.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)m(this,t,t+1);return this},o.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},o.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},o.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?P(this,0,e):g.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){let t="";const n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(e,t,n,r,i){if(G(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let s=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0);const l=Math.min(s,a),c=this.slice(r,i),u=e.slice(t,n);for(let o=0;o<l;++o)if(c[o]!==u[o]){s=c[o],a=u[o];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},o.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let s=!1;for(;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":case"latin1":case"binary":return E(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const A=4096;function B(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function N(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function x(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let s=t;s<n;++s)i+=Y[e[s]];return i}function _(e,t,n){const r=e.slice(t,n);let i="";for(let s=0;s<r.length-1;s+=2)i+=String.fromCharCode(r[s]+256*r[s+1]);return i}function C(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function k(e,t,n,r,i,s){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function O(e,t,n,r,i){F(t,r,i,e,n,7);let s=Number(t&BigInt(4294967295));e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function U(e,t,n,r,i){F(t,r,i,e,n,7);let s=Number(t&BigInt(4294967295));e[n+7]=s,s>>=8,e[n+6]=s,s>>=8,e[n+5]=s,s>>=8,e[n+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function R(e,t,n,r,i,s){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,r,i,s){return t=+t,r>>>=0,s||R(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function H(e,t,r,i,s){return t=+t,r>>>=0,s||R(e,0,r,8),n.write(e,t,r,i,52,8),r+8}o.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,o.prototype),r},o.prototype.readUintLE=o.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);let r=this[e],i=1,s=0;for(;++s<t&&(i*=256);)r+=this[e+s]*i;return r},o.prototype.readUintBE=o.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},o.prototype.readUint8=o.prototype.readUInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),this[e]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readBigUInt64LE=J(function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);const r=t+this[++e]*c(2,8)+this[++e]*c(2,16)+this[++e]*c(2,24),i=this[++e]+this[++e]*c(2,8)+this[++e]*c(2,16)+n*c(2,24);return BigInt(r)+(BigInt(i)<<BigInt(32))}),o.prototype.readBigUInt64BE=J(function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);const r=t*c(2,24)+this[++e]*c(2,16)+this[++e]*c(2,8)+this[++e],i=this[++e]*c(2,24)+this[++e]*c(2,16)+this[++e]*c(2,8)+n;return(BigInt(r)<<BigInt(32))+BigInt(i)}),o.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);let r=this[e],i=1,s=0;for(;++s<t&&(i*=256);)r+=this[e+s]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);let r=t,i=1,s=this[e+--r];for(;r>0&&(i*=256);)s+=this[e+--r]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},o.prototype.readInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||C(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){e>>>=0,t||C(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readBigInt64LE=J(function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);const r=this[e+4]+this[e+5]*c(2,8)+this[e+6]*c(2,16)+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+this[++e]*c(2,8)+this[++e]*c(2,16)+this[++e]*c(2,24))}),o.prototype.readBigInt64BE=J(function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);const r=(t<<24)+this[++e]*c(2,16)+this[++e]*c(2,8)+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*c(2,24)+this[++e]*c(2,16)+this[++e]*c(2,8)+n)}),o.prototype.readFloatLE=function(e,t){return e>>>=0,t||C(e,4,this.length),n.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||C(e,4,this.length),n.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||C(e,8,this.length),n.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||C(e,8,this.length),n.read(this,e,!1,52,8)},o.prototype.writeUintLE=o.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||k(this,e,t,n,Math.pow(2,8*n)-1,0);let i=1,s=0;for(this[t]=255&e;++s<n&&(i*=256);)this[t+s]=e/i&255;return t+n},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||k(this,e,t,n,Math.pow(2,8*n)-1,0);let i=n-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+n},o.prototype.writeUint8=o.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||k(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||k(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||k(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||k(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||k(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeBigUInt64LE=J(function(e,t=0){return O(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=J(function(e,t=0){return U(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);k(this,e,t,n,r-1,-r)}let i=0,s=1,o=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+n},o.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);k(this,e,t,n,r-1,-r)}let i=n-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||k(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||k(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||k(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||k(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeBigInt64LE=J(function(e,t=0){return O(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=J(function(e,t=0){return U(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return H(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return H(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,r){if(!o.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},o.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const s=o.isBuffer(e)?e:o.from(e,r),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=s[i%a]}return this};const M={};function W(e,t,n){M[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function q(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function F(e,t,n,r,i,s){if(e>n||e<t){const n="bigint"==typeof t?"n":"";let r;throw r=0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`,new M.ERR_OUT_OF_RANGE("value",r,e)}!function(e,t,n){K(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||$(t,e.length-(n+1))}(r,i,s)}function K(e,t){if("number"!=typeof e)throw new M.ERR_INVALID_ARG_TYPE(t,"number",e)}function $(e,t,n){if(Math.floor(e)!==e)throw K(e,n),new M.ERR_OUT_OF_RANGE("offset","an integer",e);if(t<0)throw new M.ERR_BUFFER_OUT_OF_BOUNDS;throw new M.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${t}`,e)}W("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),W("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),W("ERR_OUT_OF_RANGE",function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>c(2,32)?i=q(String(n)):"bigint"==typeof n&&(i=String(n),(n>c(BigInt(2),BigInt(32))||n<-c(BigInt(2),BigInt(32)))&&(i=q(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r},RangeError);const D=/[^+/0-9A-Za-z-_]/g;function X(e,t){let n;t=t||1/0;const r=e.length;let i=null;const s=[];for(let o=0;o<r;++o){if(n=e.charCodeAt(o),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function V(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(D,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function j(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function z(e){return e!=e}const Y=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function J(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}}(Nn);var Wn={Array:function(e){return null!=e&&e.constructor===Array},Boolean:function(e){return"boolean"==typeof e},Function:function(e){return"function"==typeof e},Nil:function(e){return null==e},Number:function(e){return"number"==typeof e},Object:function(e){return"object"==typeof e},String:function(e){return"string"==typeof e},"":function(){return!0}};for(var qn in Wn.Null=Wn.Nil,Wn)Wn[qn].toJSON=function(e){return e}.bind(null,qn);var Fn=Wn,Kn=Fn;function $n(e){return e.name||e.toString().match(/function (.*?)\s*\(/)[1]}function Dn(e){return Kn.Nil(e)?"":$n(e.constructor)}function Xn(e,t){Error.captureStackTrace&&Error.captureStackTrace(e,t)}function Vn(e){return Kn.Function(e)?e.toJSON?e.toJSON():$n(e):Kn.Array(e)?"Array":e&&Kn.Object(e)?"Object":void 0!==e?e:""}function jn(e,t,n){var r=function(e){return Kn.Function(e)?"":Kn.String(e)?JSON.stringify(e):e&&Kn.Object(e)?"":e}(t);return"Expected "+Vn(e)+", got"+(""!==n?" "+n:"")+(""!==r?" "+r:"")}function Gn(e,t,n){n=n||Dn(t),this.message=jn(e,t,n),Xn(this,Gn),this.__type=e,this.__value=t,this.__valueTypeName=n}function zn(e,t,n,r,i){e?(i=i||Dn(r),this.message=function(e,t,n,r,i){var s='" of type ';return"key"===t&&(s='" with key type '),jn('property "'+Vn(n)+s+Vn(e),r,i)}(e,n,t,r,i)):this.message='Unexpected property "'+t+'"',Xn(this,Gn),this.__label=n,this.__property=t,this.__type=e,this.__value=r,this.__valueTypeName=i}Gn.prototype=Object.create(Error.prototype),Gn.prototype.constructor=Gn,zn.prototype=Object.create(Error.prototype),zn.prototype.constructor=Gn;var Yn,Jn,Qn={TfTypeError:Gn,TfPropertyTypeError:zn,tfCustomError:function(e,t){return new Gn(e,{},t)},tfSubError:function(e,t,n){return e instanceof zn?(t=t+"."+e.__property,e=new zn(e.__type,t,e.__label,e.__value,e.__valueTypeName)):e instanceof Gn&&(e=new zn(e.__type,t,n,e.__value,e.__valueTypeName)),Xn(e),e},tfJSON:Vn,getValueTypeName:Dn},Zn=Fn,er=Qn.tfJSON,tr=Qn.TfTypeError,nr=Qn.TfPropertyTypeError,rr=Qn.tfSubError,ir=Qn.getValueTypeName,sr={arrayOf:function(e,t){function n(n,r){return!!Zn.Array(n)&&!Zn.Nil(n)&&!(void 0!==t.minLength&&n.length<t.minLength)&&!(void 0!==t.maxLength&&n.length>t.maxLength)&&(void 0===t.length||n.length===t.length)&&n.every(function(t,n){try{return ar(e,t,r)}catch(i){throw rr(i,n)}})}return e=or(e),t=t||{},n.toJSON=function(){var n="["+er(e)+"]";return void 0!==t.length?n+="{"+t.length+"}":void 0===t.minLength&&void 0===t.maxLength||(n+="{"+(void 0===t.minLength?0:t.minLength)+","+(void 0===t.maxLength?1/0:t.maxLength)+"}"),n},n},maybe:function e(t){function n(n,r){return Zn.Nil(n)||t(n,r,e)}return t=or(t),n.toJSON=function(){return"?"+er(t)},n},map:function(e,t){function n(n,r){if(!Zn.Object(n))return!1;if(Zn.Nil(n))return!1;for(var i in n){try{t&&ar(t,i,r)}catch(o){throw rr(o,i,"key")}try{var s=n[i];ar(e,s,r)}catch(o){throw rr(o,i)}}return!0}return e=or(e),t&&(t=or(t)),n.toJSON=t?function(){return"{"+er(t)+": "+er(e)+"}"}:function(){return"{"+er(e)+"}"},n},object:function(e){var t={};for(var n in e)t[n]=or(e[n]);function r(e,n){if(!Zn.Object(e))return!1;if(Zn.Nil(e))return!1;var r;try{for(r in t)ar(t[r],e[r],n)}catch(i){throw rr(i,r)}if(n)for(r in e)if(!t[r])throw new nr(void 0,r);return!0}return r.toJSON=function(){return er(t)},r},anyOf:function(){var e=[].slice.call(arguments).map(or);function t(t,n){return e.some(function(e){try{return ar(e,t,n)}catch(r){return!1}})}return t.toJSON=function(){return e.map(er).join("|")},t},allOf:function(){var e=[].slice.call(arguments).map(or);function t(t,n){return e.every(function(e){try{return ar(e,t,n)}catch(r){return!1}})}return t.toJSON=function(){return e.map(er).join(" & ")},t},quacksLike:function(e){function t(t){return e===ir(t)}return t.toJSON=function(){return e},t},tuple:function(){var e=[].slice.call(arguments).map(or);function t(t,n){return!Zn.Nil(t)&&!Zn.Nil(t.length)&&(!n||t.length===e.length)&&e.every(function(e,r){try{return ar(e,t[r],n)}catch(i){throw rr(i,r)}})}return t.toJSON=function(){return"("+e.map(er).join(", ")+")"},t},value:function(e){function t(t){return t===e}return t.toJSON=function(){return e},t}};function or(e){if(Zn.String(e))return"?"===e[0]?sr.maybe(e.slice(1)):Zn[e]||sr.quacksLike(e);if(e&&Zn.Object(e)){if(Zn.Array(e)){if(1!==e.length)throw new TypeError("Expected compile() parameter of type Array of length 1");return sr.arrayOf(e[0])}return sr.object(e)}return Zn.Function(e)?e:sr.value(e)}function ar(e,t,n,r){if(Zn.Function(e)){if(e(t,n))return!0;throw new tr(r||e,t)}return ar(or(e),t,n)}for(var lr in sr.oneOf=sr.anyOf,Zn)ar[lr]=Zn[lr];for(lr in sr)ar[lr]=sr[lr];var cr=function(){if(Jn)return Yn;Jn=1;var e=Fn,t=Qn;function n(e){return Buffer.isBuffer(e)}function r(e){return"string"==typeof e&&/^([0-9a-f]{2})+$/i.test(e)}function i(e,n){var r=e.toJSON();function i(i){if(!e(i))return!1;if(i.length===n)return!0;throw t.tfCustomError(r+"(Length: "+n+")",r+"(Length: "+i.length+")")}return i.toJSON=function(){return r},i}var s=i.bind(null,e.Array),o=i.bind(null,n),a=i.bind(null,r),l=i.bind(null,e.String),c=Math.pow(2,53)-1,u={ArrayN:s,Buffer:n,BufferN:o,Finite:function(e){return"number"==typeof e&&isFinite(e)},Hex:r,HexN:a,Int8:function(e){return e<<24>>24===e},Int16:function(e){return e<<16>>16===e},Int32:function(e){return(0|e)===e},Int53:function(e){return"number"==typeof e&&e>=-c&&e<=c&&Math.floor(e)===e},Range:function(t,n,r){function i(e,i){return r(e,i)&&e>t&&e<n}return r=r||e.Number,i.toJSON=function(){return`${r.toJSON()} between [${t}, ${n}]`},i},StringN:l,UInt8:function(e){return(255&e)===e},UInt16:function(e){return(65535&e)===e},UInt32:function(e){return e>>>0===e},UInt53:function(e){return"number"==typeof e&&e>=0&&e<=c&&Math.floor(e)===e}};for(var d in u)u[d].toJSON=function(e){return e}.bind(null,d);return Yn=u}();for(lr in cr)ar[lr]=cr[lr];ar.compile=or,ar.TfTypeError=tr,ar.TfPropertyTypeError=nr;var ur,dr,pr=ar;function hr(){return dr||(dr=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.signature=e.number=e.isCanonicalScriptSignature=e.isDefinedHashType=e.isCanonicalPubKey=e.toStack=e.fromASM=e.toASM=e.decompile=e.compile=e.countNonPushOnlyOPs=e.isPushOnly=e.OPS=void 0;const t=wn,n=bn;Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return n.OPS}});const r=Sn,i=Pn,s=function(){if(ur)return An;ur=1,Object.defineProperty(An,"__esModule",{value:!0}),An.encode=An.decode=void 0;const e=wn,t=hr(),n=Bn,{typeforce:r}=n,i=Buffer.alloc(1,0);function s(e){let t=0;for(;0===e[t];)++t;return t===e.length?i:128&(e=e.slice(t))[0]?Buffer.concat([i,e],1+e.length):e}function o(e){0===e[0]&&(e=e.slice(1));const t=Buffer.alloc(32,0),n=Math.max(0,32-e.length);return e.copy(t,n),t}return An.decode=function(n){const r=n.readUInt8(n.length-1);if(!(0,t.isDefinedHashType)(r))throw new Error("Invalid hashType "+r);const i=e.decode(n.slice(0,-1)),s=o(i.r),a=o(i.s);return{signature:Buffer.concat([s,a],64),hashType:r}},An.encode=function(i,o){if(r({signature:n.BufferN(64),hashType:n.UInt8},{signature:i,hashType:o}),!(0,t.isDefinedHashType)(o))throw new Error("Invalid hashType "+o);const a=Buffer.allocUnsafe(1);a.writeUInt8(o,0);const l=s(i.slice(0,32)),c=s(i.slice(32,64));return Buffer.concat([e.encode(l,c),a])},An}(),o=Bn,{typeforce:a}=o,l=n.OPS.OP_RESERVED;function c(e){return o.Buffer(e)||function(e){return o.Number(e)&&(e===n.OPS.OP_0||e>=n.OPS.OP_1&&e<=n.OPS.OP_16||e===n.OPS.OP_1NEGATE)}(e)}function u(e){return o.Array(e)&&e.every(c)}function d(e){return 0===e.length?n.OPS.OP_0:1===e.length?e[0]>=1&&e[0]<=16?l+e[0]:129===e[0]?n.OPS.OP_1NEGATE:void 0:void 0}function p(e){return Buffer.isBuffer(e)}function h(e){return Buffer.isBuffer(e)}function f(e){if(p(e))return e;a(o.Array,e);const t=e.reduce((e,t)=>h(t)?1===t.length&&void 0!==d(t)?e+1:e+r.encodingLength(t.length)+t.length:e+1,0),n=Buffer.allocUnsafe(t);let i=0;if(e.forEach(e=>{if(h(e)){const t=d(e);if(void 0!==t)return n.writeUInt8(t,i),void(i+=1);i+=r.encode(n,e.length,i),e.copy(n,i),i+=e.length}else n.writeUInt8(e,i),i+=1}),i!==n.length)throw new Error("Could not decode chunks");return n}function g(e){if(t=e,o.Array(t))return e;var t;a(o.Buffer,e);const i=[];let s=0;for(;s<e.length;){const t=e[s];if(t>n.OPS.OP_0&&t<=n.OPS.OP_PUSHDATA4){const t=r.decode(e,s);if(null===t)return null;if(s+=t.size,s+t.number>e.length)return null;const n=e.slice(s,s+t.number);s+=t.number;const o=d(n);void 0!==o?i.push(o):i.push(n)}else i.push(t),s+=1}return i}function m(e){const t=-129&e;return t>0&&t<4}e.isPushOnly=u,e.countNonPushOnlyOPs=function(e){return e.length-e.filter(c).length},e.compile=f,e.decompile=g,e.toASM=function(e){if(p(e)&&(e=g(e)),!e)throw new Error("Could not convert invalid chunks to ASM");return e.map(e=>{if(h(e)){const t=d(e);if(void 0===t)return e.toString("hex");e=t}return n.REVERSE_OPS[e]}).join(" ")},e.fromASM=function(e){return a(o.String,e),f(e.split(" ").map(e=>void 0!==n.OPS[e]?n.OPS[e]:(a(o.Hex,e),Buffer.from(e,"hex"))))},e.toStack=function(e){return e=g(e),a(u,e),e.map(e=>h(e)?e:e===n.OPS.OP_0?Buffer.allocUnsafe(0):i.encode(e-l))},e.isCanonicalPubKey=function(e){return o.isPoint(e)},e.isDefinedHashType=m,e.isCanonicalScriptSignature=function(e){return!!Buffer.isBuffer(e)&&!!m(e[e.length-1])&&t.check(e.slice(0,-1))},e.number=i,e.signature=s}(yn)),yn}!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.oneOf=e.Null=e.BufferN=e.Function=e.UInt32=e.UInt8=e.tuple=e.maybe=e.Hex=e.Buffer=e.String=e.Boolean=e.Array=e.Number=e.Hash256bit=e.Hash160bit=e.Buffer256bit=e.isTaptree=e.isTapleaf=e.TAPLEAF_VERSION_MASK=e.Satoshi=e.isPoint=e.stacksEqual=e.typeforce=void 0;const t=Nn;e.typeforce=pr;const n=t.Buffer.alloc(32,0),r=t.Buffer.from("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f","hex");function i(n){return!(!n||!("output"in n)||!t.Buffer.isBuffer(n.output)||void 0!==n.version&&(n.version&e.TAPLEAF_VERSION_MASK)!==n.version)}e.stacksEqual=function(e,t){return e.length===t.length&&e.every((e,n)=>e.equals(t[n]))},e.isPoint=function(e){if(!t.Buffer.isBuffer(e))return!1;if(e.length<33)return!1;const i=e[0],s=e.slice(1,33);if(0===s.compare(n))return!1;if(s.compare(r)>=0)return!1;if((2===i||3===i)&&33===e.length)return!0;const o=e.slice(33);return 0!==o.compare(n)&&!(o.compare(r)>=0)&&4===i&&65===e.length},e.Satoshi=function(t){return e.typeforce.UInt53(t)&&t<=21e14},e.TAPLEAF_VERSION_MASK=254,e.isTapleaf=i,e.isTaptree=function t(n){return(0,e.Array)(n)?2===n.length&&n.every(e=>t(e)):i(n)},e.Buffer256bit=e.typeforce.BufferN(32),e.Hash160bit=e.typeforce.BufferN(20),e.Hash256bit=e.typeforce.BufferN(32),e.Number=e.typeforce.Number,e.Array=e.typeforce.Array,e.Boolean=e.typeforce.Boolean,e.String=e.typeforce.String,e.Buffer=e.typeforce.Buffer,e.Hex=e.typeforce.Hex,e.maybe=e.typeforce.maybe,e.tuple=e.typeforce.tuple,e.UInt8=e.typeforce.UInt8,e.UInt32=e.typeforce.UInt32,e.Function=e.typeforce.Function,e.BufferN=e.typeforce.BufferN,e.Null=e.typeforce.Null,e.oneOf=e.typeforce.oneOf}(Bn);var fr={};Object.defineProperty(fr,"__esModule",{value:!0}),fr.value=fr.prop=void 0,fr.prop=function(e,t,n){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){const e=n.call(this);return this[t]=e,e},set(e){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:e,writable:!0})}})},fr.value=function(e){let t;return()=>(void 0!==t||(t=e()),t)},Object.defineProperty(mn,"__esModule",{value:!0}),mn.p2data=void 0;const gr=fn,mr=hr(),yr=Bn,wr=fr,br=mr.OPS;mn.p2data=function(e,t){if(!e.data&&!e.output)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,yr.typeforce)({network:yr.typeforce.maybe(yr.typeforce.Object),output:yr.typeforce.maybe(yr.typeforce.Buffer),data:yr.typeforce.maybe(yr.typeforce.arrayOf(yr.typeforce.Buffer))},e);const n={name:"embed",network:e.network||gr.bitcoin};if(wr.prop(n,"output",()=>{if(e.data)return mr.compile([br.OP_RETURN].concat(e.data))}),wr.prop(n,"data",()=>{if(e.output)return mr.decompile(e.output).slice(1)}),t.validate&&e.output){const t=mr.decompile(e.output);if(t[0]!==br.OP_RETURN)throw new TypeError("Output is invalid");if(!t.slice(1).every(yr.typeforce.Buffer))throw new TypeError("Output is invalid");if(e.data&&!(0,yr.stacksEqual)(e.data,n.data))throw new TypeError("Data mismatch")}return Object.assign(n,e)};var vr={};Object.defineProperty(vr,"__esModule",{value:!0}),vr.p2ms=void 0;const Er=fn,Sr=hr(),Ir=Bn,Tr=fr,Pr=Sr.OPS,Ar=Pr.OP_RESERVED;vr.p2ms=function(e,t){if(!(e.input||e.output||e.pubkeys&&void 0!==e.m||e.signatures))throw new TypeError("Not enough data");function n(e){return Sr.isCanonicalScriptSignature(e)||void 0!==(t.allowIncomplete&&e===Pr.OP_0)}t=Object.assign({validate:!0},t||{}),(0,Ir.typeforce)({network:Ir.typeforce.maybe(Ir.typeforce.Object),m:Ir.typeforce.maybe(Ir.typeforce.Number),n:Ir.typeforce.maybe(Ir.typeforce.Number),output:Ir.typeforce.maybe(Ir.typeforce.Buffer),pubkeys:Ir.typeforce.maybe(Ir.typeforce.arrayOf(Ir.isPoint)),signatures:Ir.typeforce.maybe(Ir.typeforce.arrayOf(n)),input:Ir.typeforce.maybe(Ir.typeforce.Buffer)},e);const r={network:e.network||Er.bitcoin};let i=[],s=!1;function o(e){s||(s=!0,i=Sr.decompile(e),r.m=i[0]-Ar,r.n=i[i.length-2]-Ar,r.pubkeys=i.slice(1,-2))}if(Tr.prop(r,"output",()=>{if(e.m&&r.n&&e.pubkeys)return Sr.compile([].concat(Ar+e.m,e.pubkeys,Ar+r.n,Pr.OP_CHECKMULTISIG))}),Tr.prop(r,"m",()=>{if(r.output)return o(r.output),r.m}),Tr.prop(r,"n",()=>{if(r.pubkeys)return r.pubkeys.length}),Tr.prop(r,"pubkeys",()=>{if(e.output)return o(e.output),r.pubkeys}),Tr.prop(r,"signatures",()=>{if(e.input)return Sr.decompile(e.input).slice(1)}),Tr.prop(r,"input",()=>{if(e.signatures)return Sr.compile([Pr.OP_0].concat(e.signatures))}),Tr.prop(r,"witness",()=>{if(r.input)return[]}),Tr.prop(r,"name",()=>{if(r.m&&r.n)return`p2ms(${r.m} of ${r.n})`}),t.validate){if(e.output){if(o(e.output),!Ir.typeforce.Number(i[0]))throw new TypeError("Output is invalid");if(!Ir.typeforce.Number(i[i.length-2]))throw new TypeError("Output is invalid");if(i[i.length-1]!==Pr.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");if(r.m<=0||r.n>16||r.m>r.n||r.n!==i.length-3)throw new TypeError("Output is invalid");if(!r.pubkeys.every(e=>(0,Ir.isPoint)(e)))throw new TypeError("Output is invalid");if(void 0!==e.m&&e.m!==r.m)throw new TypeError("m mismatch");if(void 0!==e.n&&e.n!==r.n)throw new TypeError("n mismatch");if(e.pubkeys&&!(0,Ir.stacksEqual)(e.pubkeys,r.pubkeys))throw new TypeError("Pubkeys mismatch")}if(e.pubkeys){if(void 0!==e.n&&e.n!==e.pubkeys.length)throw new TypeError("Pubkey count mismatch");if(r.n=e.pubkeys.length,r.n<r.m)throw new TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<r.m)throw new TypeError("Not enough signatures provided");if(e.signatures.length>r.m)throw new TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==Pr.OP_0)throw new TypeError("Input is invalid");if(0===r.signatures.length||!r.signatures.every(n))throw new TypeError("Input has invalid signature(s)");if(e.signatures&&!(0,Ir.stacksEqual)(e.signatures,r.signatures))throw new TypeError("Signature mismatch");if(void 0!==e.m&&e.m!==e.signatures.length)throw new TypeError("Signature count mismatch")}}return Object.assign(r,e)};var Br={};Object.defineProperty(Br,"__esModule",{value:!0}),Br.p2pk=void 0;const Nr=fn,xr=hr(),_r=Bn,Cr=fr,kr=xr.OPS;Br.p2pk=function(e,t){if(!(e.input||e.output||e.pubkey||e.input||e.signature))throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,_r.typeforce)({network:_r.typeforce.maybe(_r.typeforce.Object),output:_r.typeforce.maybe(_r.typeforce.Buffer),pubkey:_r.typeforce.maybe(_r.isPoint),signature:_r.typeforce.maybe(xr.isCanonicalScriptSignature),input:_r.typeforce.maybe(_r.typeforce.Buffer)},e);const n=Cr.value(()=>xr.decompile(e.input)),r={name:"p2pk",network:e.network||Nr.bitcoin};if(Cr.prop(r,"output",()=>{if(e.pubkey)return xr.compile([e.pubkey,kr.OP_CHECKSIG])}),Cr.prop(r,"pubkey",()=>{if(e.output)return e.output.slice(1,-1)}),Cr.prop(r,"signature",()=>{if(e.input)return n()[0]}),Cr.prop(r,"input",()=>{if(e.signature)return xr.compile([e.signature])}),Cr.prop(r,"witness",()=>{if(r.input)return[]}),t.validate){if(e.output){if(e.output[e.output.length-1]!==kr.OP_CHECKSIG)throw new TypeError("Output is invalid");if(!(0,_r.isPoint)(r.pubkey))throw new TypeError("Output pubkey is invalid");if(e.pubkey&&!e.pubkey.equals(r.pubkey))throw new TypeError("Pubkey mismatch")}if(e.signature&&e.input&&!e.input.equals(r.input))throw new TypeError("Signature mismatch");if(e.input){if(1!==n().length)throw new TypeError("Input is invalid");if(!xr.isCanonicalScriptSignature(r.signature))throw new TypeError("Input has invalid signature")}}return Object.assign(r,e)};var Or={},Ur={},Rr={},Lr={},Hr={},Mr={},Wr={};Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.crypto=void 0,Wr.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.wrapXOFConstructorWithOpts=e.wrapConstructorWithOpts=e.wrapConstructor=e.Hash=e.nextTick=e.swap32IfBE=e.byteSwapIfBE=e.swap8IfBE=e.isLE=void 0,e.isBytes=n,e.anumber=r,e.abytes=i,e.ahash=function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");r(e.outputLen),r(e.blockLen)},e.aexists=function(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")},e.aoutput=function(e,t){i(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)},e.u8=function(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},e.u32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))},e.clean=function(...e){for(let t=0;t<e.length;t++)e[t].fill(0)},e.createView=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)},e.rotr=function(e,t){return e<<32-t|e>>>t},e.rotl=function(e,t){return e<<t|e>>>32-t>>>0},e.byteSwap=s,e.byteSwap32=o,e.bytesToHex=function(e){if(i(e),a)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=l[e[n]];return t},e.hexToBytes=function(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(a)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let i=0,s=0;i<n;i++,s+=2){const t=u(e.charCodeAt(s)),n=u(e.charCodeAt(s+1));if(void 0===t||void 0===n){const t=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+s)}r[i]=16*t+n}return r},e.asyncLoop=function(t,n,r){return f(this,null,function*(){let i=Date.now();for(let s=0;s<t;s++){r(s);const t=Date.now()-i;t>=0&&t<n||(yield(0,e.nextTick)(),i+=t)}})},e.utf8ToBytes=d,e.bytesToUtf8=function(e){return(new TextDecoder).decode(e)},e.toBytes=p,e.kdfInputToBytes=function(e){return"string"==typeof e&&(e=d(e)),i(e),e},e.concatBytes=function(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];i(n),t+=n.length}const n=new Uint8Array(t);for(let r=0,i=0;r<e.length;r++){const t=e[r];n.set(t,i),i+=t.length}return n},e.checkOpts=function(e,t){if(void 0!==t&&"[object Object]"!=={}.toString.call(t))throw new Error("options should be object or undefined");return Object.assign(e,t)},e.createHasher=h,e.createOptHasher=g,e.createXOFer=m,e.randomBytes=function(e=32){if(t.crypto&&"function"==typeof t.crypto.getRandomValues)return t.crypto.getRandomValues(new Uint8Array(e));if(t.crypto&&"function"==typeof t.crypto.randomBytes)return Uint8Array.from(t.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")};const t=Wr;function n(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function r(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function i(e,...t){if(!n(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function s(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function o(e){for(let t=0;t<e.length;t++)e[t]=s(e[t]);return e}e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],e.swap8IfBE=e.isLE?e=>e:e=>s(e),e.byteSwapIfBE=e.swap8IfBE,e.swap32IfBE=e.isLE?e=>e:o;const a=(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)(),l=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0")),c={_0:48,_9:57,A:65,F:70,a:97,f:102};function u(e){return e>=c._0&&e<=c._9?e-c._0:e>=c.A&&e<=c.F?e-(c.A-10):e>=c.a&&e<=c.f?e-(c.a-10):void 0}function d(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}function p(e){return"string"==typeof e&&(e=d(e)),i(e),e}function h(e){const t=t=>e().update(p(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function g(e){const t=(t,n)=>e(n).update(p(t)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=t=>e(t),t}function m(e){const t=(t,n)=>e(n).update(p(t)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=t=>e(t),t}e.nextTick=()=>f(this,null,function*(){}),e.Hash=class{},e.wrapConstructor=h,e.wrapConstructorWithOpts=g,e.wrapXOFConstructorWithOpts=m}(Mr),Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.SHA512_IV=Hr.SHA384_IV=Hr.SHA224_IV=Hr.SHA256_IV=Hr.HashMD=void 0,Hr.setBigUint64=Fr,Hr.Chi=function(e,t,n){return e&t^~e&n},Hr.Maj=function(e,t,n){return e&t^e&n^t&n};const qr=Mr;function Fr(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),l=r?4:0,c=r?0:4;e.setUint32(t+l,o,r),e.setUint32(t+c,a,r)}Hr.HashMD=class extends qr.Hash{constructor(e,t,n,r){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.buffer=new Uint8Array(e),this.view=(0,qr.createView)(this.buffer)}update(e){(0,qr.aexists)(this),e=(0,qr.toBytes)(e),(0,qr.abytes)(e);const{view:t,buffer:n,blockLen:r}=this,i=e.length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);if(o===r){const t=(0,qr.createView)(e);for(;r<=i-s;s+=r)this.process(t,s);continue}n.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===r&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,qr.aexists)(this),(0,qr.aoutput)(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:s}=this;t[s++]=128,(0,qr.clean)(this.buffer.subarray(s)),this.padOffset>r-s&&(this.process(n,0),s=0);for(let u=s;u<r;u++)t[u]=0;Fr(n,r-8,BigInt(8*this.length),i),this.process(n,0);const o=(0,qr.createView)(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=a/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)o.setUint32(4*u,c[u],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:s,pos:o}=this;return e.destroyed=s,e.finished=i,e.length=r,e.pos=o,r%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}},Hr.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Hr.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),Hr.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Hr.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.ripemd160=Lr.RIPEMD160=Lr.md5=Lr.MD5=Lr.sha1=Lr.SHA1=void 0;const Kr=Hr,$r=Mr,Dr=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),Xr=new Uint32Array(80);class Vr extends Kr.HashMD{constructor(){super(64,20,8,!1),this.A=0|Dr[0],this.B=0|Dr[1],this.C=0|Dr[2],this.D=0|Dr[3],this.E=0|Dr[4]}get(){const{A:e,B:t,C:n,D:r,E:i}=this;return[e,t,n,r,i]}set(e,t,n,r,i){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i}process(e,t){for(let a=0;a<16;a++,t+=4)Xr[a]=e.getUint32(t,!1);for(let a=16;a<80;a++)Xr[a]=(0,$r.rotl)(Xr[a-3]^Xr[a-8]^Xr[a-14]^Xr[a-16],1);let{A:n,B:r,C:i,D:s,E:o}=this;for(let a=0;a<80;a++){let e,t;a<20?(e=(0,Kr.Chi)(r,i,s),t=1518500249):a<40?(e=r^i^s,t=1859775393):a<60?(e=(0,Kr.Maj)(r,i,s),t=2400959708):(e=r^i^s,t=3395469782);const l=(0,$r.rotl)(n,5)+e+o+t+Xr[a]|0;o=s,s=i,i=(0,$r.rotl)(r,30),r=n,n=l}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,s=s+this.D|0,o=o+this.E|0,this.set(n,r,i,s,o)}roundClean(){(0,$r.clean)(Xr)}destroy(){this.set(0,0,0,0,0),(0,$r.clean)(this.buffer)}}Lr.SHA1=Vr,Lr.sha1=(0,$r.createHasher)(()=>new Vr);const jr=Math.pow(2,32),Gr=Array.from({length:64},(e,t)=>Math.floor(jr*Math.abs(Math.sin(t+1)))),zr=Dr.slice(0,4),Yr=new Uint32Array(16);class Jr extends Kr.HashMD{constructor(){super(64,16,8,!0),this.A=0|zr[0],this.B=0|zr[1],this.C=0|zr[2],this.D=0|zr[3]}get(){const{A:e,B:t,C:n,D:r}=this;return[e,t,n,r]}set(e,t,n,r){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r}process(e,t){for(let o=0;o<16;o++,t+=4)Yr[o]=e.getUint32(t,!0);let{A:n,B:r,C:i,D:s}=this;for(let o=0;o<64;o++){let e,t,a;o<16?(e=(0,Kr.Chi)(r,i,s),t=o,a=[7,12,17,22]):o<32?(e=(0,Kr.Chi)(s,r,i),t=(5*o+1)%16,a=[5,9,14,20]):o<48?(e=r^i^s,t=(3*o+5)%16,a=[4,11,16,23]):(e=i^(r|~s),t=7*o%16,a=[6,10,15,21]),e=e+n+Gr[o]+Yr[t],n=s,s=i,i=r,r+=(0,$r.rotl)(e,a[o%4])}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,s=s+this.D|0,this.set(n,r,i,s)}roundClean(){(0,$r.clean)(Yr)}destroy(){this.set(0,0,0,0),(0,$r.clean)(this.buffer)}}Lr.MD5=Jr,Lr.md5=(0,$r.createHasher)(()=>new Jr);const Qr=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Zr=(()=>Uint8Array.from(new Array(16).fill(0).map((e,t)=>t)))(),ei=(()=>Zr.map(e=>(9*e+5)%16))(),ti=(()=>{const e=[[Zr],[ei]];for(let t=0;t<4;t++)for(let n of e)n.push(n[t].map(e=>Qr[e]));return e})(),ni=(()=>ti[0])(),ri=(()=>ti[1])(),ii=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),si=ni.map((e,t)=>e.map(e=>ii[t][e])),oi=ri.map((e,t)=>e.map(e=>ii[t][e])),ai=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),li=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function ci(e,t,n,r){return 0===e?t^n^r:1===e?t&n|~t&r:2===e?(t|~n)^r:3===e?t&r|n&~r:t^(n|~r)}const ui=new Uint32Array(16);class di extends Kr.HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:t,h2:n,h3:r,h4:i}=this;return[e,t,n,r,i]}set(e,t,n,r,i){this.h0=0|e,this.h1=0|t,this.h2=0|n,this.h3=0|r,this.h4=0|i}process(e,t){for(let p=0;p<16;p++,t+=4)ui[p]=e.getUint32(t,!0);let n=0|this.h0,r=n,i=0|this.h1,s=i,o=0|this.h2,a=o,l=0|this.h3,c=l,u=0|this.h4,d=u;for(let p=0;p<5;p++){const e=4-p,t=ai[p],h=li[p],f=ni[p],g=ri[p],m=si[p],y=oi[p];for(let r=0;r<16;r++){const e=(0,$r.rotl)(n+ci(p,i,o,l)+ui[f[r]]+t,m[r])+u|0;n=u,u=l,l=0|(0,$r.rotl)(o,10),o=i,i=e}for(let n=0;n<16;n++){const t=(0,$r.rotl)(r+ci(e,s,a,c)+ui[g[n]]+h,y[n])+d|0;r=d,d=c,c=0|(0,$r.rotl)(a,10),a=s,s=t}}this.set(this.h1+o+c|0,this.h2+l+d|0,this.h3+u+r|0,this.h4+n+s|0,this.h0+i+a|0)}roundClean(){(0,$r.clean)(ui)}destroy(){this.destroyed=!0,(0,$r.clean)(this.buffer),this.set(0,0,0,0,0)}}Lr.RIPEMD160=di,Lr.ripemd160=(0,$r.createHasher)(()=>new di),Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.ripemd160=Rr.RIPEMD160=void 0;const pi=Lr;Rr.RIPEMD160=pi.RIPEMD160,Rr.ripemd160=pi.ripemd160;var hi={};Object.defineProperty(hi,"__esModule",{value:!0}),hi.sha1=hi.SHA1=void 0;const fi=Lr;hi.SHA1=fi.SHA1,hi.sha1=fi.sha1;var gi={},mi={},yi={};Object.defineProperty(yi,"__esModule",{value:!0}),yi.toBig=yi.shrSL=yi.shrSH=yi.rotrSL=yi.rotrSH=yi.rotrBL=yi.rotrBH=yi.rotr32L=yi.rotr32H=yi.rotlSL=yi.rotlSH=yi.rotlBL=yi.rotlBH=yi.add5L=yi.add5H=yi.add4L=yi.add4H=yi.add3L=yi.add3H=void 0,yi.add=Ri,yi.fromBig=vi,yi.split=Ei;const wi=BigInt(c(2,32)-1),bi=BigInt(32);function vi(e,t=!1){return t?{h:Number(e&wi),l:Number(e>>bi&wi)}:{h:0|Number(e>>bi&wi),l:0|Number(e&wi)}}function Ei(e,t=!1){const n=e.length;let r=new Uint32Array(n),i=new Uint32Array(n);for(let s=0;s<n;s++){const{h:n,l:o}=vi(e[s],t);[r[s],i[s]]=[n,o]}return[r,i]}const Si=(e,t)=>BigInt(e>>>0)<<bi|BigInt(t>>>0);yi.toBig=Si;const Ii=(e,t,n)=>e>>>n;yi.shrSH=Ii;const Ti=(e,t,n)=>e<<32-n|t>>>n;yi.shrSL=Ti;const Pi=(e,t,n)=>e>>>n|t<<32-n;yi.rotrSH=Pi;const Ai=(e,t,n)=>e<<32-n|t>>>n;yi.rotrSL=Ai;const Bi=(e,t,n)=>e<<64-n|t>>>n-32;yi.rotrBH=Bi;const Ni=(e,t,n)=>e>>>n-32|t<<64-n;yi.rotrBL=Ni;const xi=(e,t)=>t;yi.rotr32H=xi;const _i=(e,t)=>e;yi.rotr32L=_i;const Ci=(e,t,n)=>e<<n|t>>>32-n;yi.rotlSH=Ci;const ki=(e,t,n)=>t<<n|e>>>32-n;yi.rotlSL=ki;const Oi=(e,t,n)=>t<<n-32|e>>>64-n;yi.rotlBH=Oi;const Ui=(e,t,n)=>e<<n-32|t>>>64-n;function Ri(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/c(2,32)|0)|0,l:0|i}}yi.rotlBL=Ui;const Li=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0);yi.add3L=Li;const Hi=(e,t,n,r)=>t+n+r+(e/c(2,32)|0)|0;yi.add3H=Hi;const Mi=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0);yi.add4L=Mi;const Wi=(e,t,n,r,i)=>t+n+r+i+(e/c(2,32)|0)|0;yi.add4H=Wi;const qi=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0);yi.add5L=qi;const Fi=(e,t,n,r,i,s)=>t+n+r+i+s+(e/c(2,32)|0)|0;yi.add5H=Fi;const Ki={fromBig:vi,split:Ei,toBig:Si,shrSH:Ii,shrSL:Ti,rotrSH:Pi,rotrSL:Ai,rotrBH:Bi,rotrBL:Ni,rotr32H:xi,rotr32L:_i,rotlSH:Ci,rotlSL:ki,rotlBH:Oi,rotlBL:Ui,add:Ri,add3L:Li,add3H:Hi,add4L:Mi,add4H:Wi,add5H:Fi,add5L:qi};yi.default=Ki,Object.defineProperty(mi,"__esModule",{value:!0}),mi.sha512_224=mi.sha512_256=mi.sha384=mi.sha512=mi.sha224=mi.sha256=mi.SHA512_256=mi.SHA512_224=mi.SHA384=mi.SHA512=mi.SHA224=mi.SHA256=void 0;const $i=Hr,Di=yi,Xi=Mr,Vi=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ji=new Uint32Array(64);class Gi extends $i.HashMD{constructor(e=32){super(64,e,8,!1),this.A=0|$i.SHA256_IV[0],this.B=0|$i.SHA256_IV[1],this.C=0|$i.SHA256_IV[2],this.D=0|$i.SHA256_IV[3],this.E=0|$i.SHA256_IV[4],this.F=0|$i.SHA256_IV[5],this.G=0|$i.SHA256_IV[6],this.H=0|$i.SHA256_IV[7]}get(){const{A:e,B:t,C:n,D:r,E:i,F:s,G:o,H:a}=this;return[e,t,n,r,i,s,o,a]}set(e,t,n,r,i,s,o,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(e,t){for(let u=0;u<16;u++,t+=4)ji[u]=e.getUint32(t,!1);for(let u=16;u<64;u++){const e=ji[u-15],t=ji[u-2],n=(0,Xi.rotr)(e,7)^(0,Xi.rotr)(e,18)^e>>>3,r=(0,Xi.rotr)(t,17)^(0,Xi.rotr)(t,19)^t>>>10;ji[u]=r+ji[u-7]+n+ji[u-16]|0}let{A:n,B:r,C:i,D:s,E:o,F:a,G:l,H:c}=this;for(let u=0;u<64;u++){const e=c+((0,Xi.rotr)(o,6)^(0,Xi.rotr)(o,11)^(0,Xi.rotr)(o,25))+(0,$i.Chi)(o,a,l)+Vi[u]+ji[u]|0,t=((0,Xi.rotr)(n,2)^(0,Xi.rotr)(n,13)^(0,Xi.rotr)(n,22))+(0,$i.Maj)(n,r,i)|0;c=l,l=a,a=o,o=s+e|0,s=i,i=r,r=n,n=e+t|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,s=s+this.D|0,o=o+this.E|0,a=a+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(n,r,i,s,o,a,l,c)}roundClean(){(0,Xi.clean)(ji)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,Xi.clean)(this.buffer)}}mi.SHA256=Gi;class zi extends Gi{constructor(){super(28),this.A=0|$i.SHA224_IV[0],this.B=0|$i.SHA224_IV[1],this.C=0|$i.SHA224_IV[2],this.D=0|$i.SHA224_IV[3],this.E=0|$i.SHA224_IV[4],this.F=0|$i.SHA224_IV[5],this.G=0|$i.SHA224_IV[6],this.H=0|$i.SHA224_IV[7]}}mi.SHA224=zi;const Yi=(()=>Di.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),Ji=(()=>Yi[0])(),Qi=(()=>Yi[1])(),Zi=new Uint32Array(80),es=new Uint32Array(80);class ts extends $i.HashMD{constructor(e=64){super(128,e,16,!1),this.Ah=0|$i.SHA512_IV[0],this.Al=0|$i.SHA512_IV[1],this.Bh=0|$i.SHA512_IV[2],this.Bl=0|$i.SHA512_IV[3],this.Ch=0|$i.SHA512_IV[4],this.Cl=0|$i.SHA512_IV[5],this.Dh=0|$i.SHA512_IV[6],this.Dl=0|$i.SHA512_IV[7],this.Eh=0|$i.SHA512_IV[8],this.El=0|$i.SHA512_IV[9],this.Fh=0|$i.SHA512_IV[10],this.Fl=0|$i.SHA512_IV[11],this.Gh=0|$i.SHA512_IV[12],this.Gl=0|$i.SHA512_IV[13],this.Hh=0|$i.SHA512_IV[14],this.Hl=0|$i.SHA512_IV[15]}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:i,Cl:s,Dh:o,Dl:a,Eh:l,El:c,Fh:u,Fl:d,Gh:p,Gl:h,Hh:f,Hl:g}=this;return[e,t,n,r,i,s,o,a,l,c,u,d,p,h,f,g]}set(e,t,n,r,i,s,o,a,l,c,u,d,p,h,f,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|l,this.El=0|c,this.Fh=0|u,this.Fl=0|d,this.Gh=0|p,this.Gl=0|h,this.Hh=0|f,this.Hl=0|g}process(e,t){for(let w=0;w<16;w++,t+=4)Zi[w]=e.getUint32(t),es[w]=e.getUint32(t+=4);for(let w=16;w<80;w++){const e=0|Zi[w-15],t=0|es[w-15],n=Di.rotrSH(e,t,1)^Di.rotrSH(e,t,8)^Di.shrSH(e,t,7),r=Di.rotrSL(e,t,1)^Di.rotrSL(e,t,8)^Di.shrSL(e,t,7),i=0|Zi[w-2],s=0|es[w-2],o=Di.rotrSH(i,s,19)^Di.rotrBH(i,s,61)^Di.shrSH(i,s,6),a=Di.rotrSL(i,s,19)^Di.rotrBL(i,s,61)^Di.shrSL(i,s,6),l=Di.add4L(r,a,es[w-7],es[w-16]),c=Di.add4H(l,n,o,Zi[w-7],Zi[w-16]);Zi[w]=0|c,es[w]=0|l}let{Ah:n,Al:r,Bh:i,Bl:s,Ch:o,Cl:a,Dh:l,Dl:c,Eh:u,El:d,Fh:p,Fl:h,Gh:f,Gl:g,Hh:m,Hl:y}=this;for(let w=0;w<80;w++){const e=Di.rotrSH(u,d,14)^Di.rotrSH(u,d,18)^Di.rotrBH(u,d,41),t=Di.rotrSL(u,d,14)^Di.rotrSL(u,d,18)^Di.rotrBL(u,d,41),b=u&p^~u&f,v=d&h^~d&g,E=Di.add5L(y,t,v,Qi[w],es[w]),S=Di.add5H(E,m,e,b,Ji[w],Zi[w]),I=0|E,T=Di.rotrSH(n,r,28)^Di.rotrBH(n,r,34)^Di.rotrBH(n,r,39),P=Di.rotrSL(n,r,28)^Di.rotrBL(n,r,34)^Di.rotrBL(n,r,39),A=n&i^n&o^i&o,B=r&s^r&a^s&a;m=0|f,y=0|g,f=0|p,g=0|h,p=0|u,h=0|d,({h:u,l:d}=Di.add(0|l,0|c,0|S,0|I)),l=0|o,c=0|a,o=0|i,a=0|s,i=0|n,s=0|r;const N=Di.add3L(I,P,B);n=Di.add3H(N,S,T,A),r=0|N}({h:n,l:r}=Di.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:s}=Di.add(0|this.Bh,0|this.Bl,0|i,0|s)),({h:o,l:a}=Di.add(0|this.Ch,0|this.Cl,0|o,0|a)),({h:l,l:c}=Di.add(0|this.Dh,0|this.Dl,0|l,0|c)),({h:u,l:d}=Di.add(0|this.Eh,0|this.El,0|u,0|d)),({h:p,l:h}=Di.add(0|this.Fh,0|this.Fl,0|p,0|h)),({h:f,l:g}=Di.add(0|this.Gh,0|this.Gl,0|f,0|g)),({h:m,l:y}=Di.add(0|this.Hh,0|this.Hl,0|m,0|y)),this.set(n,r,i,s,o,a,l,c,u,d,p,h,f,g,m,y)}roundClean(){(0,Xi.clean)(Zi,es)}destroy(){(0,Xi.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}mi.SHA512=ts;class ns extends ts{constructor(){super(48),this.Ah=0|$i.SHA384_IV[0],this.Al=0|$i.SHA384_IV[1],this.Bh=0|$i.SHA384_IV[2],this.Bl=0|$i.SHA384_IV[3],this.Ch=0|$i.SHA384_IV[4],this.Cl=0|$i.SHA384_IV[5],this.Dh=0|$i.SHA384_IV[6],this.Dl=0|$i.SHA384_IV[7],this.Eh=0|$i.SHA384_IV[8],this.El=0|$i.SHA384_IV[9],this.Fh=0|$i.SHA384_IV[10],this.Fl=0|$i.SHA384_IV[11],this.Gh=0|$i.SHA384_IV[12],this.Gl=0|$i.SHA384_IV[13],this.Hh=0|$i.SHA384_IV[14],this.Hl=0|$i.SHA384_IV[15]}}mi.SHA384=ns;const rs=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),is=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class ss extends ts{constructor(){super(28),this.Ah=0|rs[0],this.Al=0|rs[1],this.Bh=0|rs[2],this.Bl=0|rs[3],this.Ch=0|rs[4],this.Cl=0|rs[5],this.Dh=0|rs[6],this.Dl=0|rs[7],this.Eh=0|rs[8],this.El=0|rs[9],this.Fh=0|rs[10],this.Fl=0|rs[11],this.Gh=0|rs[12],this.Gl=0|rs[13],this.Hh=0|rs[14],this.Hl=0|rs[15]}}mi.SHA512_224=ss;class os extends ts{constructor(){super(32),this.Ah=0|is[0],this.Al=0|is[1],this.Bh=0|is[2],this.Bl=0|is[3],this.Ch=0|is[4],this.Cl=0|is[5],this.Dh=0|is[6],this.Dl=0|is[7],this.Eh=0|is[8],this.El=0|is[9],this.Fh=0|is[10],this.Fl=0|is[11],this.Gh=0|is[12],this.Gl=0|is[13],this.Hh=0|is[14],this.Hl=0|is[15]}}mi.SHA512_256=os,mi.sha256=(0,Xi.createHasher)(()=>new Gi),mi.sha224=(0,Xi.createHasher)(()=>new zi),mi.sha512=(0,Xi.createHasher)(()=>new ts),mi.sha384=(0,Xi.createHasher)(()=>new ns),mi.sha512_256=(0,Xi.createHasher)(()=>new os),mi.sha512_224=(0,Xi.createHasher)(()=>new ss),Object.defineProperty(gi,"__esModule",{value:!0}),gi.sha224=gi.SHA224=gi.sha256=gi.SHA256=void 0;const as=mi;gi.SHA256=as.SHA256,gi.sha256=as.sha256,gi.SHA224=as.SHA224,gi.sha224=as.sha224,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.taggedHash=e.TAGGED_HASH_PREFIXES=e.TAGS=e.hash256=e.hash160=e.sha256=e.sha1=e.ripemd160=void 0;const t=Rr,n=hi,r=gi;function i(e){return Buffer.from((0,r.sha256)(Uint8Array.from(e)))}e.ripemd160=function(e){return Buffer.from((0,t.ripemd160)(Uint8Array.from(e)))},e.sha1=function(e){return Buffer.from((0,n.sha1)(Uint8Array.from(e)))},e.sha256=i,e.hash160=function(e){return Buffer.from((0,t.ripemd160)((0,r.sha256)(Uint8Array.from(e))))},e.hash256=function(e){return Buffer.from((0,r.sha256)((0,r.sha256)(Uint8Array.from(e))))},e.TAGS=["BIP0340/challenge","BIP0340/aux","BIP0340/nonce","TapLeaf","TapBranch","TapSighash","TapTweak","KeyAgg list","KeyAgg coefficient"],e.TAGGED_HASH_PREFIXES={"BIP0340/challenge":Buffer.from([123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124,123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124]),"BIP0340/aux":Buffer.from([241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144,241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144]),"BIP0340/nonce":Buffer.from([7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47,7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47]),TapLeaf:Buffer.from([174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238,174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238]),TapBranch:Buffer.from([25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21,25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21]),TapSighash:Buffer.from([244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49,244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49]),TapTweak:Buffer.from([232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233,232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233]),"KeyAgg list":Buffer.from([72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240,72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240]),"KeyAgg coefficient":Buffer.from([191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129,191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129])},e.taggedHash=function(t,n){return i(Buffer.concat([e.TAGGED_HASH_PREFIXES[t],n]))}}(Ur);var ls=function(e){for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<58;r++){var i=e.charAt(r),s=i.charCodeAt(0);if(255!==t[s])throw new TypeError(i+" is ambiguous");t[s]=r}var o=e.charAt(0),a=Math.log(58)/Math.log(256),l=Math.log(256)/Math.log(58);function c(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;for(var n=0,r=0,i=0;e[n]===o;)r++,n++;for(var s=(e.length-n)*a+1>>>0,l=new Uint8Array(s);e[n];){var c=e.charCodeAt(n);if(c>255)return;var u=t[c];if(255===u)return;for(var d=0,p=s-1;(0!==u||d<i)&&-1!==p;p--,d++)u+=58*l[p]>>>0,l[p]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=d,n++}for(var h=s-i;h!==s&&0===l[h];)h++;for(var f=new Uint8Array(r+(s-h)),g=r;h!==s;)f[g++]=l[h++];return f}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,s=t.length;i!==s&&0===t[i];)i++,n++;for(var a=(s-i)*l+1>>>0,c=new Uint8Array(a);i!==s;){for(var u=t[i],d=0,p=a-1;(0!==u||d<r)&&-1!==p;p--,d++)u+=256*c[p]>>>0,c[p]=u%58>>>0,u=u/58>>>0;if(0!==u)throw new Error("Non-zero carry");r=d,i++}for(var h=a-r;h!==a&&0===c[h];)h++;for(var f=o.repeat(n);h<a;++h)f+=e.charAt(c[h]);return f},decodeUnsafe:c,decode:function(e){var t=c(e);if(t)return t;throw new Error("Non-base58 character")}}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),{sha256:cs}=gi,us=function(e){function t(t){var n=t.slice(0,-4),r=t.slice(-4),i=e(n);if(!(r[0]^i[0]|r[1]^i[1]|r[2]^i[2]|r[3]^i[3]))return n}return{encode:function(t){var n=Uint8Array.from(t),r=e(n),i=n.length+4,s=new Uint8Array(i);return s.set(n,0),s.set(r.subarray(0,4),n.length),ls.encode(s,i)},decode:function(e){var n=t(ls.decode(e));if(!n)throw new Error("Invalid checksum");return n},decodeUnsafe:function(e){var n=ls.decodeUnsafe(e);if(n)return t(n)}}}(function(e){return cs(cs(e))});Object.defineProperty(Or,"__esModule",{value:!0}),Or.p2pkh=void 0;const ds=Ur,ps=fn,hs=hr(),fs=Bn,gs=fr,ms=us,ys=hs.OPS;Or.p2pkh=function(e,t){if(!(e.address||e.hash||e.output||e.pubkey||e.input))throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,fs.typeforce)({network:fs.typeforce.maybe(fs.typeforce.Object),address:fs.typeforce.maybe(fs.typeforce.String),hash:fs.typeforce.maybe(fs.typeforce.BufferN(20)),output:fs.typeforce.maybe(fs.typeforce.BufferN(25)),pubkey:fs.typeforce.maybe(fs.isPoint),signature:fs.typeforce.maybe(hs.isCanonicalScriptSignature),input:fs.typeforce.maybe(fs.typeforce.Buffer)},e);const n=gs.value(()=>{const t=Buffer.from(ms.decode(e.address));return{version:t.readUInt8(0),hash:t.slice(1)}}),r=gs.value(()=>hs.decompile(e.input)),i=e.network||ps.bitcoin,s={name:"p2pkh",network:i};if(gs.prop(s,"address",()=>{if(!s.hash)return;const e=Buffer.allocUnsafe(21);return e.writeUInt8(i.pubKeyHash,0),s.hash.copy(e,1),ms.encode(e)}),gs.prop(s,"hash",()=>e.output?e.output.slice(3,23):e.address?n().hash:e.pubkey||s.pubkey?ds.hash160(e.pubkey||s.pubkey):void 0),gs.prop(s,"output",()=>{if(s.hash)return hs.compile([ys.OP_DUP,ys.OP_HASH160,s.hash,ys.OP_EQUALVERIFY,ys.OP_CHECKSIG])}),gs.prop(s,"pubkey",()=>{if(e.input)return r()[1]}),gs.prop(s,"signature",()=>{if(e.input)return r()[0]}),gs.prop(s,"input",()=>{if(e.pubkey&&e.signature)return hs.compile([e.signature,e.pubkey])}),gs.prop(s,"witness",()=>{if(s.input)return[]}),t.validate){let t=Buffer.from([]);if(e.address){if(n().version!==i.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(20!==n().hash.length)throw new TypeError("Invalid address");t=n().hash}if(e.hash){if(t.length>0&&!t.equals(e.hash))throw new TypeError("Hash mismatch");t=e.hash}if(e.output){if(25!==e.output.length||e.output[0]!==ys.OP_DUP||e.output[1]!==ys.OP_HASH160||20!==e.output[2]||e.output[23]!==ys.OP_EQUALVERIFY||e.output[24]!==ys.OP_CHECKSIG)throw new TypeError("Output is invalid");const n=e.output.slice(3,23);if(t.length>0&&!t.equals(n))throw new TypeError("Hash mismatch");t=n}if(e.pubkey){const n=ds.hash160(e.pubkey);if(t.length>0&&!t.equals(n))throw new TypeError("Hash mismatch");t=n}if(e.input){const n=r();if(2!==n.length)throw new TypeError("Input is invalid");if(!hs.isCanonicalScriptSignature(n[0]))throw new TypeError("Input has invalid signature");if(!(0,fs.isPoint)(n[1]))throw new TypeError("Input has invalid pubkey");if(e.signature&&!e.signature.equals(n[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(n[1]))throw new TypeError("Pubkey mismatch");const i=ds.hash160(n[1]);if(t.length>0&&!t.equals(i))throw new TypeError("Hash mismatch")}}return Object.assign(s,e)};var ws={};Object.defineProperty(ws,"__esModule",{value:!0}),ws.p2sh=void 0;const bs=Ur,vs=fn,Es=hr(),Ss=Bn,Is=fr,Ts=us,Ps=Es.OPS;ws.p2sh=function(e,t){if(!(e.address||e.hash||e.output||e.redeem||e.input))throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,Ss.typeforce)({network:Ss.typeforce.maybe(Ss.typeforce.Object),address:Ss.typeforce.maybe(Ss.typeforce.String),hash:Ss.typeforce.maybe(Ss.typeforce.BufferN(20)),output:Ss.typeforce.maybe(Ss.typeforce.BufferN(23)),redeem:Ss.typeforce.maybe({network:Ss.typeforce.maybe(Ss.typeforce.Object),output:Ss.typeforce.maybe(Ss.typeforce.Buffer),input:Ss.typeforce.maybe(Ss.typeforce.Buffer),witness:Ss.typeforce.maybe(Ss.typeforce.arrayOf(Ss.typeforce.Buffer))}),input:Ss.typeforce.maybe(Ss.typeforce.Buffer),witness:Ss.typeforce.maybe(Ss.typeforce.arrayOf(Ss.typeforce.Buffer))},e);let n=e.network;n||(n=e.redeem&&e.redeem.network||vs.bitcoin);const r={network:n},i=Is.value(()=>{const t=Buffer.from(Ts.decode(e.address));return{version:t.readUInt8(0),hash:t.slice(1)}}),s=Is.value(()=>Es.decompile(e.input)),o=Is.value(()=>{const t=s(),r=t[t.length-1];return{network:n,output:r===Ps.OP_FALSE?Buffer.from([]):r,input:Es.compile(t.slice(0,-1)),witness:e.witness||[]}});if(Is.prop(r,"address",()=>{if(!r.hash)return;const e=Buffer.allocUnsafe(21);return e.writeUInt8(r.network.scriptHash,0),r.hash.copy(e,1),Ts.encode(e)}),Is.prop(r,"hash",()=>e.output?e.output.slice(2,22):e.address?i().hash:r.redeem&&r.redeem.output?bs.hash160(r.redeem.output):void 0),Is.prop(r,"output",()=>{if(r.hash)return Es.compile([Ps.OP_HASH160,r.hash,Ps.OP_EQUAL])}),Is.prop(r,"redeem",()=>{if(e.input)return o()}),Is.prop(r,"input",()=>{if(e.redeem&&e.redeem.input&&e.redeem.output)return Es.compile([].concat(Es.decompile(e.redeem.input),e.redeem.output))}),Is.prop(r,"witness",()=>r.redeem&&r.redeem.witness?r.redeem.witness:r.input?[]:void 0),Is.prop(r,"name",()=>{const e=["p2sh"];return void 0!==r.redeem&&void 0!==r.redeem.name&&e.push(r.redeem.name),e.join("-")}),t.validate){let t=Buffer.from([]);if(e.address){if(i().version!==n.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(20!==i().hash.length)throw new TypeError("Invalid address");t=i().hash}if(e.hash){if(t.length>0&&!t.equals(e.hash))throw new TypeError("Hash mismatch");t=e.hash}if(e.output){if(23!==e.output.length||e.output[0]!==Ps.OP_HASH160||20!==e.output[1]||e.output[22]!==Ps.OP_EQUAL)throw new TypeError("Output is invalid");const n=e.output.slice(2,22);if(t.length>0&&!t.equals(n))throw new TypeError("Hash mismatch");t=n}const r=e=>{if(e.output){const n=Es.decompile(e.output);if(!n||n.length<1)throw new TypeError("Redeem.output too short");if(e.output.byteLength>520)throw new TypeError("Redeem.output unspendable if larger than 520 bytes");if(Es.countNonPushOnlyOPs(n)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const r=bs.hash160(e.output);if(t.length>0&&!t.equals(r))throw new TypeError("Hash mismatch");t=r}if(e.input){const t=e.input.length>0,n=e.witness&&e.witness.length>0;if(!t&&!n)throw new TypeError("Empty input");if(t&&n)throw new TypeError("Input and witness provided");if(t){const t=Es.decompile(e.input);if(!Es.isPushOnly(t))throw new TypeError("Non push-only scriptSig")}}};if(e.input){const e=s();if(!e||e.length<1)throw new TypeError("Input too short");if(!Buffer.isBuffer(o().output))throw new TypeError("Input is invalid");r(o())}if(e.redeem){if(e.redeem.network&&e.redeem.network!==n)throw new TypeError("Network mismatch");if(e.input){const t=o();if(e.redeem.output&&!e.redeem.output.equals(t.output))throw new TypeError("Redeem.output mismatch");if(e.redeem.input&&!e.redeem.input.equals(t.input))throw new TypeError("Redeem.input mismatch")}r(e.redeem)}if(e.witness&&e.redeem&&e.redeem.witness&&!(0,Ss.stacksEqual)(e.redeem.witness,e.witness))throw new TypeError("Witness and redeem.witness mismatch")}return Object.assign(r,e)};var As={},Bs={};Object.defineProperty(Bs,"__esModule",{value:!0}),Bs.bech32m=Bs.bech32=void 0;const Ns="qpzry9x8gf2tvdw0s3jn54khce6mua7l",xs={};for(let c=0;c<32;c++){const e=Ns.charAt(c);xs[e]=c}function _s(e){const t=e>>25;return(33554431&e)<<5^996825010&-(1&t)^642813549&-(t>>1&1)^513874426&-(t>>2&1)^1027748829&-(t>>3&1)^705979059&-(t>>4&1)}function Cs(e){let t=1;for(let n=0;n<e.length;++n){const r=e.charCodeAt(n);if(r<33||r>126)return"Invalid prefix ("+e+")";t=_s(t)^r>>5}t=_s(t);for(let n=0;n<e.length;++n){const r=e.charCodeAt(n);t=_s(t)^31&r}return t}function ks(e,t,n,r){let i=0,s=0;const o=(1<<n)-1,a=[];for(let l=0;l<e.length;++l)for(i=i<<t|e[l],s+=t;s>=n;)s-=n,a.push(i>>s&o);if(r)s>0&&a.push(i<<n-s&o);else{if(s>=t)return"Excess padding";if(i<<n-s&o)return"Non-zero padding"}return a}function Os(e){return ks(e,8,5,!0)}function Us(e){const t=ks(e,5,8,!1);if(Array.isArray(t))return t}function Rs(e){const t=ks(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}function Ls(e){let t;function n(e,n){if(n=n||90,e.length<8)return e+" too short";if(e.length>n)return"Exceeds length limit";const r=e.toLowerCase(),i=e.toUpperCase();if(e!==r&&e!==i)return"Mixed-case string "+e;const s=(e=r).lastIndexOf("1");if(-1===s)return"No separator character for "+e;if(0===s)return"Missing prefix for "+e;const o=e.slice(0,s),a=e.slice(s+1);if(a.length<6)return"Data too short";let l=Cs(o);if("string"==typeof l)return l;const c=[];for(let t=0;t<a.length;++t){const e=a.charAt(t),n=xs[e];if(void 0===n)return"Unknown character "+e;l=_s(l)^n,t+6>=a.length||c.push(n)}return l!==t?"Invalid checksum for "+e:{prefix:o,words:c}}return t="bech32"===e?1:734539939,{decodeUnsafe:function(e,t){const r=n(e,t);if("object"==typeof r)return r},decode:function(e,t){const r=n(e,t);if("object"==typeof r)return r;throw new Error(r)},encode:function(e,n,r){if(r=r||90,e.length+7+n.length>r)throw new TypeError("Exceeds length limit");let i=Cs(e=e.toLowerCase());if("string"==typeof i)throw new Error(i);let s=e+"1";for(let t=0;t<n.length;++t){const e=n[t];if(e>>5)throw new Error("Non 5-bit word");i=_s(i)^e,s+=Ns.charAt(e)}for(let t=0;t<6;++t)i=_s(i);i^=t;for(let t=0;t<6;++t)s+=Ns.charAt(i>>5*(5-t)&31);return s},toWords:Os,fromWordsUnsafe:Us,fromWords:Rs}}Bs.bech32=Ls("bech32"),Bs.bech32m=Ls("bech32m"),Object.defineProperty(As,"__esModule",{value:!0}),As.p2wpkh=void 0;const Hs=Ur,Ms=fn,Ws=hr(),qs=Bn,Fs=fr,Ks=Bs,$s=Ws.OPS,Ds=Buffer.alloc(0);As.p2wpkh=function(e,t){if(!(e.address||e.hash||e.output||e.pubkey||e.witness))throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,qs.typeforce)({address:qs.typeforce.maybe(qs.typeforce.String),hash:qs.typeforce.maybe(qs.typeforce.BufferN(20)),input:qs.typeforce.maybe(qs.typeforce.BufferN(0)),network:qs.typeforce.maybe(qs.typeforce.Object),output:qs.typeforce.maybe(qs.typeforce.BufferN(22)),pubkey:qs.typeforce.maybe(qs.isPoint),signature:qs.typeforce.maybe(Ws.isCanonicalScriptSignature),witness:qs.typeforce.maybe(qs.typeforce.arrayOf(qs.typeforce.Buffer))},e);const n=Fs.value(()=>{const t=Ks.bech32.decode(e.address),n=t.words.shift(),r=Ks.bech32.fromWords(t.words);return{version:n,prefix:t.prefix,data:Buffer.from(r)}}),r=e.network||Ms.bitcoin,i={name:"p2wpkh",network:r};if(Fs.prop(i,"address",()=>{if(!i.hash)return;const e=Ks.bech32.toWords(i.hash);return e.unshift(0),Ks.bech32.encode(r.bech32,e)}),Fs.prop(i,"hash",()=>e.output?e.output.slice(2,22):e.address?n().data:e.pubkey||i.pubkey?Hs.hash160(e.pubkey||i.pubkey):void 0),Fs.prop(i,"output",()=>{if(i.hash)return Ws.compile([$s.OP_0,i.hash])}),Fs.prop(i,"pubkey",()=>e.pubkey?e.pubkey:e.witness?e.witness[1]:void 0),Fs.prop(i,"signature",()=>{if(e.witness)return e.witness[0]}),Fs.prop(i,"input",()=>{if(i.witness)return Ds}),Fs.prop(i,"witness",()=>{if(e.pubkey&&e.signature)return[e.signature,e.pubkey]}),t.validate){let t=Buffer.from([]);if(e.address){if(r&&r.bech32!==n().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(0!==n().version)throw new TypeError("Invalid address version");if(20!==n().data.length)throw new TypeError("Invalid address data");t=n().data}if(e.hash){if(t.length>0&&!t.equals(e.hash))throw new TypeError("Hash mismatch");t=e.hash}if(e.output){if(22!==e.output.length||e.output[0]!==$s.OP_0||20!==e.output[1])throw new TypeError("Output is invalid");if(t.length>0&&!t.equals(e.output.slice(2)))throw new TypeError("Hash mismatch");t=e.output.slice(2)}if(e.pubkey){const n=Hs.hash160(e.pubkey);if(t.length>0&&!t.equals(n))throw new TypeError("Hash mismatch");if(t=n,!(0,qs.isPoint)(e.pubkey)||33!==e.pubkey.length)throw new TypeError("Invalid pubkey for p2wpkh")}if(e.witness){if(2!==e.witness.length)throw new TypeError("Witness is invalid");if(!Ws.isCanonicalScriptSignature(e.witness[0]))throw new TypeError("Witness has invalid signature");if(!(0,qs.isPoint)(e.witness[1])||33!==e.witness[1].length)throw new TypeError("Witness has invalid pubkey");if(e.signature&&!e.signature.equals(e.witness[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(e.witness[1]))throw new TypeError("Pubkey mismatch");const n=Hs.hash160(e.witness[1]);if(t.length>0&&!t.equals(n))throw new TypeError("Hash mismatch")}}return Object.assign(i,e)};var Xs={};Object.defineProperty(Xs,"__esModule",{value:!0}),Xs.p2wsh=void 0;const Vs=Ur,js=fn,Gs=hr(),zs=Bn,Ys=fr,Js=Bs,Qs=Gs.OPS,Zs=Buffer.alloc(0);function eo(e){return!(!Buffer.isBuffer(e)||65!==e.length||4!==e[0]||!(0,zs.isPoint)(e))}Xs.p2wsh=function(e,t){if(!(e.address||e.hash||e.output||e.redeem||e.witness))throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,zs.typeforce)({network:zs.typeforce.maybe(zs.typeforce.Object),address:zs.typeforce.maybe(zs.typeforce.String),hash:zs.typeforce.maybe(zs.typeforce.BufferN(32)),output:zs.typeforce.maybe(zs.typeforce.BufferN(34)),redeem:zs.typeforce.maybe({input:zs.typeforce.maybe(zs.typeforce.Buffer),network:zs.typeforce.maybe(zs.typeforce.Object),output:zs.typeforce.maybe(zs.typeforce.Buffer),witness:zs.typeforce.maybe(zs.typeforce.arrayOf(zs.typeforce.Buffer))}),input:zs.typeforce.maybe(zs.typeforce.BufferN(0)),witness:zs.typeforce.maybe(zs.typeforce.arrayOf(zs.typeforce.Buffer))},e);const n=Ys.value(()=>{const t=Js.bech32.decode(e.address),n=t.words.shift(),r=Js.bech32.fromWords(t.words);return{version:n,prefix:t.prefix,data:Buffer.from(r)}}),r=Ys.value(()=>Gs.decompile(e.redeem.input));let i=e.network;i||(i=e.redeem&&e.redeem.network||js.bitcoin);const s={network:i};if(Ys.prop(s,"address",()=>{if(!s.hash)return;const e=Js.bech32.toWords(s.hash);return e.unshift(0),Js.bech32.encode(i.bech32,e)}),Ys.prop(s,"hash",()=>e.output?e.output.slice(2):e.address?n().data:s.redeem&&s.redeem.output?Vs.sha256(s.redeem.output):void 0),Ys.prop(s,"output",()=>{if(s.hash)return Gs.compile([Qs.OP_0,s.hash])}),Ys.prop(s,"redeem",()=>{if(e.witness)return{output:e.witness[e.witness.length-1],input:Zs,witness:e.witness.slice(0,-1)}}),Ys.prop(s,"input",()=>{if(s.witness)return Zs}),Ys.prop(s,"witness",()=>{if(e.redeem&&e.redeem.input&&e.redeem.input.length>0&&e.redeem.output&&e.redeem.output.length>0){const t=Gs.toStack(r());return s.redeem=Object.assign({witness:t},e.redeem),s.redeem.input=Zs,[].concat(t,e.redeem.output)}if(e.redeem&&e.redeem.output&&e.redeem.witness)return[].concat(e.redeem.witness,e.redeem.output)}),Ys.prop(s,"name",()=>{const e=["p2wsh"];return void 0!==s.redeem&&void 0!==s.redeem.name&&e.push(s.redeem.name),e.join("-")}),t.validate){let t=Buffer.from([]);if(e.address){if(n().prefix!==i.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(0!==n().version)throw new TypeError("Invalid address version");if(32!==n().data.length)throw new TypeError("Invalid address data");t=n().data}if(e.hash){if(t.length>0&&!t.equals(e.hash))throw new TypeError("Hash mismatch");t=e.hash}if(e.output){if(34!==e.output.length||e.output[0]!==Qs.OP_0||32!==e.output[1])throw new TypeError("Output is invalid");const n=e.output.slice(2);if(t.length>0&&!t.equals(n))throw new TypeError("Hash mismatch");t=n}if(e.redeem){if(e.redeem.network&&e.redeem.network!==i)throw new TypeError("Network mismatch");if(e.redeem.input&&e.redeem.input.length>0&&e.redeem.witness&&e.redeem.witness.length>0)throw new TypeError("Ambiguous witness source");if(e.redeem.output){const n=Gs.decompile(e.redeem.output);if(!n||n.length<1)throw new TypeError("Redeem.output is invalid");if(e.redeem.output.byteLength>3600)throw new TypeError("Redeem.output unspendable if larger than 3600 bytes");if(Gs.countNonPushOnlyOPs(n)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const r=Vs.sha256(e.redeem.output);if(t.length>0&&!t.equals(r))throw new TypeError("Hash mismatch");t=r}if(e.redeem.input&&!Gs.isPushOnly(r()))throw new TypeError("Non push-only scriptSig");if(e.witness&&e.redeem.witness&&!(0,zs.stacksEqual)(e.witness,e.redeem.witness))throw new TypeError("Witness and redeem.witness mismatch");if(e.redeem.input&&r().some(eo)||e.redeem.output&&(Gs.decompile(e.redeem.output)||[]).some(eo))throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(e.witness&&e.witness.length>0){const t=e.witness[e.witness.length-1];if(e.redeem&&e.redeem.output&&!e.redeem.output.equals(t))throw new TypeError("Witness and redeem.output mismatch");if(e.witness.some(eo)||(Gs.decompile(t)||[]).some(eo))throw new TypeError("Witness contains uncompressed pubkey")}}return Object.assign(s,e)};var to={},no={};Object.defineProperty(no,"__esModule",{value:!0}),no.getEccLib=no.initEccLib=void 0;const ro={};no.initEccLib=function(e,t){var n;e?e!==ro.eccLib&&((null==t?void 0:t.DANGER_DO_NOT_VERIFY_ECCLIB)||(so("function"==typeof(n=e).isXOnlyPoint),so(n.isXOnlyPoint(io("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),so(n.isXOnlyPoint(io("fffffffffffffffffffffffffffffffffffffffffffffffffffffffeeffffc2e"))),so(n.isXOnlyPoint(io("f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9"))),so(n.isXOnlyPoint(io("0000000000000000000000000000000000000000000000000000000000000001"))),so(!n.isXOnlyPoint(io("0000000000000000000000000000000000000000000000000000000000000000"))),so(!n.isXOnlyPoint(io("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"))),so("function"==typeof n.xOnlyPointAddTweak),oo.forEach(e=>{const t=n.xOnlyPointAddTweak(io(e.pubkey),io(e.tweak));null===e.result?so(null===t):(so(null!==t),so(t.parity===e.parity),so(Buffer.from(t.xOnlyPubkey).equals(io(e.result))))})),ro.eccLib=e):ro.eccLib=e},no.getEccLib=function(){if(!ro.eccLib)throw new Error("No ECC Library provided. You must call initEccLib() with a valid TinySecp256k1Interface instance");return ro.eccLib};const io=e=>Buffer.from(e,"hex");function so(e){if(!e)throw new Error("ecc library invalid")}const oo=[{pubkey:"79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798",tweak:"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140",parity:-1,result:null},{pubkey:"1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b",tweak:"a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac",parity:1,result:"e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"},{pubkey:"2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991",tweak:"823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47",parity:0,result:"9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"}];var ao={},lo={},co={exports:{}};!function(e,t){var n=Nn,r=n.Buffer;function i(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(i(n,t),t.Buffer=s),s.prototype=Object.create(r.prototype),i(r,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}}(co,co.exports);var uo=co.exports.Buffer;function po(e){if(e<0||e>9007199254740991||e%1!=0)throw new RangeError("value out of range")}function ho(e){return po(e),e<253?1:e<=65535?3:e<=4294967295?5:9}var fo={encode:function e(t,n,r){if(po(t),n||(n=uo.allocUnsafe(ho(t))),!uo.isBuffer(n))throw new TypeError("buffer must be a Buffer instance");return r||(r=0),t<253?(n.writeUInt8(t,r),e.bytes=1):t<=65535?(n.writeUInt8(253,r),n.writeUInt16LE(t,r+1),e.bytes=3):t<=4294967295?(n.writeUInt8(254,r),n.writeUInt32LE(t,r+1),e.bytes=5):(n.writeUInt8(255,r),n.writeUInt32LE(t>>>0,r+1),n.writeUInt32LE(t/4294967296|0,r+5),e.bytes=9),n},decode:function e(t,n){if(!uo.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");n||(n=0);var r=t.readUInt8(n);if(r<253)return e.bytes=1,r;if(253===r)return e.bytes=3,t.readUInt16LE(n+1);if(254===r)return e.bytes=5,t.readUInt32LE(n+1);e.bytes=9;var i=t.readUInt32LE(n+1),s=4294967296*t.readUInt32LE(n+5)+i;return po(s),s},encodingLength:ho};Object.defineProperty(lo,"__esModule",{value:!0}),lo.BufferReader=lo.BufferWriter=lo.cloneBuffer=lo.reverseBuffer=lo.writeUInt64LE=lo.readUInt64LE=lo.varuint=void 0;const go=Bn,{typeforce:mo}=go,yo=fo;function wo(e,t){if("number"!=typeof e)throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function bo(e,t){const n=e.readUInt32LE(t);let r=e.readUInt32LE(t+4);return r*=4294967296,wo(r+n,9007199254740991),r+n}function vo(e,t,n){return wo(t,9007199254740991),e.writeInt32LE(-1&t,n),e.writeUInt32LE(Math.floor(t/4294967296),n+4),n+8}lo.varuint=yo,lo.readUInt64LE=bo,lo.writeUInt64LE=vo,lo.reverseBuffer=function(e){if(e.length<1)return e;let t=e.length-1,n=0;for(let r=0;r<e.length/2;r++)n=e[r],e[r]=e[t],e[t]=n,t--;return e},lo.cloneBuffer=function(e){const t=Buffer.allocUnsafe(e.length);return e.copy(t),t};class Eo{static withCapacity(e){return new Eo(Buffer.alloc(e))}constructor(e,t=0){this.buffer=e,this.offset=t,mo(go.tuple(go.Buffer,go.UInt32),[e,t])}writeUInt8(e){this.offset=this.buffer.writeUInt8(e,this.offset)}writeInt32(e){this.offset=this.buffer.writeInt32LE(e,this.offset)}writeUInt32(e){this.offset=this.buffer.writeUInt32LE(e,this.offset)}writeUInt64(e){this.offset=vo(this.buffer,e,this.offset)}writeVarInt(e){yo.encode(e,this.buffer,this.offset),this.offset+=yo.encode.bytes}writeSlice(e){if(this.buffer.length<this.offset+e.length)throw new Error("Cannot write slice out of bounds");this.offset+=e.copy(this.buffer,this.offset)}writeVarSlice(e){this.writeVarInt(e.length),this.writeSlice(e)}writeVector(e){this.writeVarInt(e.length),e.forEach(e=>this.writeVarSlice(e))}end(){if(this.buffer.length===this.offset)return this.buffer;throw new Error(`buffer size ${this.buffer.length}, offset ${this.offset}`)}}var So,Io,To;function Po(){return Io||(Io=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.p2tr=e.p2wsh=e.p2wpkh=e.p2sh=e.p2pkh=e.p2pk=e.p2ms=e.embed=void 0;const t=mn;Object.defineProperty(e,"embed",{enumerable:!0,get:function(){return t.p2data}});const n=vr;Object.defineProperty(e,"p2ms",{enumerable:!0,get:function(){return n.p2ms}});const r=Br;Object.defineProperty(e,"p2pk",{enumerable:!0,get:function(){return r.p2pk}});const i=Or;Object.defineProperty(e,"p2pkh",{enumerable:!0,get:function(){return i.p2pkh}});const s=ws;Object.defineProperty(e,"p2sh",{enumerable:!0,get:function(){return s.p2sh}});const o=As;Object.defineProperty(e,"p2wpkh",{enumerable:!0,get:function(){return o.p2wpkh}});const a=Xs;Object.defineProperty(e,"p2wsh",{enumerable:!0,get:function(){return a.p2wsh}});const l=function(){if(So)return to;So=1,Object.defineProperty(to,"__esModule",{value:!0}),to.p2tr=void 0;const e=Nn,t=fn,n=hr(),r=Bn,i=no,s=ao,o=fr,a=Bs,l=Ao(),c=n.OPS;return to.p2tr=function(u,d){if(!(u.address||u.output||u.pubkey||u.internalPubkey||u.witness&&u.witness.length>1))throw new TypeError("Not enough data");d=Object.assign({validate:!0},d||{}),(0,r.typeforce)({address:r.typeforce.maybe(r.typeforce.String),input:r.typeforce.maybe(r.typeforce.BufferN(0)),network:r.typeforce.maybe(r.typeforce.Object),output:r.typeforce.maybe(r.typeforce.BufferN(34)),internalPubkey:r.typeforce.maybe(r.typeforce.BufferN(32)),hash:r.typeforce.maybe(r.typeforce.BufferN(32)),pubkey:r.typeforce.maybe(r.typeforce.BufferN(32)),signature:r.typeforce.maybe(r.typeforce.anyOf(r.typeforce.BufferN(64),r.typeforce.BufferN(65))),witness:r.typeforce.maybe(r.typeforce.arrayOf(r.typeforce.Buffer)),scriptTree:r.typeforce.maybe(r.isTaptree),redeem:r.typeforce.maybe({output:r.typeforce.maybe(r.typeforce.Buffer),redeemVersion:r.typeforce.maybe(r.typeforce.Number),witness:r.typeforce.maybe(r.typeforce.arrayOf(r.typeforce.Buffer))}),redeemVersion:r.typeforce.maybe(r.typeforce.Number)},u);const p=o.value(()=>(0,l.fromBech32)(u.address)),h=o.value(()=>{if(u.witness&&u.witness.length)return u.witness.length>=2&&80===u.witness[u.witness.length-1][0]?u.witness.slice(0,-1):u.witness.slice()}),f=o.value(()=>u.scriptTree?(0,s.toHashTree)(u.scriptTree):u.hash?{hash:u.hash}:void 0),g=u.network||t.bitcoin,m={name:"p2tr",network:g};if(o.prop(m,"address",()=>{if(!m.pubkey)return;const e=a.bech32m.toWords(m.pubkey);return e.unshift(1),a.bech32m.encode(g.bech32,e)}),o.prop(m,"hash",()=>{const e=f();if(e)return e.hash;const t=h();if(t&&t.length>1){const e=t[t.length-1],n=e[0]&r.TAPLEAF_VERSION_MASK,i=t[t.length-2],o=(0,s.tapleafHash)({output:i,version:n});return(0,s.rootHashFromPath)(e,o)}return null}),o.prop(m,"output",()=>{if(m.pubkey)return n.compile([c.OP_1,m.pubkey])}),o.prop(m,"redeemVersion",()=>u.redeemVersion?u.redeemVersion:u.redeem&&void 0!==u.redeem.redeemVersion&&null!==u.redeem.redeemVersion?u.redeem.redeemVersion:s.LEAF_VERSION_TAPSCRIPT),o.prop(m,"redeem",()=>{const e=h();if(e&&!(e.length<2))return{output:e[e.length-2],witness:e.slice(0,-2),redeemVersion:e[e.length-1][0]&r.TAPLEAF_VERSION_MASK}}),o.prop(m,"pubkey",()=>{if(u.pubkey)return u.pubkey;if(u.output)return u.output.slice(2);if(u.address)return p().data;if(m.internalPubkey){const e=(0,s.tweakKey)(m.internalPubkey,m.hash);if(e)return e.x}}),o.prop(m,"internalPubkey",()=>{if(u.internalPubkey)return u.internalPubkey;const e=h();return e&&e.length>1?e[e.length-1].slice(1,33):void 0}),o.prop(m,"signature",()=>{if(u.signature)return u.signature;const e=h();return e&&1===e.length?e[0]:void 0}),o.prop(m,"witness",()=>{if(u.witness)return u.witness;const t=f();if(t&&u.redeem&&u.redeem.output&&u.internalPubkey){const n=(0,s.tapleafHash)({output:u.redeem.output,version:m.redeemVersion}),r=(0,s.findScriptPath)(t,n);if(!r)return;const i=(0,s.tweakKey)(u.internalPubkey,t.hash);if(!i)return;const o=e.Buffer.concat([e.Buffer.from([m.redeemVersion|i.parity]),u.internalPubkey].concat(r));return[u.redeem.output,o]}return u.signature?[u.signature]:void 0}),d.validate){let t=e.Buffer.from([]);if(u.address){if(g&&g.bech32!==p().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(1!==p().version)throw new TypeError("Invalid address version");if(32!==p().data.length)throw new TypeError("Invalid address data");t=p().data}if(u.pubkey){if(t.length>0&&!t.equals(u.pubkey))throw new TypeError("Pubkey mismatch");t=u.pubkey}if(u.output){if(34!==u.output.length||u.output[0]!==c.OP_1||32!==u.output[1])throw new TypeError("Output is invalid");if(t.length>0&&!t.equals(u.output.slice(2)))throw new TypeError("Pubkey mismatch");t=u.output.slice(2)}if(u.internalPubkey){const e=(0,s.tweakKey)(u.internalPubkey,m.hash);if(t.length>0&&!t.equals(e.x))throw new TypeError("Pubkey mismatch");t=e.x}if(t&&t.length&&!(0,i.getEccLib)().isXOnlyPoint(t))throw new TypeError("Invalid pubkey for p2tr");const o=f();if(u.hash&&o&&!u.hash.equals(o.hash))throw new TypeError("Hash mismatch");if(u.redeem&&u.redeem.output&&o){const e=(0,s.tapleafHash)({output:u.redeem.output,version:m.redeemVersion});if(!(0,s.findScriptPath)(o,e))throw new TypeError("Redeem script not in tree")}const a=h();if(u.redeem&&m.redeem){if(u.redeem.redeemVersion&&u.redeem.redeemVersion!==m.redeem.redeemVersion)throw new TypeError("Redeem.redeemVersion and witness mismatch");if(u.redeem.output){if(0===n.decompile(u.redeem.output).length)throw new TypeError("Redeem.output is invalid");if(m.redeem.output&&!u.redeem.output.equals(m.redeem.output))throw new TypeError("Redeem.output and witness mismatch")}if(u.redeem.witness&&m.redeem.witness&&!(0,r.stacksEqual)(u.redeem.witness,m.redeem.witness))throw new TypeError("Redeem.witness and witness mismatch")}if(a&&a.length)if(1===a.length){if(u.signature&&!u.signature.equals(a[0]))throw new TypeError("Signature mismatch")}else{const e=a[a.length-1];if(e.length<33)throw new TypeError(`The control-block length is too small. Got ${e.length}, expected min 33.`);if((e.length-33)%32!=0)throw new TypeError(`The control-block length of ${e.length} is incorrect!`);const n=(e.length-33)/32;if(n>128)throw new TypeError(`The script path is too long. Got ${n}, expected max 128.`);const o=e.slice(1,33);if(u.internalPubkey&&!u.internalPubkey.equals(o))throw new TypeError("Internal pubkey mismatch");if(!(0,i.getEccLib)().isXOnlyPoint(o))throw new TypeError("Invalid internalPubkey for p2tr witness");const l=e[0]&r.TAPLEAF_VERSION_MASK,c=a[a.length-2],d=(0,s.tapleafHash)({output:c,version:l}),p=(0,s.rootHashFromPath)(e,d),h=(0,s.tweakKey)(o,p);if(!h)throw new TypeError("Invalid outputKey for p2tr witness");if(t.length&&!t.equals(h.x))throw new TypeError("Pubkey mismatch for p2tr witness");if(h.parity!==(1&e[0]))throw new Error("Incorrect parity")}}return Object.assign(m,u)},to}();Object.defineProperty(e,"p2tr",{enumerable:!0,get:function(){return l.p2tr}})}(gn)),gn}function Ao(){if(To)return hn;To=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.toOutputScript=hn.fromOutputScript=hn.toBech32=hn.toBase58Check=hn.fromBech32=hn.fromBase58Check=void 0;const e=fn,t=Po(),n=hr(),r=Bn,i=Bs,s=us,o="WARNING: Sending to a future segwit version address can lead to loss of funds. End users MUST be warned carefully in the GUI and asked if they wish to proceed with caution. Wallets should verify the segwit version from the output of fromBech32, then decide when it is safe to use which version of segwit.";function a(e){const t=Buffer.from(s.decode(e));if(t.length<21)throw new TypeError(e+" is too short");if(t.length>21)throw new TypeError(e+" is too long");return{version:t.readUInt8(0),hash:t.slice(1)}}function l(e){let t,n;try{t=i.bech32.decode(e)}catch(s){}if(t){if(n=t.words[0],0!==n)throw new TypeError(e+" uses wrong encoding")}else if(t=i.bech32m.decode(e),n=t.words[0],0===n)throw new TypeError(e+" uses wrong encoding");const r=i.bech32.fromWords(t.words.slice(1));return{version:n,prefix:t.prefix,data:Buffer.from(r)}}function c(e,t,n){const r=i.bech32.toWords(e);return r.unshift(t),0===t?i.bech32.encode(n,r):i.bech32m.encode(n,r)}return hn.fromBase58Check=a,hn.fromBech32=l,hn.toBase58Check=function(e,t){(0,r.typeforce)((0,r.tuple)(r.Hash160bit,r.UInt8),arguments);const n=Buffer.allocUnsafe(21);return n.writeUInt8(t,0),e.copy(n,1),s.encode(n)},hn.toBech32=c,hn.fromOutputScript=function(r,i){i=i||e.bitcoin;try{return t.p2pkh({output:r,network:i}).address}catch(s){}try{return t.p2sh({output:r,network:i}).address}catch(s){}try{return t.p2wpkh({output:r,network:i}).address}catch(s){}try{return t.p2wsh({output:r,network:i}).address}catch(s){}try{return t.p2tr({output:r,network:i}).address}catch(s){}try{return function(e,t){const n=e.slice(2);if(n.length<2||n.length>40)throw new TypeError("Invalid program length for segwit address");const r=e[0]-80;if(r<2||r>16)throw new TypeError("Invalid version for segwit address");if(e[1]!==n.length)throw new TypeError("Invalid script for segwit address");return console.warn(o),c(n,r,t.bech32)}(r,i)}catch(s){}throw new Error(n.toASM(r)+" has no matching Address")},hn.toOutputScript=function(r,i){let s,c;i=i||e.bitcoin;try{s=a(r)}catch(u){}if(s){if(s.version===i.pubKeyHash)return t.p2pkh({hash:s.hash}).output;if(s.version===i.scriptHash)return t.p2sh({hash:s.hash}).output}else{try{c=l(r)}catch(u){}if(c){if(c.prefix!==i.bech32)throw new Error(r+" has an invalid prefix");if(0===c.version){if(20===c.data.length)return t.p2wpkh({hash:c.data}).output;if(32===c.data.length)return t.p2wsh({hash:c.data}).output}else if(1===c.version){if(32===c.data.length)return t.p2tr({pubkey:c.data}).output}else if(c.version>=2&&c.version<=16&&c.data.length>=2&&c.data.length<=40)return console.warn(o),n.compile([c.version+80,c.data])}}throw new Error(r+" has no matching Script")},hn}lo.BufferWriter=Eo,lo.BufferReader=class{constructor(e,t=0){this.buffer=e,this.offset=t,mo(go.tuple(go.Buffer,go.UInt32),[e,t])}readUInt8(){const e=this.buffer.readUInt8(this.offset);return this.offset++,e}readInt32(){const e=this.buffer.readInt32LE(this.offset);return this.offset+=4,e}readUInt32(){const e=this.buffer.readUInt32LE(this.offset);return this.offset+=4,e}readUInt64(){const e=bo(this.buffer,this.offset);return this.offset+=8,e}readVarInt(){const e=yo.decode(this.buffer,this.offset);return this.offset+=yo.decode.bytes,e}readSlice(e){if(this.buffer.length<this.offset+e)throw new Error("Cannot read slice out of bounds");const t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){const e=this.readVarInt(),t=[];for(let n=0;n<e;n++)t.push(this.readVarSlice());return t}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.tweakKey=e.tapTweakHash=e.tapleafHash=e.findScriptPath=e.toHashTree=e.rootHashFromPath=e.MAX_TAPTREE_DEPTH=e.LEAF_VERSION_TAPSCRIPT=void 0;const t=Nn,n=no,r=Ur,i=lo,s=Bn;function o(n){const i=n.version||e.LEAF_VERSION_TAPSCRIPT;return r.taggedHash("TapLeaf",t.Buffer.concat([t.Buffer.from([i]),c(n.output)]))}function a(e,n){return r.taggedHash("TapTweak",t.Buffer.concat(n?[e,n]:[e]))}function l(e,n){return r.taggedHash("TapBranch",t.Buffer.concat([e,n]))}function c(e){const n=i.varuint.encodingLength(e.length),r=t.Buffer.allocUnsafe(n);return i.varuint.encode(e.length,r),t.Buffer.concat([r,e])}e.LEAF_VERSION_TAPSCRIPT=192,e.MAX_TAPTREE_DEPTH=128,e.rootHashFromPath=function(e,t){if(e.length<33)throw new TypeError(`The control-block length is too small. Got ${e.length}, expected min 33.`);const n=(e.length-33)/32;let r=t;for(let i=0;i<n;i++){const t=e.slice(33+32*i,65+32*i);r=r.compare(t)<0?l(r,t):l(t,r)}return r},e.toHashTree=function e(t){if((0,s.isTapleaf)(t))return{hash:o(t)};const n=[e(t[0]),e(t[1])];n.sort((e,t)=>e.hash.compare(t.hash));const[r,i]=n;return{hash:l(r.hash,i.hash),left:r,right:i}},e.findScriptPath=function e(t,n){if("left"in(r=t)&&"right"in r){const r=e(t.left,n);if(void 0!==r)return[...r,t.right.hash];const i=e(t.right,n);if(void 0!==i)return[...i,t.left.hash]}else if(t.hash.equals(n))return[];var r},e.tapleafHash=o,e.tapTweakHash=a,e.tweakKey=function(e,r){if(!t.Buffer.isBuffer(e))return null;if(32!==e.length)return null;if(r&&32!==r.length)return null;const i=a(e,r),s=(0,n.getEccLib)().xOnlyPointAddTweak(e,i);return s&&null!==s.xOnlyPubkey?{parity:s.parity,x:t.Buffer.from(s.xOnlyPubkey)}:null}}(ao);var Bo={},No={};Object.defineProperty(No,"__esModule",{value:!0}),No.fastMerkleRoot=void 0,No.fastMerkleRoot=function(e,t){if(!Array.isArray(e))throw TypeError("Expected values Array");if("function"!=typeof t)throw TypeError("Expected digest Function");let n=e.length;const r=e.concat();for(;n>1;){let e=0;for(let i=0;i<n;i+=2,++e){const s=r[i],o=i+1===n?s:r[i+1],a=Buffer.concat([s,o]);r[e]=t(a)}n=e}return r[0]};var xo={};Object.defineProperty(xo,"__esModule",{value:!0}),xo.Transaction=void 0;const _o=lo,Co=Ur,ko=hr(),Oo=hr(),Uo=Bn,{typeforce:Ro}=Uo;function Lo(e){const t=e.length;return _o.varuint.encodingLength(t)+t}const Ho=Buffer.allocUnsafe(0),Mo=[],Wo=Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),qo=Buffer.from("0000000000000000000000000000000000000000000000000000000000000001","hex"),Fo=Buffer.from("ffffffffffffffff","hex"),Ko={script:Ho,valueBuffer:Fo};class $o{constructor(){this.version=1,this.locktime=0,this.ins=[],this.outs=[]}static fromBuffer(e,t){const n=new _o.BufferReader(e),r=new $o;r.version=n.readInt32();const i=n.readUInt8(),s=n.readUInt8();let o=!1;i===$o.ADVANCED_TRANSACTION_MARKER&&s===$o.ADVANCED_TRANSACTION_FLAG?o=!0:n.offset-=2;const a=n.readVarInt();for(let c=0;c<a;++c)r.ins.push({hash:n.readSlice(32),index:n.readUInt32(),script:n.readVarSlice(),sequence:n.readUInt32(),witness:Mo});const l=n.readVarInt();for(let c=0;c<l;++c)r.outs.push({value:n.readUInt64(),script:n.readVarSlice()});if(o){for(let e=0;e<a;++e)r.ins[e].witness=n.readVector();if(!r.hasWitnesses())throw new Error("Transaction has superfluous witness data")}if(r.locktime=n.readUInt32(),t)return r;if(n.offset!==e.length)throw new Error("Transaction has unexpected data");return r}static fromHex(e){return $o.fromBuffer(Buffer.from(e,"hex"),!1)}static isCoinbaseHash(e){Ro(Uo.Hash256bit,e);for(let t=0;t<32;++t)if(0!==e[t])return!1;return!0}isCoinbase(){return 1===this.ins.length&&$o.isCoinbaseHash(this.ins[0].hash)}addInput(e,t,n,r){return Ro(Uo.tuple(Uo.Hash256bit,Uo.UInt32,Uo.maybe(Uo.UInt32),Uo.maybe(Uo.Buffer)),arguments),Uo.Null(n)&&(n=$o.DEFAULT_SEQUENCE),this.ins.push({hash:e,index:t,script:r||Ho,sequence:n,witness:Mo})-1}addOutput(e,t){return Ro(Uo.tuple(Uo.Buffer,Uo.Satoshi),arguments),this.outs.push({script:e,value:t})-1}hasWitnesses(){return this.ins.some(e=>0!==e.witness.length)}stripWitnesses(){this.ins.forEach(e=>{e.witness=Mo})}weight(){return 3*this.byteLength(!1)+this.byteLength(!0)}virtualSize(){return Math.ceil(this.weight()/4)}byteLength(e=!0){const t=e&&this.hasWitnesses();return(t?10:8)+_o.varuint.encodingLength(this.ins.length)+_o.varuint.encodingLength(this.outs.length)+this.ins.reduce((e,t)=>e+40+Lo(t.script),0)+this.outs.reduce((e,t)=>e+8+Lo(t.script),0)+(t?this.ins.reduce((e,t)=>e+function(e){const t=e.length;return _o.varuint.encodingLength(t)+e.reduce((e,t)=>e+Lo(t),0)}(t.witness),0):0)}clone(){const e=new $o;return e.version=this.version,e.locktime=this.locktime,e.ins=this.ins.map(e=>({hash:e.hash,index:e.index,script:e.script,sequence:e.sequence,witness:e.witness})),e.outs=this.outs.map(e=>({script:e.script,value:e.value})),e}hashForSignature(e,t,n){if(Ro(Uo.tuple(Uo.UInt32,Uo.Buffer,Uo.Number),arguments),e>=this.ins.length)return qo;const r=ko.compile(ko.decompile(t).filter(e=>e!==Oo.OPS.OP_CODESEPARATOR)),i=this.clone();if((31&n)===$o.SIGHASH_NONE)i.outs=[],i.ins.forEach((t,n)=>{n!==e&&(t.sequence=0)});else if((31&n)===$o.SIGHASH_SINGLE){if(e>=this.outs.length)return qo;i.outs.length=e+1;for(let t=0;t<e;t++)i.outs[t]=Ko;i.ins.forEach((t,n)=>{n!==e&&(t.sequence=0)})}n&$o.SIGHASH_ANYONECANPAY?(i.ins=[i.ins[e]],i.ins[0].script=r):(i.ins.forEach(e=>{e.script=Ho}),i.ins[e].script=r);const s=Buffer.allocUnsafe(i.byteLength(!1)+4);return s.writeInt32LE(n,s.length-4),i.__toBuffer(s,0,!1),Co.hash256(s)}hashForWitnessV1(e,t,n,r,i,s){if(Ro(Uo.tuple(Uo.UInt32,Ro.arrayOf(Uo.Buffer),Ro.arrayOf(Uo.Satoshi),Uo.UInt32),arguments),n.length!==this.ins.length||t.length!==this.ins.length)throw new Error("Must supply prevout script and value for all inputs");const o=r===$o.SIGHASH_DEFAULT?$o.SIGHASH_ALL:r&$o.SIGHASH_OUTPUT_MASK,a=(r&$o.SIGHASH_INPUT_MASK)===$o.SIGHASH_ANYONECANPAY,l=o===$o.SIGHASH_NONE,c=o===$o.SIGHASH_SINGLE;let u=Ho,d=Ho,p=Ho,h=Ho,f=Ho;if(!a){let e=_o.BufferWriter.withCapacity(36*this.ins.length);this.ins.forEach(t=>{e.writeSlice(t.hash),e.writeUInt32(t.index)}),u=Co.sha256(e.end()),e=_o.BufferWriter.withCapacity(8*this.ins.length),n.forEach(t=>e.writeUInt64(t)),d=Co.sha256(e.end()),e=_o.BufferWriter.withCapacity(t.map(Lo).reduce((e,t)=>e+t)),t.forEach(t=>e.writeVarSlice(t)),p=Co.sha256(e.end()),e=_o.BufferWriter.withCapacity(4*this.ins.length),this.ins.forEach(t=>e.writeUInt32(t.sequence)),h=Co.sha256(e.end())}if(l||c){if(c&&e<this.outs.length){const t=this.outs[e],n=_o.BufferWriter.withCapacity(8+Lo(t.script));n.writeUInt64(t.value),n.writeVarSlice(t.script),f=Co.sha256(n.end())}}else{const e=this.outs.map(e=>8+Lo(e.script)).reduce((e,t)=>e+t),t=_o.BufferWriter.withCapacity(e);this.outs.forEach(e=>{t.writeUInt64(e.value),t.writeVarSlice(e.script)}),f=Co.sha256(t.end())}const g=(i?2:0)+(s?1:0),m=174-(a?49:0)-(l?32:0)+(s?32:0)+(i?37:0),y=_o.BufferWriter.withCapacity(m);if(y.writeUInt8(r),y.writeInt32(this.version),y.writeUInt32(this.locktime),y.writeSlice(u),y.writeSlice(d),y.writeSlice(p),y.writeSlice(h),l||c||y.writeSlice(f),y.writeUInt8(g),a){const r=this.ins[e];y.writeSlice(r.hash),y.writeUInt32(r.index),y.writeUInt64(n[e]),y.writeVarSlice(t[e]),y.writeUInt32(r.sequence)}else y.writeUInt32(e);if(s){const e=_o.BufferWriter.withCapacity(Lo(s));e.writeVarSlice(s),y.writeSlice(Co.sha256(e.end()))}return c&&y.writeSlice(f),i&&(y.writeSlice(i),y.writeUInt8(0),y.writeUInt32(4294967295)),Co.taggedHash("TapSighash",Buffer.concat([Buffer.from([0]),y.end()]))}hashForWitnessV0(e,t,n,r){Ro(Uo.tuple(Uo.UInt32,Uo.Buffer,Uo.Satoshi,Uo.UInt32),arguments);let i,s=Buffer.from([]),o=Wo,a=Wo,l=Wo;if(r&$o.SIGHASH_ANYONECANPAY||(s=Buffer.allocUnsafe(36*this.ins.length),i=new _o.BufferWriter(s,0),this.ins.forEach(e=>{i.writeSlice(e.hash),i.writeUInt32(e.index)}),a=Co.hash256(s)),r&$o.SIGHASH_ANYONECANPAY||(31&r)===$o.SIGHASH_SINGLE||(31&r)===$o.SIGHASH_NONE||(s=Buffer.allocUnsafe(4*this.ins.length),i=new _o.BufferWriter(s,0),this.ins.forEach(e=>{i.writeUInt32(e.sequence)}),l=Co.hash256(s)),(31&r)!==$o.SIGHASH_SINGLE&&(31&r)!==$o.SIGHASH_NONE){const e=this.outs.reduce((e,t)=>e+8+Lo(t.script),0);s=Buffer.allocUnsafe(e),i=new _o.BufferWriter(s,0),this.outs.forEach(e=>{i.writeUInt64(e.value),i.writeVarSlice(e.script)}),o=Co.hash256(s)}else if((31&r)===$o.SIGHASH_SINGLE&&e<this.outs.length){const t=this.outs[e];s=Buffer.allocUnsafe(8+Lo(t.script)),i=new _o.BufferWriter(s,0),i.writeUInt64(t.value),i.writeVarSlice(t.script),o=Co.hash256(s)}s=Buffer.allocUnsafe(156+Lo(t)),i=new _o.BufferWriter(s,0);const c=this.ins[e];return i.writeInt32(this.version),i.writeSlice(a),i.writeSlice(l),i.writeSlice(c.hash),i.writeUInt32(c.index),i.writeVarSlice(t),i.writeUInt64(n),i.writeUInt32(c.sequence),i.writeSlice(o),i.writeUInt32(this.locktime),i.writeUInt32(r),Co.hash256(s)}getHash(e){return e&&this.isCoinbase()?Buffer.alloc(32,0):Co.hash256(this.__toBuffer(void 0,void 0,e))}getId(){return(0,_o.reverseBuffer)(this.getHash(!1)).toString("hex")}toBuffer(e,t){return this.__toBuffer(e,t,!0)}toHex(){return this.toBuffer(void 0,void 0).toString("hex")}setInputScript(e,t){Ro(Uo.tuple(Uo.Number,Uo.Buffer),arguments),this.ins[e].script=t}setWitness(e,t){Ro(Uo.tuple(Uo.Number,[Uo.Buffer]),arguments),this.ins[e].witness=t}__toBuffer(e,t,n=!1){e||(e=Buffer.allocUnsafe(this.byteLength(n)));const r=new _o.BufferWriter(e,t||0);r.writeInt32(this.version);const i=n&&this.hasWitnesses();return i&&(r.writeUInt8($o.ADVANCED_TRANSACTION_MARKER),r.writeUInt8($o.ADVANCED_TRANSACTION_FLAG)),r.writeVarInt(this.ins.length),this.ins.forEach(e=>{r.writeSlice(e.hash),r.writeUInt32(e.index),r.writeVarSlice(e.script),r.writeUInt32(e.sequence)}),r.writeVarInt(this.outs.length),this.outs.forEach(e=>{void 0!==e.value?r.writeUInt64(e.value):r.writeSlice(e.valueBuffer),r.writeVarSlice(e.script)}),i&&this.ins.forEach(e=>{r.writeVector(e.witness)}),r.writeUInt32(this.locktime),void 0!==t?e.slice(t,r.offset):e}}xo.Transaction=$o,$o.DEFAULT_SEQUENCE=4294967295,$o.SIGHASH_DEFAULT=0,$o.SIGHASH_ALL=1,$o.SIGHASH_NONE=2,$o.SIGHASH_SINGLE=3,$o.SIGHASH_ANYONECANPAY=128,$o.SIGHASH_OUTPUT_MASK=3,$o.SIGHASH_INPUT_MASK=128,$o.ADVANCED_TRANSACTION_MARKER=0,$o.ADVANCED_TRANSACTION_FLAG=1,Object.defineProperty(Bo,"__esModule",{value:!0}),Bo.Block=void 0;const Do=lo,Xo=Ur,Vo=No,jo=xo,Go=Bn,{typeforce:zo}=Go,Yo=new TypeError("Cannot compute merkle root for zero transactions"),Jo=new TypeError("Cannot compute witness commit for non-segwit block");class Qo{constructor(){this.version=1,this.prevHash=void 0,this.merkleRoot=void 0,this.timestamp=0,this.witnessCommit=void 0,this.bits=0,this.nonce=0,this.transactions=void 0}static fromBuffer(e){if(e.length<80)throw new Error("Buffer too small (< 80 bytes)");const t=new Do.BufferReader(e),n=new Qo;if(n.version=t.readInt32(),n.prevHash=t.readSlice(32),n.merkleRoot=t.readSlice(32),n.timestamp=t.readUInt32(),n.bits=t.readUInt32(),n.nonce=t.readUInt32(),80===e.length)return n;const r=()=>{const e=jo.Transaction.fromBuffer(t.buffer.slice(t.offset),!0);return t.offset+=e.byteLength(),e},i=t.readVarInt();n.transactions=[];for(let o=0;o<i;++o){const e=r();n.transactions.push(e)}const s=n.getWitnessCommit();return s&&(n.witnessCommit=s),n}static fromHex(e){return Qo.fromBuffer(Buffer.from(e,"hex"))}static calculateTarget(e){const t=((4278190080&e)>>24)-3,n=8388607&e,r=Buffer.alloc(32,0);return r.writeUIntBE(n,29-t,3),r}static calculateMerkleRoot(e,t){if(zo([{getHash:Go.Function}],e),0===e.length)throw Yo;if(t&&!Zo(e))throw Jo;const n=e.map(e=>e.getHash(t)),r=(0,Vo.fastMerkleRoot)(n,Xo.hash256);return t?Xo.hash256(Buffer.concat([r,e[0].ins[0].witness[0]])):r}getWitnessCommit(){if(!Zo(this.transactions))return null;const e=this.transactions[0].outs.filter(e=>e.script.slice(0,6).equals(Buffer.from("6a24aa21a9ed","hex"))).map(e=>e.script.slice(6,38));if(0===e.length)return null;const t=e[e.length-1];return t instanceof Buffer&&32===t.length?t:null}hasWitnessCommit(){return this.witnessCommit instanceof Buffer&&32===this.witnessCommit.length||null!==this.getWitnessCommit()}hasWitness(){return(e=this.transactions)instanceof Array&&e.some(e=>"object"==typeof e&&e.ins instanceof Array&&e.ins.some(e=>"object"==typeof e&&e.witness instanceof Array&&e.witness.length>0));var e}weight(){return 3*this.byteLength(!1,!1)+this.byteLength(!1,!0)}byteLength(e,t=!0){return e||!this.transactions?80:80+Do.varuint.encodingLength(this.transactions.length)+this.transactions.reduce((e,n)=>e+n.byteLength(t),0)}getHash(){return Xo.hash256(this.toBuffer(!0))}getId(){return(0,Do.reverseBuffer)(this.getHash()).toString("hex")}getUTCDate(){const e=new Date(0);return e.setUTCSeconds(this.timestamp),e}toBuffer(e){const t=Buffer.allocUnsafe(this.byteLength(e)),n=new Do.BufferWriter(t);return n.writeInt32(this.version),n.writeSlice(this.prevHash),n.writeSlice(this.merkleRoot),n.writeUInt32(this.timestamp),n.writeUInt32(this.bits),n.writeUInt32(this.nonce),e||!this.transactions||(Do.varuint.encode(this.transactions.length,t,n.offset),n.offset+=Do.varuint.encode.bytes,this.transactions.forEach(e=>{const r=e.byteLength();e.toBuffer(t,n.offset),n.offset+=r})),t}toHex(e){return this.toBuffer(e).toString("hex")}checkTxRoots(){const e=this.hasWitnessCommit();return!(!e&&this.hasWitness())&&this.__checkMerkleRoot()&&(!e||this.__checkWitnessCommit())}checkProofOfWork(){const e=(0,Do.reverseBuffer)(this.getHash()),t=Qo.calculateTarget(this.bits);return e.compare(t)<=0}__checkMerkleRoot(){if(!this.transactions)throw Yo;const e=Qo.calculateMerkleRoot(this.transactions);return 0===this.merkleRoot.compare(e)}__checkWitnessCommit(){if(!this.transactions)throw Yo;if(!this.hasWitnessCommit())throw Jo;const e=Qo.calculateMerkleRoot(this.transactions,!0);return 0===this.witnessCommit.compare(e)}}function Zo(e){return e instanceof Array&&e[0]&&e[0].ins&&e[0].ins instanceof Array&&e[0].ins[0]&&e[0].ins[0].witness&&e[0].ins[0].witness instanceof Array&&e[0].ins[0].witness.length>0}Bo.Block=Qo;var ea,ta,na,ra,ia={},sa={},oa={},aa={},la={},ca={},ua={};ea=ua,Object.defineProperty(ea,"__esModule",{value:!0}),(ta=ea.GlobalTypes||(ea.GlobalTypes={}))[ta.UNSIGNED_TX=0]="UNSIGNED_TX",ta[ta.GLOBAL_XPUB=1]="GLOBAL_XPUB",ea.GLOBAL_TYPE_NAMES=["unsignedTx","globalXpub"],(na=ea.InputTypes||(ea.InputTypes={}))[na.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",na[na.WITNESS_UTXO=1]="WITNESS_UTXO",na[na.PARTIAL_SIG=2]="PARTIAL_SIG",na[na.SIGHASH_TYPE=3]="SIGHASH_TYPE",na[na.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",na[na.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",na[na.BIP32_DERIVATION=6]="BIP32_DERIVATION",na[na.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",na[na.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",na[na.POR_COMMITMENT=9]="POR_COMMITMENT",na[na.TAP_KEY_SIG=19]="TAP_KEY_SIG",na[na.TAP_SCRIPT_SIG=20]="TAP_SCRIPT_SIG",na[na.TAP_LEAF_SCRIPT=21]="TAP_LEAF_SCRIPT",na[na.TAP_BIP32_DERIVATION=22]="TAP_BIP32_DERIVATION",na[na.TAP_INTERNAL_KEY=23]="TAP_INTERNAL_KEY",na[na.TAP_MERKLE_ROOT=24]="TAP_MERKLE_ROOT",ea.INPUT_TYPE_NAMES=["nonWitnessUtxo","witnessUtxo","partialSig","sighashType","redeemScript","witnessScript","bip32Derivation","finalScriptSig","finalScriptWitness","porCommitment","tapKeySig","tapScriptSig","tapLeafScript","tapBip32Derivation","tapInternalKey","tapMerkleRoot"],(ra=ea.OutputTypes||(ea.OutputTypes={}))[ra.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",ra[ra.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",ra[ra.BIP32_DERIVATION=2]="BIP32_DERIVATION",ra[ra.TAP_INTERNAL_KEY=5]="TAP_INTERNAL_KEY",ra[ra.TAP_TREE=6]="TAP_TREE",ra[ra.TAP_BIP32_DERIVATION=7]="TAP_BIP32_DERIVATION",ea.OUTPUT_TYPE_NAMES=["redeemScript","witnessScript","bip32Derivation","tapInternalKey","tapTree","tapBip32Derivation"];var da={};Object.defineProperty(da,"__esModule",{value:!0});const pa=ua;da.decode=function(e){if(e.key[0]!==pa.GlobalTypes.GLOBAL_XPUB)throw new Error("Decode Error: could not decode globalXpub with key 0x"+e.key.toString("hex"));if(79!==e.key.length||![2,3].includes(e.key[46]))throw new Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+e.key.toString("hex"));if(e.value.length/4%1!=0)throw new Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4");const t=e.key.slice(1),n={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(const i of(r=e.value.length/4-1,[...Array(r).keys()])){const t=e.value.readUInt32LE(4*i+4),r=!!(2147483648&t),s=2147483647&t;n.path+="/"+s.toString(10)+(r?"'":"")}var r;return n},da.encode=function(e){const t=Buffer.from([pa.GlobalTypes.GLOBAL_XPUB]),n=Buffer.concat([t,e.extendedPubkey]),r=e.path.split("/"),i=Buffer.allocUnsafe(4*r.length);e.masterFingerprint.copy(i,0);let s=4;return r.slice(1).forEach(e=>{const t="'"===e.slice(-1);let n=2147483647&parseInt(t?e.slice(0,-1):e,10);t&&(n+=2147483648),i.writeUInt32LE(n,s),s+=4}),{key:n,value:i}},da.expected="{ masterFingerprint: Buffer; extendedPubkey: Buffer; path: string; }",da.check=function(e){const t=e.extendedPubkey,n=e.masterFingerprint,r=e.path;return Buffer.isBuffer(t)&&78===t.length&&[2,3].indexOf(t[45])>-1&&Buffer.isBuffer(n)&&4===n.length&&"string"==typeof r&&!!r.match(/^m(\/\d+'?)*$/)},da.canAddToArray=function(e,t,n){const r=t.extendedPubkey.toString("hex");return!n.has(r)&&(n.add(r),0===e.filter(e=>e.extendedPubkey.equals(t.extendedPubkey)).length)};var ha={};Object.defineProperty(ha,"__esModule",{value:!0});const fa=ua;ha.encode=function(e){return{key:Buffer.from([fa.GlobalTypes.UNSIGNED_TX]),value:e.toBuffer()}};var ga={};Object.defineProperty(ga,"__esModule",{value:!0});const ma=ua;ga.decode=function(e){if(e.key[0]!==ma.InputTypes.FINAL_SCRIPTSIG)throw new Error("Decode Error: could not decode finalScriptSig with key 0x"+e.key.toString("hex"));return e.value},ga.encode=function(e){return{key:Buffer.from([ma.InputTypes.FINAL_SCRIPTSIG]),value:e}},ga.expected="Buffer",ga.check=function(e){return Buffer.isBuffer(e)},ga.canAdd=function(e,t){return!!e&&!!t&&void 0===e.finalScriptSig};var ya={};Object.defineProperty(ya,"__esModule",{value:!0});const wa=ua;ya.decode=function(e){if(e.key[0]!==wa.InputTypes.FINAL_SCRIPTWITNESS)throw new Error("Decode Error: could not decode finalScriptWitness with key 0x"+e.key.toString("hex"));return e.value},ya.encode=function(e){return{key:Buffer.from([wa.InputTypes.FINAL_SCRIPTWITNESS]),value:e}},ya.expected="Buffer",ya.check=function(e){return Buffer.isBuffer(e)},ya.canAdd=function(e,t){return!!e&&!!t&&void 0===e.finalScriptWitness};var ba={};Object.defineProperty(ba,"__esModule",{value:!0});const va=ua;ba.decode=function(e){if(e.key[0]!==va.InputTypes.NON_WITNESS_UTXO)throw new Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+e.key.toString("hex"));return e.value},ba.encode=function(e){return{key:Buffer.from([va.InputTypes.NON_WITNESS_UTXO]),value:e}},ba.expected="Buffer",ba.check=function(e){return Buffer.isBuffer(e)},ba.canAdd=function(e,t){return!!e&&!!t&&void 0===e.nonWitnessUtxo};var Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});const Sa=ua;Ea.decode=function(e){if(e.key[0]!==Sa.InputTypes.PARTIAL_SIG)throw new Error("Decode Error: could not decode partialSig with key 0x"+e.key.toString("hex"));if(34!==e.key.length&&66!==e.key.length||![2,3,4].includes(e.key[1]))throw new Error("Decode Error: partialSig has invalid pubkey in key 0x"+e.key.toString("hex"));return{pubkey:e.key.slice(1),signature:e.value}},Ea.encode=function(e){const t=Buffer.from([Sa.InputTypes.PARTIAL_SIG]);return{key:Buffer.concat([t,e.pubkey]),value:e.signature}},Ea.expected="{ pubkey: Buffer; signature: Buffer; }",Ea.check=function(e){return Buffer.isBuffer(e.pubkey)&&Buffer.isBuffer(e.signature)&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&function(e){if(!Buffer.isBuffer(e)||e.length<9)return!1;if(48!==e[0])return!1;if(e.length!==e[1]+3)return!1;if(2!==e[2])return!1;const t=e[3];if(t>33||t<1)return!1;if(2!==e[3+t+1])return!1;const n=e[3+t+2];return!(n>33||n<1)&&e.length===3+t+2+n+2}(e.signature)},Ea.canAddToArray=function(e,t,n){const r=t.pubkey.toString("hex");return!n.has(r)&&(n.add(r),0===e.filter(e=>e.pubkey.equals(t.pubkey)).length)};var Ia={};Object.defineProperty(Ia,"__esModule",{value:!0});const Ta=ua;Ia.decode=function(e){if(e.key[0]!==Ta.InputTypes.POR_COMMITMENT)throw new Error("Decode Error: could not decode porCommitment with key 0x"+e.key.toString("hex"));return e.value.toString("utf8")},Ia.encode=function(e){return{key:Buffer.from([Ta.InputTypes.POR_COMMITMENT]),value:Buffer.from(e,"utf8")}},Ia.expected="string",Ia.check=function(e){return"string"==typeof e},Ia.canAdd=function(e,t){return!!e&&!!t&&void 0===e.porCommitment};var Pa={};Object.defineProperty(Pa,"__esModule",{value:!0});const Aa=ua;Pa.decode=function(e){if(e.key[0]!==Aa.InputTypes.SIGHASH_TYPE)throw new Error("Decode Error: could not decode sighashType with key 0x"+e.key.toString("hex"));return e.value.readUInt32LE(0)},Pa.encode=function(e){const t=Buffer.from([Aa.InputTypes.SIGHASH_TYPE]),n=Buffer.allocUnsafe(4);return n.writeUInt32LE(e,0),{key:t,value:n}},Pa.expected="number",Pa.check=function(e){return"number"==typeof e},Pa.canAdd=function(e,t){return!!e&&!!t&&void 0===e.sighashType};var Ba={};Object.defineProperty(Ba,"__esModule",{value:!0});const Na=ua;function xa(e){return Buffer.isBuffer(e)&&(64===e.length||65===e.length)}Ba.decode=function(e){if(e.key[0]!==Na.InputTypes.TAP_KEY_SIG||1!==e.key.length)throw new Error("Decode Error: could not decode tapKeySig with key 0x"+e.key.toString("hex"));if(!xa(e.value))throw new Error("Decode Error: tapKeySig not a valid 64-65-byte BIP340 signature");return e.value},Ba.encode=function(e){return{key:Buffer.from([Na.InputTypes.TAP_KEY_SIG]),value:e}},Ba.expected="Buffer",Ba.check=xa,Ba.canAdd=function(e,t){return!!e&&!!t&&void 0===e.tapKeySig};var _a={};Object.defineProperty(_a,"__esModule",{value:!0});const Ca=ua;_a.decode=function(e){if(e.key[0]!==Ca.InputTypes.TAP_LEAF_SCRIPT)throw new Error("Decode Error: could not decode tapLeafScript with key 0x"+e.key.toString("hex"));if((e.key.length-2)%32!=0)throw new Error("Decode Error: tapLeafScript has invalid control block in key 0x"+e.key.toString("hex"));const t=e.value[e.value.length-1];if((254&e.key[1])!==t)throw new Error("Decode Error: tapLeafScript bad leaf version in key 0x"+e.key.toString("hex"));const n=e.value.slice(0,-1);return{controlBlock:e.key.slice(1),script:n,leafVersion:t}},_a.encode=function(e){const t=Buffer.from([Ca.InputTypes.TAP_LEAF_SCRIPT]),n=Buffer.from([e.leafVersion]);return{key:Buffer.concat([t,e.controlBlock]),value:Buffer.concat([e.script,n])}},_a.expected="{ controlBlock: Buffer; leafVersion: number, script: Buffer; }",_a.check=function(e){return Buffer.isBuffer(e.controlBlock)&&(e.controlBlock.length-1)%32==0&&(254&e.controlBlock[0])===e.leafVersion&&Buffer.isBuffer(e.script)},_a.canAddToArray=function(e,t,n){const r=t.controlBlock.toString("hex");return!n.has(r)&&(n.add(r),0===e.filter(e=>e.controlBlock.equals(t.controlBlock)).length)};var ka={};Object.defineProperty(ka,"__esModule",{value:!0});const Oa=ua;function Ua(e){return Buffer.isBuffer(e)&&32===e.length}ka.decode=function(e){if(e.key[0]!==Oa.InputTypes.TAP_MERKLE_ROOT||1!==e.key.length)throw new Error("Decode Error: could not decode tapMerkleRoot with key 0x"+e.key.toString("hex"));if(!Ua(e.value))throw new Error("Decode Error: tapMerkleRoot not a 32-byte hash");return e.value},ka.encode=function(e){return{key:Buffer.from([Oa.InputTypes.TAP_MERKLE_ROOT]),value:e}},ka.expected="Buffer",ka.check=Ua,ka.canAdd=function(e,t){return!!e&&!!t&&void 0===e.tapMerkleRoot};var Ra={};Object.defineProperty(Ra,"__esModule",{value:!0});const La=ua;Ra.decode=function(e){if(e.key[0]!==La.InputTypes.TAP_SCRIPT_SIG)throw new Error("Decode Error: could not decode tapScriptSig with key 0x"+e.key.toString("hex"));if(65!==e.key.length)throw new Error("Decode Error: tapScriptSig has invalid key 0x"+e.key.toString("hex"));if(64!==e.value.length&&65!==e.value.length)throw new Error("Decode Error: tapScriptSig has invalid signature in key 0x"+e.key.toString("hex"));return{pubkey:e.key.slice(1,33),leafHash:e.key.slice(33),signature:e.value}},Ra.encode=function(e){const t=Buffer.from([La.InputTypes.TAP_SCRIPT_SIG]);return{key:Buffer.concat([t,e.pubkey,e.leafHash]),value:e.signature}},Ra.expected="{ pubkey: Buffer; leafHash: Buffer; signature: Buffer; }",Ra.check=function(e){return Buffer.isBuffer(e.pubkey)&&Buffer.isBuffer(e.leafHash)&&Buffer.isBuffer(e.signature)&&32===e.pubkey.length&&32===e.leafHash.length&&(64===e.signature.length||65===e.signature.length)},Ra.canAddToArray=function(e,t,n){const r=t.pubkey.toString("hex")+t.leafHash.toString("hex");return!n.has(r)&&(n.add(r),0===e.filter(e=>e.pubkey.equals(t.pubkey)&&e.leafHash.equals(t.leafHash)).length)};var Ha={},Ma={},Wa={};function qa(e){if(e<0||e>9007199254740991||e%1!=0)throw new RangeError("value out of range")}function Fa(e){return qa(e),e<253?1:e<=65535?3:e<=4294967295?5:9}Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.encode=function e(t,n,r){if(qa(t),n||(n=Buffer.allocUnsafe(Fa(t))),!Buffer.isBuffer(n))throw new TypeError("buffer must be a Buffer instance");return r||(r=0),t<253?(n.writeUInt8(t,r),Object.assign(e,{bytes:1})):t<=65535?(n.writeUInt8(253,r),n.writeUInt16LE(t,r+1),Object.assign(e,{bytes:3})):t<=4294967295?(n.writeUInt8(254,r),n.writeUInt32LE(t,r+1),Object.assign(e,{bytes:5})):(n.writeUInt8(255,r),n.writeUInt32LE(t>>>0,r+1),n.writeUInt32LE(t/4294967296|0,r+5),Object.assign(e,{bytes:9})),n},Wa.decode=function e(t,n){if(!Buffer.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");n||(n=0);const r=t.readUInt8(n);if(r<253)return Object.assign(e,{bytes:1}),r;if(253===r)return Object.assign(e,{bytes:3}),t.readUInt16LE(n+1);if(254===r)return Object.assign(e,{bytes:5}),t.readUInt32LE(n+1);{Object.assign(e,{bytes:9});const r=t.readUInt32LE(n+1),i=4294967296*t.readUInt32LE(n+5)+r;return qa(i),i}},Wa.encodingLength=Fa,Object.defineProperty(Ma,"__esModule",{value:!0});const Ka=Wa;function $a(e){const t=e.key.length,n=e.value.length,r=Ka.encodingLength(t),i=Ka.encodingLength(n),s=Buffer.allocUnsafe(r+t+i+n);return Ka.encode(t,s,0),e.key.copy(s,r),Ka.encode(n,s,r+t),e.value.copy(s,r+t+i),s}function Da(e,t){if("number"!=typeof e)throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}Ma.range=e=>[...Array(e).keys()],Ma.reverseBuffer=function(e){if(e.length<1)return e;let t=e.length-1,n=0;for(let r=0;r<e.length/2;r++)n=e[r],e[r]=e[t],e[t]=n,t--;return e},Ma.keyValsToBuffer=function(e){const t=e.map($a);return t.push(Buffer.from([0])),Buffer.concat(t)},Ma.keyValToBuffer=$a,Ma.readUInt64LE=function(e,t){const n=e.readUInt32LE(t);let r=e.readUInt32LE(t+4);return r*=4294967296,Da(r+n,9007199254740991),r+n},Ma.writeUInt64LE=function(e,t,n){return Da(t,9007199254740991),e.writeInt32LE(-1&t,n),e.writeUInt32LE(Math.floor(t/4294967296),n+4),n+8},Object.defineProperty(Ha,"__esModule",{value:!0});const Xa=ua,Va=Ma,ja=Wa;Ha.decode=function(e){if(e.key[0]!==Xa.InputTypes.WITNESS_UTXO)throw new Error("Decode Error: could not decode witnessUtxo with key 0x"+e.key.toString("hex"));const t=Va.readUInt64LE(e.value,0);let n=8;const r=ja.decode(e.value,n);n+=ja.encodingLength(r);const i=e.value.slice(n);if(i.length!==r)throw new Error("Decode Error: WITNESS_UTXO script is not proper length");return{script:i,value:t}},Ha.encode=function(e){const{script:t,value:n}=e,r=ja.encodingLength(t.length),i=Buffer.allocUnsafe(8+r+t.length);return Va.writeUInt64LE(i,n,0),ja.encode(t.length,i,8),t.copy(i,8+r),{key:Buffer.from([Xa.InputTypes.WITNESS_UTXO]),value:i}},Ha.expected="{ script: Buffer; value: number; }",Ha.check=function(e){return Buffer.isBuffer(e.script)&&"number"==typeof e.value},Ha.canAdd=function(e,t){return!!e&&!!t&&void 0===e.witnessUtxo};var Ga={};Object.defineProperty(Ga,"__esModule",{value:!0});const za=ua,Ya=Wa;Ga.decode=function(e){if(e.key[0]!==za.OutputTypes.TAP_TREE||1!==e.key.length)throw new Error("Decode Error: could not decode tapTree with key 0x"+e.key.toString("hex"));let t=0;const n=[];for(;t<e.value.length;){const r=e.value[t++],i=e.value[t++],s=Ya.decode(e.value,t);t+=Ya.encodingLength(s),n.push({depth:r,leafVersion:i,script:e.value.slice(t,t+s)}),t+=s}return{leaves:n}},Ga.encode=function(e){const t=Buffer.from([za.OutputTypes.TAP_TREE]),n=[].concat(...e.leaves.map(e=>[Buffer.of(e.depth,e.leafVersion),Ya.encode(e.script.length),e.script]));return{key:t,value:Buffer.concat(n)}},Ga.expected="{ leaves: [{ depth: number; leafVersion: number, script: Buffer; }] }",Ga.check=function(e){return Array.isArray(e.leaves)&&e.leaves.every(e=>e.depth>=0&&e.depth<=128&&(254&e.leafVersion)===e.leafVersion&&Buffer.isBuffer(e.script))},Ga.canAdd=function(e,t){return!!e&&!!t&&void 0===e.tapTree};var Ja={};Object.defineProperty(Ja,"__esModule",{value:!0});const Qa=e=>33===e.length&&[2,3].includes(e[0])||65===e.length&&4===e[0];Ja.makeConverter=function(e,t=Qa){return{decode:function(n){if(n.key[0]!==e)throw new Error("Decode Error: could not decode bip32Derivation with key 0x"+n.key.toString("hex"));const r=n.key.slice(1);if(!t(r))throw new Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+n.key.toString("hex"));if(n.value.length/4%1!=0)throw new Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");const i={masterFingerprint:n.value.slice(0,4),pubkey:r,path:"m"};for(const e of(s=n.value.length/4-1,[...Array(s).keys()])){const t=n.value.readUInt32LE(4*e+4),r=!!(2147483648&t),s=2147483647&t;i.path+="/"+s.toString(10)+(r?"'":"")}var s;return i},encode:function(t){const n=Buffer.from([e]),r=Buffer.concat([n,t.pubkey]),i=t.path.split("/"),s=Buffer.allocUnsafe(4*i.length);t.masterFingerprint.copy(s,0);let o=4;return i.slice(1).forEach(e=>{const t="'"===e.slice(-1);let n=2147483647&parseInt(t?e.slice(0,-1):e,10);t&&(n+=2147483648),s.writeUInt32LE(n,o),o+=4}),{key:r,value:s}},check:function(e){return Buffer.isBuffer(e.pubkey)&&Buffer.isBuffer(e.masterFingerprint)&&"string"==typeof e.path&&t(e.pubkey)&&4===e.masterFingerprint.length},expected:"{ masterFingerprint: Buffer; pubkey: Buffer; path: string; }",canAddToArray:function(e,t,n){const r=t.pubkey.toString("hex");return!n.has(r)&&(n.add(r),0===e.filter(e=>e.pubkey.equals(t.pubkey)).length)}}};var Za={};Object.defineProperty(Za,"__esModule",{value:!0}),Za.makeChecker=function(e){return function(t){let n;if(e.includes(t.key[0])&&(n=t.key.slice(1),33!==n.length&&65!==n.length||![2,3,4].includes(n[0])))throw new Error("Format Error: invalid pubkey in key 0x"+t.key.toString("hex"));return n}};var el={};Object.defineProperty(el,"__esModule",{value:!0}),el.makeConverter=function(e){return{decode:function(t){if(t.key[0]!==e)throw new Error("Decode Error: could not decode redeemScript with key 0x"+t.key.toString("hex"));return t.value},encode:function(t){return{key:Buffer.from([e]),value:t}},check:function(e){return Buffer.isBuffer(e)},expected:"Buffer",canAdd:function(e,t){return!!e&&!!t&&void 0===e.redeemScript}}};var tl={};Object.defineProperty(tl,"__esModule",{value:!0});const nl=Wa,rl=Ja,il=e=>32===e.length;tl.makeConverter=function(e){const t=rl.makeConverter(e,il);return{decode:function(e){const n=nl.decode(e.value),r=nl.encodingLength(n),i=t.decode({key:e.key,value:e.value.slice(r+32*n)}),s=new Array(n);for(let t=0,o=r;t<n;t++,o+=32)s[t]=e.value.slice(o,o+32);return Object.assign({},i,{leafHashes:s})},encode:function(e){const n=t.encode(e),r=nl.encodingLength(e.leafHashes.length),i=Buffer.allocUnsafe(r);nl.encode(e.leafHashes.length,i);const s=Buffer.concat([i,...e.leafHashes,n.value]);return Object.assign({},n,{value:s})},check:function(e){return Array.isArray(e.leafHashes)&&e.leafHashes.every(e=>Buffer.isBuffer(e)&&32===e.length)&&t.check(e)},expected:"{ masterFingerprint: Buffer; pubkey: Buffer; path: string; leafHashes: Buffer[]; }",canAddToArray:t.canAddToArray}};var sl={};Object.defineProperty(sl,"__esModule",{value:!0}),sl.makeConverter=function(e){return{decode:function(t){if(t.key[0]!==e||1!==t.key.length)throw new Error("Decode Error: could not decode tapInternalKey with key 0x"+t.key.toString("hex"));if(32!==t.value.length)throw new Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey");return t.value},encode:function(t){return{key:Buffer.from([e]),value:t}},check:function(e){return Buffer.isBuffer(e)&&32===e.length},expected:"Buffer",canAdd:function(e,t){return!!e&&!!t&&void 0===e.tapInternalKey}}};var ol={};Object.defineProperty(ol,"__esModule",{value:!0}),ol.makeConverter=function(e){return{decode:function(t){if(t.key[0]!==e)throw new Error("Decode Error: could not decode witnessScript with key 0x"+t.key.toString("hex"));return t.value},encode:function(t){return{key:Buffer.from([e]),value:t}},check:function(e){return Buffer.isBuffer(e)},expected:"Buffer",canAdd:function(e,t){return!!e&&!!t&&void 0===e.witnessScript}}},Object.defineProperty(ca,"__esModule",{value:!0});const al=ua,ll=ga,cl=ya,ul=ba,dl=Ea,pl=Ia,hl=Pa,fl=Ba,gl=_a,ml=ka,yl=Ra,wl=Ha,bl=Ga,vl=Ja,El=Za,Sl=el,Il=tl,Tl=sl,Pl=ol,Al={unsignedTx:ha,globalXpub:da,checkPubkey:El.makeChecker([])};ca.globals=Al;const Bl={nonWitnessUtxo:ul,partialSig:dl,sighashType:hl,finalScriptSig:ll,finalScriptWitness:cl,porCommitment:pl,witnessUtxo:wl,bip32Derivation:vl.makeConverter(al.InputTypes.BIP32_DERIVATION),redeemScript:Sl.makeConverter(al.InputTypes.REDEEM_SCRIPT),witnessScript:Pl.makeConverter(al.InputTypes.WITNESS_SCRIPT),checkPubkey:El.makeChecker([al.InputTypes.PARTIAL_SIG,al.InputTypes.BIP32_DERIVATION]),tapKeySig:fl,tapScriptSig:yl,tapLeafScript:gl,tapBip32Derivation:Il.makeConverter(al.InputTypes.TAP_BIP32_DERIVATION),tapInternalKey:Tl.makeConverter(al.InputTypes.TAP_INTERNAL_KEY),tapMerkleRoot:ml};ca.inputs=Bl;const Nl={bip32Derivation:vl.makeConverter(al.OutputTypes.BIP32_DERIVATION),redeemScript:Sl.makeConverter(al.OutputTypes.REDEEM_SCRIPT),witnessScript:Pl.makeConverter(al.OutputTypes.WITNESS_SCRIPT),checkPubkey:El.makeChecker([al.OutputTypes.BIP32_DERIVATION]),tapBip32Derivation:Il.makeConverter(al.OutputTypes.TAP_BIP32_DERIVATION),tapTree:bl,tapInternalKey:Tl.makeConverter(al.OutputTypes.TAP_INTERNAL_KEY)};ca.outputs=Nl,Object.defineProperty(la,"__esModule",{value:!0});const xl=ca,_l=Ma,Cl=Wa,kl=ua;function Ol(e,t,n){if(!t.equals(Buffer.from([n])))throw new Error(`Format Error: Invalid ${e} key: ${t.toString("hex")}`)}function Ul(e,{globalMapKeyVals:t,inputKeyVals:n,outputKeyVals:r}){const i={unsignedTx:e};let s=0;for(const u of t)switch(u.key[0]){case kl.GlobalTypes.UNSIGNED_TX:if(Ol("global",u.key,kl.GlobalTypes.UNSIGNED_TX),s>0)throw new Error("Format Error: GlobalMap has multiple UNSIGNED_TX");s++;break;case kl.GlobalTypes.GLOBAL_XPUB:void 0===i.globalXpub&&(i.globalXpub=[]),i.globalXpub.push(xl.globals.globalXpub.decode(u));break;default:i.unknownKeyVals||(i.unknownKeyVals=[]),i.unknownKeyVals.push(u)}const o=n.length,a=r.length,l=[],c=[];for(const u of _l.range(o)){const e={};for(const t of n[u])switch(xl.inputs.checkPubkey(t),t.key[0]){case kl.InputTypes.NON_WITNESS_UTXO:if(Ol("input",t.key,kl.InputTypes.NON_WITNESS_UTXO),void 0!==e.nonWitnessUtxo)throw new Error("Format Error: Input has multiple NON_WITNESS_UTXO");e.nonWitnessUtxo=xl.inputs.nonWitnessUtxo.decode(t);break;case kl.InputTypes.WITNESS_UTXO:if(Ol("input",t.key,kl.InputTypes.WITNESS_UTXO),void 0!==e.witnessUtxo)throw new Error("Format Error: Input has multiple WITNESS_UTXO");e.witnessUtxo=xl.inputs.witnessUtxo.decode(t);break;case kl.InputTypes.PARTIAL_SIG:void 0===e.partialSig&&(e.partialSig=[]),e.partialSig.push(xl.inputs.partialSig.decode(t));break;case kl.InputTypes.SIGHASH_TYPE:if(Ol("input",t.key,kl.InputTypes.SIGHASH_TYPE),void 0!==e.sighashType)throw new Error("Format Error: Input has multiple SIGHASH_TYPE");e.sighashType=xl.inputs.sighashType.decode(t);break;case kl.InputTypes.REDEEM_SCRIPT:if(Ol("input",t.key,kl.InputTypes.REDEEM_SCRIPT),void 0!==e.redeemScript)throw new Error("Format Error: Input has multiple REDEEM_SCRIPT");e.redeemScript=xl.inputs.redeemScript.decode(t);break;case kl.InputTypes.WITNESS_SCRIPT:if(Ol("input",t.key,kl.InputTypes.WITNESS_SCRIPT),void 0!==e.witnessScript)throw new Error("Format Error: Input has multiple WITNESS_SCRIPT");e.witnessScript=xl.inputs.witnessScript.decode(t);break;case kl.InputTypes.BIP32_DERIVATION:void 0===e.bip32Derivation&&(e.bip32Derivation=[]),e.bip32Derivation.push(xl.inputs.bip32Derivation.decode(t));break;case kl.InputTypes.FINAL_SCRIPTSIG:Ol("input",t.key,kl.InputTypes.FINAL_SCRIPTSIG),e.finalScriptSig=xl.inputs.finalScriptSig.decode(t);break;case kl.InputTypes.FINAL_SCRIPTWITNESS:Ol("input",t.key,kl.InputTypes.FINAL_SCRIPTWITNESS),e.finalScriptWitness=xl.inputs.finalScriptWitness.decode(t);break;case kl.InputTypes.POR_COMMITMENT:Ol("input",t.key,kl.InputTypes.POR_COMMITMENT),e.porCommitment=xl.inputs.porCommitment.decode(t);break;case kl.InputTypes.TAP_KEY_SIG:Ol("input",t.key,kl.InputTypes.TAP_KEY_SIG),e.tapKeySig=xl.inputs.tapKeySig.decode(t);break;case kl.InputTypes.TAP_SCRIPT_SIG:void 0===e.tapScriptSig&&(e.tapScriptSig=[]),e.tapScriptSig.push(xl.inputs.tapScriptSig.decode(t));break;case kl.InputTypes.TAP_LEAF_SCRIPT:void 0===e.tapLeafScript&&(e.tapLeafScript=[]),e.tapLeafScript.push(xl.inputs.tapLeafScript.decode(t));break;case kl.InputTypes.TAP_BIP32_DERIVATION:void 0===e.tapBip32Derivation&&(e.tapBip32Derivation=[]),e.tapBip32Derivation.push(xl.inputs.tapBip32Derivation.decode(t));break;case kl.InputTypes.TAP_INTERNAL_KEY:Ol("input",t.key,kl.InputTypes.TAP_INTERNAL_KEY),e.tapInternalKey=xl.inputs.tapInternalKey.decode(t);break;case kl.InputTypes.TAP_MERKLE_ROOT:Ol("input",t.key,kl.InputTypes.TAP_MERKLE_ROOT),e.tapMerkleRoot=xl.inputs.tapMerkleRoot.decode(t);break;default:e.unknownKeyVals||(e.unknownKeyVals=[]),e.unknownKeyVals.push(t)}l.push(e)}for(const u of _l.range(a)){const e={};for(const t of r[u])switch(xl.outputs.checkPubkey(t),t.key[0]){case kl.OutputTypes.REDEEM_SCRIPT:if(Ol("output",t.key,kl.OutputTypes.REDEEM_SCRIPT),void 0!==e.redeemScript)throw new Error("Format Error: Output has multiple REDEEM_SCRIPT");e.redeemScript=xl.outputs.redeemScript.decode(t);break;case kl.OutputTypes.WITNESS_SCRIPT:if(Ol("output",t.key,kl.OutputTypes.WITNESS_SCRIPT),void 0!==e.witnessScript)throw new Error("Format Error: Output has multiple WITNESS_SCRIPT");e.witnessScript=xl.outputs.witnessScript.decode(t);break;case kl.OutputTypes.BIP32_DERIVATION:void 0===e.bip32Derivation&&(e.bip32Derivation=[]),e.bip32Derivation.push(xl.outputs.bip32Derivation.decode(t));break;case kl.OutputTypes.TAP_INTERNAL_KEY:Ol("output",t.key,kl.OutputTypes.TAP_INTERNAL_KEY),e.tapInternalKey=xl.outputs.tapInternalKey.decode(t);break;case kl.OutputTypes.TAP_TREE:Ol("output",t.key,kl.OutputTypes.TAP_TREE),e.tapTree=xl.outputs.tapTree.decode(t);break;case kl.OutputTypes.TAP_BIP32_DERIVATION:void 0===e.tapBip32Derivation&&(e.tapBip32Derivation=[]),e.tapBip32Derivation.push(xl.outputs.tapBip32Derivation.decode(t));break;default:e.unknownKeyVals||(e.unknownKeyVals=[]),e.unknownKeyVals.push(t)}c.push(e)}return{globalMap:i,inputs:l,outputs:c}}la.psbtFromBuffer=function(e,t){let n=0;function r(){const t=Cl.decode(e,n);n+=Cl.encodingLength(t);const r=e.slice(n,n+t);return n+=t,r}function i(){return{key:r(),value:r()}}function s(){if(n>=e.length)throw new Error("Format Error: Unexpected End of PSBT");const t=0===e.readUInt8(n);return t&&n++,t}if(1886610036!==function(){const t=e.readUInt32BE(n);return n+=4,t}())throw new Error("Format Error: Invalid Magic Number");if(255!==function(){const t=e.readUInt8(n);return n+=1,t}())throw new Error("Format Error: Magic Number must be followed by 0xff separator");const o=[],a={};for(;!s();){const e=i(),t=e.key.toString("hex");if(a[t])throw new Error("Format Error: Keys must be unique for global keymap: key "+t);a[t]=1,o.push(e)}const l=o.filter(e=>e.key[0]===kl.GlobalTypes.UNSIGNED_TX);if(1!==l.length)throw new Error("Format Error: Only one UNSIGNED_TX allowed");const c=t(l[0].value),{inputCount:u,outputCount:d}=c.getInputOutputCounts(),p=[],h=[];for(const f of _l.range(u)){const e={},t=[];for(;!s();){const n=i(),r=n.key.toString("hex");if(e[r])throw new Error("Format Error: Keys must be unique for each input: input index "+f+" key "+r);e[r]=1,t.push(n)}p.push(t)}for(const f of _l.range(d)){const e={},t=[];for(;!s();){const n=i(),r=n.key.toString("hex");if(e[r])throw new Error("Format Error: Keys must be unique for each output: output index "+f+" key "+r);e[r]=1,t.push(n)}h.push(t)}return Ul(c,{globalMapKeyVals:o,inputKeyVals:p,outputKeyVals:h})},la.checkKeyBuffer=Ol,la.psbtFromKeyVals=Ul;var Rl={};Object.defineProperty(Rl,"__esModule",{value:!0});const Ll=ca,Hl=Ma;Rl.psbtToBuffer=function({globalMap:e,inputs:t,outputs:n}){const{globalKeyVals:r,inputKeyVals:i,outputKeyVals:s}=ql({globalMap:e,inputs:t,outputs:n}),o=Hl.keyValsToBuffer(r),a=e=>0===e.length?[Buffer.from([0])]:e.map(Hl.keyValsToBuffer),l=a(i),c=a(s),u=Buffer.allocUnsafe(5);return u.writeUIntBE(482972169471,0,5),Buffer.concat([u,o].concat(l,c))};const Ml=(e,t)=>e.key.compare(t.key);function Wl(e,t){const n=new Set,r=Object.entries(e).reduce((e,[r,i])=>{if("unknownKeyVals"===r)return e;const s=t[r];if(void 0===s)return e;const o=(Array.isArray(i)?i:[i]).map(s.encode);return o.map(e=>e.key.toString("hex")).forEach(e=>{if(n.has(e))throw new Error("Serialize Error: Duplicate key: "+e);n.add(e)}),e.concat(o)},[]),i=e.unknownKeyVals?e.unknownKeyVals.filter(e=>!n.has(e.key.toString("hex"))):[];return r.concat(i).sort(Ml)}function ql({globalMap:e,inputs:t,outputs:n}){return{globalKeyVals:Wl(e,Ll.globals),inputKeyVals:t.map(e=>Wl(e,Ll.inputs)),outputKeyVals:n.map(e=>Wl(e,Ll.outputs))}}Rl.psbtToKeyVals=ql,function(e){function t(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),t(la),t(Rl)}(aa),Object.defineProperty(oa,"__esModule",{value:!0});const Fl=aa;function Kl(e,t,n){return r=>{if(e.has(r))return;const i=n.filter(e=>e.key.toString("hex")===r)[0];t.push(i),e.add(r)}}function $l(e){return e.globalMap.unsignedTx}function Dl(e){const t=new Set;return e.forEach(e=>{const n=e.key.toString("hex");if(t.has(n))throw new Error("Combine: KeyValue Map keys should be unique");t.add(n)}),t}oa.combine=function(e){const t=e[0],n=Fl.psbtToKeyVals(t),r=e.slice(1);if(0===r.length)throw new Error("Combine: Nothing to combine");const i=$l(t);if(void 0===i)throw new Error("Combine: Self missing transaction");const s=Dl(n.globalKeyVals),o=n.inputKeyVals.map(Dl),a=n.outputKeyVals.map(Dl);for(const l of r){const e=$l(l);if(void 0===e||!e.toBuffer().equals(i.toBuffer()))throw new Error("Combine: One of the Psbts does not have the same transaction.");const t=Fl.psbtToKeyVals(l);Dl(t.globalKeyVals).forEach(Kl(s,n.globalKeyVals,t.globalKeyVals)),t.inputKeyVals.map(Dl).forEach((e,r)=>e.forEach(Kl(o[r],n.inputKeyVals[r],t.inputKeyVals[r]))),t.outputKeyVals.map(Dl).forEach((e,r)=>e.forEach(Kl(a[r],n.outputKeyVals[r],t.outputKeyVals[r])))}return Fl.psbtFromKeyVals(i,{globalMapKeyVals:n.globalKeyVals,inputKeyVals:n.inputKeyVals,outputKeyVals:n.outputKeyVals})};var Xl={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=ca;function n(e,t){const n=e[t];if(void 0===n)throw new Error(`No input #${t}`);return n}function r(e,t){const n=e[t];if(void 0===n)throw new Error(`No output #${t}`);return n}function i(e,t,n,r){throw new Error(`Data for ${e} key ${t} is incorrect: Expected ${n} and got ${JSON.stringify(r)}`)}function s(e){return(n,r)=>{for(const s of Object.keys(n)){const o=n[s],{canAdd:a,canAddToArray:l,check:c,expected:u}=t[e+"s"][s]||{};if(c)if(l){if(!Array.isArray(o)||r[s]&&!Array.isArray(r[s]))throw new Error(`Key type ${s} must be an array`);o.every(c)||i(e,s,u,o);const t=r[s]||[],n=new Set;if(!o.every(e=>l(t,e,n)))throw new Error("Can not add duplicate data to array");r[s]=t.concat(o)}else{if(c(o)||i(e,s,u,o),!a(r,o))throw new Error(`Can not add duplicate data to ${e}`);r[s]=o}}}}e.checkForInput=n,e.checkForOutput=r,e.checkHasKey=function(e,t,n){if(e.key[0]<n)throw new Error("Use the method for your specific key instead of addUnknownKeyVal*");if(t&&0!==t.filter(t=>t.key.equals(e.key)).length)throw new Error(`Duplicate Key: ${e.key.toString("hex")}`)},e.getEnumLength=function(e){let t=0;return Object.keys(e).forEach(e=>{Number(isNaN(Number(e)))&&t++}),t},e.inputCheckUncleanFinalized=function(e,t){let n=!1;if(t.nonWitnessUtxo||t.witnessUtxo){const e=!!t.redeemScript,r=!!t.witnessScript,i=!e||!!t.finalScriptSig,s=!r||!!t.finalScriptWitness,o=!!t.finalScriptSig||!!t.finalScriptWitness;n=i&&s&&o}if(!1===n)throw new Error(`Input #${e} has too much or too little data to clean`)},e.updateGlobal=s("global"),e.updateInput=s("input"),e.updateOutput=s("output"),e.addInputAttributes=function(t,r){const i=n(t,t.length-1);e.updateInput(r,i)},e.addOutputAttributes=function(t,n){const i=r(t,t.length-1);e.updateOutput(n,i)},e.defaultVersionSetter=function(e,t){if(!Buffer.isBuffer(t)||t.length<4)throw new Error("Set Version: Invalid Transaction");return t.writeUInt32LE(e,0),t},e.defaultLocktimeSetter=function(e,t){if(!Buffer.isBuffer(t)||t.length<4)throw new Error("Set Locktime: Invalid Transaction");return t.writeUInt32LE(e,t.length-4),t}}(Xl),Object.defineProperty(sa,"__esModule",{value:!0});const Vl=oa,jl=aa,Gl=ua,zl=Xl;sa.Psbt=class{constructor(e){this.inputs=[],this.outputs=[],this.globalMap={unsignedTx:e}}static fromBase64(e,t){const n=Buffer.from(e,"base64");return this.fromBuffer(n,t)}static fromHex(e,t){const n=Buffer.from(e,"hex");return this.fromBuffer(n,t)}static fromBuffer(e,t){const n=jl.psbtFromBuffer(e,t),r=new this(n.globalMap.unsignedTx);return Object.assign(r,n),r}toBase64(){return this.toBuffer().toString("base64")}toHex(){return this.toBuffer().toString("hex")}toBuffer(){return jl.psbtToBuffer(this)}updateGlobal(e){return zl.updateGlobal(e,this.globalMap),this}updateInput(e,t){const n=zl.checkForInput(this.inputs,e);return zl.updateInput(t,n),this}updateOutput(e,t){const n=zl.checkForOutput(this.outputs,e);return zl.updateOutput(t,n),this}addUnknownKeyValToGlobal(e){return zl.checkHasKey(e,this.globalMap.unknownKeyVals,zl.getEnumLength(Gl.GlobalTypes)),this.globalMap.unknownKeyVals||(this.globalMap.unknownKeyVals=[]),this.globalMap.unknownKeyVals.push(e),this}addUnknownKeyValToInput(e,t){const n=zl.checkForInput(this.inputs,e);return zl.checkHasKey(t,n.unknownKeyVals,zl.getEnumLength(Gl.InputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(t),this}addUnknownKeyValToOutput(e,t){const n=zl.checkForOutput(this.outputs,e);return zl.checkHasKey(t,n.unknownKeyVals,zl.getEnumLength(Gl.OutputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(t),this}addInput(e){this.globalMap.unsignedTx.addInput(e),this.inputs.push({unknownKeyVals:[]});const t=e.unknownKeyVals||[],n=this.inputs.length-1;if(!Array.isArray(t))throw new Error("unknownKeyVals must be an Array");return t.forEach(e=>this.addUnknownKeyValToInput(n,e)),zl.addInputAttributes(this.inputs,e),this}addOutput(e){this.globalMap.unsignedTx.addOutput(e),this.outputs.push({unknownKeyVals:[]});const t=e.unknownKeyVals||[],n=this.outputs.length-1;if(!Array.isArray(t))throw new Error("unknownKeyVals must be an Array");return t.forEach(e=>this.addUnknownKeyValToOutput(n,e)),zl.addOutputAttributes(this.outputs,e),this}clearFinalizedInput(e){const t=zl.checkForInput(this.inputs,e);zl.inputCheckUncleanFinalized(e,t);for(const n of Object.keys(t))["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(n)||delete t[n];return this}combine(...e){const t=Vl.combine([this].concat(e));return Object.assign(this,t),this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}};var Yl={},Jl={};Object.defineProperty(Jl,"__esModule",{value:!0}),Jl.signatureBlocksAction=Jl.checkInputForSig=Jl.pubkeyInScript=Jl.pubkeyPositionInScript=Jl.witnessStackToScriptWitness=Jl.isP2TR=Jl.isP2SHScript=Jl.isP2WSHScript=Jl.isP2WPKH=Jl.isP2PKH=Jl.isP2PK=Jl.isP2MS=void 0;const Ql=Wa,Zl=hr(),ec=xo,tc=Ur,nc=Po();function rc(e){return t=>{try{return e({output:t}),!0}catch(n){return!1}}}function ic(e,t){const n=(0,tc.hash160)(e),r=e.slice(1,33),i=Zl.decompile(t);if(null===i)throw new Error("Unknown script error");return i.findIndex(t=>"number"!=typeof t&&(t.equals(e)||t.equals(n)||t.equals(r)))}function sc(e,t,n){const{hashType:r}=t(e),i=[];switch(r&ec.Transaction.SIGHASH_ANYONECANPAY&&i.push("addInput"),31&r){case ec.Transaction.SIGHASH_ALL:break;case ec.Transaction.SIGHASH_SINGLE:case ec.Transaction.SIGHASH_NONE:i.push("addOutput"),i.push("setInputSequence")}return-1===i.indexOf(n)}Jl.isP2MS=rc(nc.p2ms),Jl.isP2PK=rc(nc.p2pk),Jl.isP2PKH=rc(nc.p2pkh),Jl.isP2WPKH=rc(nc.p2wpkh),Jl.isP2WSHScript=rc(nc.p2wsh),Jl.isP2SHScript=rc(nc.p2sh),Jl.isP2TR=rc(nc.p2tr),Jl.witnessStackToScriptWitness=function(e){let t=Buffer.allocUnsafe(0);function n(e){const n=t.length,r=Ql.encodingLength(e);t=Buffer.concat([t,Buffer.allocUnsafe(r)]),Ql.encode(e,t,n)}var r;return n((r=e).length),r.forEach(function(e){n(e.length),function(e){t=Buffer.concat([t,Buffer.from(e)])}(e)}),t},Jl.pubkeyPositionInScript=ic,Jl.pubkeyInScript=function(e,t){return-1!==ic(e,t)},Jl.checkInputForSig=function(e,t){return function(e){let t=[];if(0===(e.partialSig||[]).length){if(!e.finalScriptSig&&!e.finalScriptWitness)return[];t=function(e){const t=e.finalScriptSig&&Zl.decompile(e.finalScriptSig)||[],n=e.finalScriptWitness&&Zl.decompile(e.finalScriptWitness)||[];return t.concat(n).filter(e=>Buffer.isBuffer(e)&&Zl.isCanonicalScriptSignature(e)).map(e=>({signature:e}))}(e)}else t=e.partialSig;return t.map(e=>e.signature)}(e).some(e=>sc(e,Zl.signature.decode,t))},Jl.signatureBlocksAction=sc,Object.defineProperty(Yl,"__esModule",{value:!0}),Yl.checkTaprootInputForSigs=Yl.tapTreeFromList=Yl.tapTreeToList=Yl.tweakInternalPubKey=Yl.checkTaprootOutputFields=Yl.checkTaprootInputFields=Yl.isTaprootOutput=Yl.isTaprootInput=Yl.serializeTaprootSignature=Yl.tapScriptFinalizer=Yl.toXOnly=void 0;const oc=Bn,ac=xo,lc=Jl,cc=ao,uc=Po(),dc=Jl;function pc(e){return e&&!!(e.tapInternalKey||e.tapMerkleRoot||e.tapLeafScript&&e.tapLeafScript.length||e.tapBip32Derivation&&e.tapBip32Derivation.length||e.witnessUtxo&&(0,lc.isP2TR)(e.witnessUtxo.script))}function hc(e,t){return e&&!!(e.tapInternalKey||e.tapTree||e.tapBip32Derivation&&e.tapBip32Derivation.length||t&&(0,lc.isP2TR)(t))}function fc(e=[]){return 1===e.length&&0===e[0].depth?{output:e[0].script,version:e[0].leafVersion}:function(e){let t;for(const n of e)if(t=yc(n,t),!t)throw new Error("No room left to insert tapleaf in tree");return t}(e)}function gc(e){return{signature:e.slice(0,64),hashType:e.slice(64)[0]||ac.Transaction.SIGHASH_DEFAULT}}function mc(e,t=[],n=0){if(n>cc.MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");return e?(0,oc.isTapleaf)(e)?(t.push({depth:n,leafVersion:e.version||cc.LEAF_VERSION_TAPSCRIPT,script:e.output}),t):(e[0]&&mc(e[0],t,n+1),e[1]&&mc(e[1],t,n+1),t):[]}function yc(e,t,n=0){if(n>cc.MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");if(e.depth===n)return t?void 0:{output:e.script,version:e.leafVersion};if((0,oc.isTapleaf)(t))return;const r=yc(e,t&&t[0],n+1);if(r)return[r,t&&t[1]];const i=yc(e,t&&t[1],n+1);return i?[t&&t[0],i]:void 0}function wc(e,t){if(!t)return!0;const n=(0,cc.tapleafHash)({output:e.script,version:e.leafVersion});return(0,cc.rootHashFromPath)(e.controlBlock,n).equals(t)}function bc(e){return e&&!!(e.redeemScript||e.witnessScript||e.bip32Derivation&&e.bip32Derivation.length)}Yl.toXOnly=e=>32===e.length?e:e.slice(1,33),Yl.tapScriptFinalizer=function(e,t,n){const r=function(e,t,n){if(!e.tapScriptSig||!e.tapScriptSig.length)throw new Error(`Can not finalize taproot input #${t}. No tapleaf script signature provided.`);const r=(e.tapLeafScript||[]).sort((e,t)=>e.controlBlock.length-t.controlBlock.length).find(t=>function(e,t,n){const r=(0,cc.tapleafHash)({output:e.script,version:e.leafVersion});return(!n||n.equals(r))&&void 0!==t.find(e=>e.leafHash.equals(r))}(t,e.tapScriptSig,n));if(!r)throw new Error(`Can not finalize taproot input #${t}. Signature for tapleaf script not found.`);return r}(t,e,n);try{const e=function(e,t){const n=(0,cc.tapleafHash)({output:t.script,version:t.leafVersion});return(e.tapScriptSig||[]).filter(e=>e.leafHash.equals(n)).map(e=>function(e,t){return Object.assign({positionInScript:(0,lc.pubkeyPositionInScript)(t.pubkey,e)},t)}(t.script,e)).sort((e,t)=>t.positionInScript-e.positionInScript).map(e=>e.signature)}(t,r),n=e.concat(r.script).concat(r.controlBlock);return{finalScriptWitness:(0,lc.witnessStackToScriptWitness)(n)}}catch(i){throw new Error(`Can not finalize taproot input #${e}: ${i}`)}},Yl.serializeTaprootSignature=function(e,t){const n=t?Buffer.from([t]):Buffer.from([]);return Buffer.concat([e,n])},Yl.isTaprootInput=pc,Yl.isTaprootOutput=hc,Yl.checkTaprootInputFields=function(e,t,n){!function(e,t,n){const r=pc(e)&&bc(t),i=bc(e)&&pc(t),s=e===t&&pc(t)&&bc(t);if(r||i||s)throw new Error(`Invalid arguments for Psbt.${n}. Cannot use both taproot and non-taproot fields.`)}(e,t,n),function(e,t,n){if(t.tapMerkleRoot){const r=(t.tapLeafScript||[]).every(e=>wc(e,t.tapMerkleRoot)),i=(e.tapLeafScript||[]).every(e=>wc(e,t.tapMerkleRoot));if(!r||!i)throw new Error(`Invalid arguments for Psbt.${n}. Tapleaf not part of taptree.`)}else if(e.tapMerkleRoot&&!(t.tapLeafScript||[]).every(t=>wc(t,e.tapMerkleRoot)))throw new Error(`Invalid arguments for Psbt.${n}. Tapleaf not part of taptree.`)}(e,t,n)},Yl.checkTaprootOutputFields=function(e,t,n){!function(e,t,n){const r=hc(e)&&bc(t),i=bc(e)&&hc(t),s=e===t&&hc(t)&&bc(t);if(r||i||s)throw new Error(`Invalid arguments for Psbt.${n}. Cannot use both taproot and non-taproot fields.`)}(e,t,n),function(e,t){if(!t.tapTree&&!t.tapInternalKey)return;const n=t.tapInternalKey||e.tapInternalKey,r=t.tapTree||e.tapTree;if(n){const{script:t}=e,i=function(e,t){const n=t&&fc(t.leaves),{output:r}=(0,uc.p2tr)({internalPubkey:e,scriptTree:n});return r}(n,r);if(t&&!t.equals(i))throw new Error("Error adding output. Script or address missmatch.")}}(e,t)},Yl.tweakInternalPubKey=function(e,t){const n=t.tapInternalKey,r=n&&(0,cc.tweakKey)(n,t.tapMerkleRoot);if(!r)throw new Error(`Cannot tweak tap internal key for input #${e}. Public key: ${n&&n.toString("hex")}`);return r.x},Yl.tapTreeToList=function(e){if(!(0,oc.isTaptree)(e))throw new Error("Cannot convert taptree to tapleaf list. Expecting a tapree structure.");return mc(e)},Yl.tapTreeFromList=fc,Yl.checkTaprootInputForSigs=function(e,t){return function(e){const t=[];if(e.tapKeySig&&t.push(e.tapKeySig),e.tapScriptSig&&t.push(...e.tapScriptSig.map(e=>e.signature)),!t.length){const n=function(e){if(!e)return;const t=e.slice(2);return 64===t.length||65===t.length?t:void 0}(e.finalScriptWitness);n&&t.push(n)}return t}(e).some(e=>(0,dc.signatureBlocksAction)(e,gc,t))},Object.defineProperty(ia,"__esModule",{value:!0}),ia.Psbt=void 0;const vc=sa,Ec=Wa,Sc=Xl,Ic=Ao(),Tc=lo,Pc=fn,Ac=Po(),Bc=ao,Nc=hr(),xc=xo,_c=Yl,Cc=Jl,kc={network:Pc.bitcoin,maximumFeeRate:5e3};class Oc{static fromBase64(e,t={}){const n=Buffer.from(e,"base64");return this.fromBuffer(n,t)}static fromHex(e,t={}){const n=Buffer.from(e,"hex");return this.fromBuffer(n,t)}static fromBuffer(e,t={}){const n=vc.Psbt.fromBuffer(e,Uc),r=new Oc(t,n);var i,s;return i=r.__CACHE.__TX,s=r.__CACHE,i.ins.forEach(e=>{$c(s,e)}),r}constructor(e={},t=new vc.Psbt(new Rc)){this.data=t,this.opts=Object.assign({},kc,e),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},0===this.data.inputs.length&&this.setVersion(2);const n=(e,t,n,r)=>Object.defineProperty(e,t,{enumerable:n,writable:r});n(this,"__CACHE",!1,!0),n(this,"opts",!1,!0)}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(e){this.setVersion(e)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(e){this.setLocktime(e)}get txInputs(){return this.__CACHE.__TX.ins.map(e=>({hash:(0,Tc.cloneBuffer)(e.hash),index:e.index,sequence:e.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(e=>{let t;try{t=(0,Ic.fromOutputScript)(e.script,this.opts.network)}catch(n){}return{script:(0,Tc.cloneBuffer)(e.script),value:e.value,address:t}})}combine(...e){return this.data.combine(...e.map(e=>e.data)),this}clone(){const e=Oc.fromBuffer(this.data.toBuffer());return e.opts=JSON.parse(JSON.stringify(this.opts)),e}setMaximumFeeRate(e){qc(e),this.opts.maximumFeeRate=e}setVersion(e){qc(e),Fc(this.data.inputs,"setVersion");const t=this.__CACHE;return t.__TX.version=e,t.__EXTRACTED_TX=void 0,this}setLocktime(e){qc(e),Fc(this.data.inputs,"setLocktime");const t=this.__CACHE;return t.__TX.locktime=e,t.__EXTRACTED_TX=void 0,this}setInputSequence(e,t){qc(t),Fc(this.data.inputs,"setInputSequence");const n=this.__CACHE;if(n.__TX.ins.length<=e)throw new Error("Input index too high");return n.__TX.ins[e].sequence=t,n.__EXTRACTED_TX=void 0,this}addInputs(e){return e.forEach(e=>this.addInput(e)),this}addInput(e){if(arguments.length>1||!e||void 0===e.hash||void 0===e.index)throw new Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");(0,_c.checkTaprootInputFields)(e,e,"addInput"),Fc(this.data.inputs,"addInput"),e.witnessScript&&uu(e.witnessScript);const t=this.__CACHE;this.data.addInput(e),$c(t,t.__TX.ins[t.__TX.ins.length-1]);const n=this.data.inputs.length-1,r=this.data.inputs[n];return r.nonWitnessUtxo&&ru(this.__CACHE,r,n),t.__FEE=void 0,t.__FEE_RATE=void 0,t.__EXTRACTED_TX=void 0,this}addOutputs(e){return e.forEach(e=>this.addOutput(e)),this}addOutput(e){if(arguments.length>1||!e||void 0===e.value||void 0===e.address&&void 0===e.script)throw new Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");Fc(this.data.inputs,"addOutput");const{address:t}=e;if("string"==typeof t){const{network:n}=this.opts,r=(0,Ic.toOutputScript)(t,n);e=Object.assign({},e,{script:r})}(0,_c.checkTaprootOutputFields)(e,e,"addOutput");const n=this.__CACHE;return this.data.addOutput(e),n.__FEE=void 0,n.__FEE_RATE=void 0,n.__EXTRACTED_TX=void 0,this}extractTransaction(e){if(!this.data.inputs.every(Mc))throw new Error("Not finalized");const t=this.__CACHE;if(e||function(e,t,n){const r=t.__FEE_RATE||e.getFeeRate(),i=t.__EXTRACTED_TX.virtualSize(),s=r*i;if(r>=n.maximumFeeRate)throw new Error(`Warning: You are paying around ${(s/1e8).toFixed(8)} in fees, which is ${r} satoshi per byte for a transaction with a VSize of ${i} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}(this,t,this.opts),t.__EXTRACTED_TX)return t.__EXTRACTED_TX;const n=t.__TX.clone();return iu(this.data.inputs,n,t,!0),n}getFeeRate(){return jc("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return jc("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return(0,Sc.checkForInput)(this.data.inputs,0),pu(this.data.inputs.length).forEach(e=>this.finalizeInput(e)),this}finalizeInput(e,t){const n=(0,Sc.checkForInput)(this.data.inputs,e);return(0,_c.isTaprootInput)(n)?this._finalizeTaprootInput(e,n,void 0,t):this._finalizeInput(e,n,t)}finalizeTaprootInput(e,t,n=_c.tapScriptFinalizer){const r=(0,Sc.checkForInput)(this.data.inputs,e);if((0,_c.isTaprootInput)(r))return this._finalizeTaprootInput(e,r,t,n);throw new Error(`Cannot finalize input #${e}. Not Taproot.`)}_finalizeInput(e,t,n=Gc){const{script:r,isP2SH:i,isP2WSH:s,isSegwit:o}=function(e,t,n){const r=n.__TX,i={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(i.isP2SH=!!t.redeemScript,i.isP2WSH=!!t.witnessScript,t.witnessScript)i.script=t.witnessScript;else if(t.redeemScript)i.script=t.redeemScript;else if(t.nonWitnessUtxo){const s=su(n,t,e),o=r.ins[e].index;i.script=s.outs[o].script}else t.witnessUtxo&&(i.script=t.witnessUtxo.script);return(t.witnessScript||(0,Cc.isP2WPKH)(i.script))&&(i.isSegwit=!0),i}(e,t,this.__CACHE);if(!r)throw new Error(`No script found for input #${e}`);!function(e){if(!e.sighashType||!e.partialSig)return;const{partialSig:t,sighashType:n}=e;t.forEach(e=>{const{hashType:t}=Nc.signature.decode(e.signature);if(n!==t)throw new Error("Signature sighash does not match input sighash type")})}(t);const{finalScriptSig:a,finalScriptWitness:l}=n(e,t,r,o,i,s);if(a&&this.data.updateInput(e,{finalScriptSig:a}),l&&this.data.updateInput(e,{finalScriptWitness:l}),!a&&!l)throw new Error(`Unknown error finalizing input #${e}`);return this.data.clearFinalizedInput(e),this}_finalizeTaprootInput(e,t,n,r=_c.tapScriptFinalizer){if(!t.witnessUtxo)throw new Error(`Cannot finalize input #${e}. Missing withness utxo.`);if(t.tapKeySig){const n=Ac.p2tr({output:t.witnessUtxo.script,signature:t.tapKeySig}),r=(0,Cc.witnessStackToScriptWitness)(n.witness);this.data.updateInput(e,{finalScriptWitness:r})}else{const{finalScriptWitness:i}=r(e,t,n);this.data.updateInput(e,{finalScriptWitness:i})}return this.data.clearFinalizedInput(e),this}getInputType(e){const t=(0,Sc.checkForInput)(this.data.inputs,e),n=cu(ou(e,t,this.__CACHE),e,"input",t.redeemScript||function(e){if(!e)return;const t=Nc.decompile(e);if(!t)return;const n=t[t.length-1];var r;return Buffer.isBuffer(n)&&!lu(n)&&(r=n,!Nc.isCanonicalScriptSignature(r))&&Nc.decompile(n)?n:void 0}(t.finalScriptSig),t.witnessScript||function(e){if(!e)return;const t=nu(e),n=t[t.length-1];return!lu(n)&&Nc.decompile(n)?n:void 0}(t.finalScriptWitness));return("raw"===n.type?"":n.type+"-")+du(n.meaningfulScript)}inputHasPubkey(e,t){return function(e,t,n,r){const i=ou(n,t,r),{meaningfulScript:s}=cu(i,n,"input",t.redeemScript,t.witnessScript);return(0,Cc.pubkeyInScript)(e,s)}(t,(0,Sc.checkForInput)(this.data.inputs,e),e,this.__CACHE)}inputHasHDKey(e,t){const n=(0,Sc.checkForInput)(this.data.inputs,e),r=Wc(t);return!!n.bip32Derivation&&n.bip32Derivation.some(r)}outputHasPubkey(e,t){return function(e,t,n,r){const i=r.__TX.outs[n].script,{meaningfulScript:s}=cu(i,n,"output",t.redeemScript,t.witnessScript);return(0,Cc.pubkeyInScript)(e,s)}(t,(0,Sc.checkForOutput)(this.data.outputs,e),e,this.__CACHE)}outputHasHDKey(e,t){const n=(0,Sc.checkForOutput)(this.data.outputs,e),r=Wc(t);return!!n.bip32Derivation&&n.bip32Derivation.some(r)}validateSignaturesOfAllInputs(e){return(0,Sc.checkForInput)(this.data.inputs,0),pu(this.data.inputs.length).map(t=>this.validateSignaturesOfInput(t,e)).reduce((e,t)=>!0===t&&e,!0)}validateSignaturesOfInput(e,t,n){const r=this.data.inputs[e];return(0,_c.isTaprootInput)(r)?this.validateSignaturesOfTaprootInput(e,t,n):this._validateSignaturesOfInput(e,t,n)}_validateSignaturesOfInput(e,t,n){const r=this.data.inputs[e],i=(r||{}).partialSig;if(!r||!i||i.length<1)throw new Error("No signatures to validate");if("function"!=typeof t)throw new Error("Need validator function to validate signatures");const s=n?i.filter(e=>e.pubkey.equals(n)):i;if(s.length<1)throw new Error("No signatures for this pubkey");const o=[];let a,l,c;for(const u of s){const n=Nc.signature.decode(u.signature),{hash:i,script:s}=c!==n.hashType?Yc(e,Object.assign({},r,{sighashType:n.hashType}),this.__CACHE,!0):{hash:a,script:l};c=n.hashType,a=i,l=s,Kc(u.pubkey,s,"verify"),o.push(t(u.pubkey,i,n.signature))}return o.every(e=>!0===e)}validateSignaturesOfTaprootInput(e,t,n){const r=this.data.inputs[e],i=(r||{}).tapKeySig,s=(r||{}).tapScriptSig;if(!r&&!i&&(!s||s.length))throw new Error("No signatures to validate");if("function"!=typeof t)throw new Error("Need validator function to validate signatures");const o=(n=n&&(0,_c.toXOnly)(n))?Zc(e,r,this.data.inputs,n,this.__CACHE):function(e,t,n,r){const i=[];if(t.tapInternalKey){const n=Jc(e,t,r);n&&i.push(n)}if(t.tapScriptSig){const e=t.tapScriptSig.map(e=>e.pubkey);i.push(...e)}return i.map(i=>Zc(e,t,n,i,r)).flat()}(e,r,this.data.inputs,this.__CACHE);if(!o.length)throw new Error("No signatures for this pubkey");const a=o.find(e=>!e.leafHash);let l=0;if(i&&a){if(!t(a.pubkey,a.hash,Qc(i)))return!1;l++}if(s)for(const c of s){const e=o.find(e=>c.pubkey.equals(e.pubkey));if(e){if(!t(c.pubkey,e.hash,Qc(c.signature)))return!1;l++}}return l>0}signAllInputsHD(e,t=[xc.Transaction.SIGHASH_ALL]){if(!e||!e.publicKey||!e.fingerprint)throw new Error("Need HDSigner to sign input");const n=[];for(const i of pu(this.data.inputs.length))try{this.signInputHD(i,e,t),n.push(!0)}catch(r){n.push(!1)}if(n.every(e=>!1===e))throw new Error("No inputs were signed");return this}signAllInputsHDAsync(e,t=[xc.Transaction.SIGHASH_ALL]){return new Promise((n,r)=>{if(!e||!e.publicKey||!e.fingerprint)return r(new Error("Need HDSigner to sign input"));const i=[],s=[];for(const o of pu(this.data.inputs.length))s.push(this.signInputHDAsync(o,e,t).then(()=>{i.push(!0)},()=>{i.push(!1)}));return Promise.all(s).then(()=>{if(i.every(e=>!1===e))return r(new Error("No inputs were signed"));n()})})}signInputHD(e,t,n=[xc.Transaction.SIGHASH_ALL]){if(!t||!t.publicKey||!t.fingerprint)throw new Error("Need HDSigner to sign input");return tu(e,this.data.inputs,t).forEach(t=>this.signInput(e,t,n)),this}signInputHDAsync(e,t,n=[xc.Transaction.SIGHASH_ALL]){return new Promise((r,i)=>{if(!t||!t.publicKey||!t.fingerprint)return i(new Error("Need HDSigner to sign input"));const s=tu(e,this.data.inputs,t).map(t=>this.signInputAsync(e,t,n));return Promise.all(s).then(()=>{r()}).catch(i)})}signAllInputs(e,t){if(!e||!e.publicKey)throw new Error("Need Signer to sign input");const n=[];for(const i of pu(this.data.inputs.length))try{this.signInput(i,e,t),n.push(!0)}catch(r){n.push(!1)}if(n.every(e=>!1===e))throw new Error("No inputs were signed");return this}signAllInputsAsync(e,t){return new Promise((n,r)=>{if(!e||!e.publicKey)return r(new Error("Need Signer to sign input"));const i=[],s=[];for(const[o]of this.data.inputs.entries())s.push(this.signInputAsync(o,e,t).then(()=>{i.push(!0)},()=>{i.push(!1)}));return Promise.all(s).then(()=>{if(i.every(e=>!1===e))return r(new Error("No inputs were signed"));n()})})}signInput(e,t,n){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const r=(0,Sc.checkForInput)(this.data.inputs,e);return(0,_c.isTaprootInput)(r)?this._signTaprootInput(e,r,t,void 0,n):this._signInput(e,t,n)}signTaprootInput(e,t,n,r){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const i=(0,Sc.checkForInput)(this.data.inputs,e);if((0,_c.isTaprootInput)(i))return this._signTaprootInput(e,i,t,n,r);throw new Error(`Input #${e} is not of type Taproot.`)}_signInput(e,t,n=[xc.Transaction.SIGHASH_ALL]){const{hash:r,sighashType:i}=zc(this.data.inputs,e,t.publicKey,this.__CACHE,n),s=[{pubkey:t.publicKey,signature:Nc.signature.encode(t.sign(r),i)}];return this.data.updateInput(e,{partialSig:s}),this}_signTaprootInput(e,t,n,r,i=[xc.Transaction.SIGHASH_DEFAULT]){const s=this.checkTaprootHashesForSig(e,t,n,r,i),o=s.filter(e=>!e.leafHash).map(e=>(0,_c.serializeTaprootSignature)(n.signSchnorr(e.hash),t.sighashType))[0],a=s.filter(e=>!!e.leafHash).map(e=>({pubkey:(0,_c.toXOnly)(n.publicKey),signature:(0,_c.serializeTaprootSignature)(n.signSchnorr(e.hash),t.sighashType),leafHash:e.leafHash}));return o&&this.data.updateInput(e,{tapKeySig:o}),a.length&&this.data.updateInput(e,{tapScriptSig:a}),this}signInputAsync(e,t,n){return Promise.resolve().then(()=>{if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const r=(0,Sc.checkForInput)(this.data.inputs,e);return(0,_c.isTaprootInput)(r)?this._signTaprootInputAsync(e,r,t,void 0,n):this._signInputAsync(e,t,n)})}signTaprootInputAsync(e,t,n,r){return Promise.resolve().then(()=>{if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const i=(0,Sc.checkForInput)(this.data.inputs,e);if((0,_c.isTaprootInput)(i))return this._signTaprootInputAsync(e,i,t,n,r);throw new Error(`Input #${e} is not of type Taproot.`)})}_signInputAsync(e,t,n=[xc.Transaction.SIGHASH_ALL]){const{hash:r,sighashType:i}=zc(this.data.inputs,e,t.publicKey,this.__CACHE,n);return Promise.resolve(t.sign(r)).then(n=>{const r=[{pubkey:t.publicKey,signature:Nc.signature.encode(n,i)}];this.data.updateInput(e,{partialSig:r})})}_signTaprootInputAsync(e,t,n,r){return f(this,arguments,function*(e,t,n,r,i=[xc.Transaction.SIGHASH_DEFAULT]){const s=this.checkTaprootHashesForSig(e,t,n,r,i),o=[],a=s.filter(e=>!e.leafHash)[0];if(a){const e=Promise.resolve(n.signSchnorr(a.hash)).then(e=>({tapKeySig:(0,_c.serializeTaprootSignature)(e,t.sighashType)}));o.push(e)}const l=s.filter(e=>!!e.leafHash);if(l.length){const e=l.map(e=>Promise.resolve(n.signSchnorr(e.hash)).then(r=>({tapScriptSig:[{pubkey:(0,_c.toXOnly)(n.publicKey),signature:(0,_c.serializeTaprootSignature)(r,t.sighashType),leafHash:e.leafHash}]})));o.push(...e)}return Promise.all(o).then(t=>{t.forEach(t=>this.data.updateInput(e,t))})})}checkTaprootHashesForSig(e,t,n,r,i){if("function"!=typeof n.signSchnorr)throw new Error(`Need Schnorr Signer to sign taproot input #${e}.`);const s=Zc(e,t,this.data.inputs,n.publicKey,this.__CACHE,r,i);if(!s||!s.length)throw new Error(`Can not sign for input #${e} with the key ${n.publicKey.toString("hex")}`);return s}toBuffer(){return Lc(this.__CACHE),this.data.toBuffer()}toHex(){return Lc(this.__CACHE),this.data.toHex()}toBase64(){return Lc(this.__CACHE),this.data.toBase64()}updateGlobal(e){return this.data.updateGlobal(e),this}updateInput(e,t){return t.witnessScript&&uu(t.witnessScript),(0,_c.checkTaprootInputFields)(this.data.inputs[e],t,"updateInput"),this.data.updateInput(e,t),t.nonWitnessUtxo&&ru(this.__CACHE,this.data.inputs[e],e),this}updateOutput(e,t){const n=this.data.outputs[e];return(0,_c.checkTaprootOutputFields)(n,t,"updateOutput"),this.data.updateOutput(e,t),this}addUnknownKeyValToGlobal(e){return this.data.addUnknownKeyValToGlobal(e),this}addUnknownKeyValToInput(e,t){return this.data.addUnknownKeyValToInput(e,t),this}addUnknownKeyValToOutput(e,t){return this.data.addUnknownKeyValToOutput(e,t),this}clearFinalizedInput(e){return this.data.clearFinalizedInput(e),this}}ia.Psbt=Oc;const Uc=e=>new Rc(e);class Rc{constructor(e=Buffer.from([2,0,0,0,0,0,0,0,0,0])){this.tx=xc.Transaction.fromBuffer(e),function(e){if(!e.ins.every(e=>e.script&&0===e.script.length&&e.witness&&0===e.witness.length))throw new Error("Format Error: Transaction ScriptSigs are not empty")}(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(e){if(void 0===e.hash||void 0===e.index||!Buffer.isBuffer(e.hash)&&"string"!=typeof e.hash||"number"!=typeof e.index)throw new Error("Error adding input.");const t="string"==typeof e.hash?(0,Tc.reverseBuffer)(Buffer.from(e.hash,"hex")):e.hash;this.tx.addInput(t,e.index,e.sequence)}addOutput(e){if(void 0===e.script||void 0===e.value||!Buffer.isBuffer(e.script)||"number"!=typeof e.value)throw new Error("Error adding output.");this.tx.addOutput(e.script,e.value)}toBuffer(){return this.tx.toBuffer()}}function Lc(e){if(!1!==e.__UNSAFE_SIGN_NONSEGWIT)throw new Error("Not BIP174 compliant, can not export")}function Hc(e,t,n){if(!t)return!1;let r;if(r=n?n.map(e=>{const n=function(e){if(65===e.length){const t=1&e[64],n=e.slice(0,33);return n[0]=2|t,n}return e.slice()}(e);return t.find(e=>e.pubkey.equals(n))}).filter(e=>!!e):t,r.length>e)throw new Error("Too many signatures");return r.length===e}function Mc(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function Wc(e){return t=>!!t.masterFingerprint.equals(e.fingerprint)&&!!e.derivePath(t.path).publicKey.equals(t.pubkey)}function qc(e){if("number"!=typeof e||e!==Math.floor(e)||e>4294967295||e<0)throw new Error("Invalid 32 bit integer")}function Fc(e,t){e.forEach(e=>{if((0,_c.isTaprootInput)(e)?(0,_c.checkTaprootInputForSigs)(e,t):(0,Cc.checkInputForSig)(e,t))throw new Error("Can not modify transaction, signatures exist.")})}function Kc(e,t,n){if(!(0,Cc.pubkeyInScript)(e,t))throw new Error(`Can not ${n} for this input with the key ${e.toString("hex")}`)}function $c(e,t){const n=(0,Tc.reverseBuffer)(Buffer.from(t.hash)).toString("hex")+":"+t.index;if(e.__TX_IN_CACHE[n])throw new Error("Duplicate input detected.");e.__TX_IN_CACHE[n]=1}function Dc(e,t){return(n,r,i,s)=>{const o=e({redeem:{output:i}}).output;if(!r.equals(o))throw new Error(`${t} for ${s} #${n} doesn't match the scriptPubKey in the prevout`)}}const Xc=Dc(Ac.p2sh,"Redeem script"),Vc=Dc(Ac.p2wsh,"Witness script");function jc(e,t,n,r){if(!n.every(Mc))throw new Error(`PSBT must be finalized to calculate ${t}`);if("__FEE_RATE"===e&&r.__FEE_RATE)return r.__FEE_RATE;if("__FEE"===e&&r.__FEE)return r.__FEE;let i,s=!0;return r.__EXTRACTED_TX?(i=r.__EXTRACTED_TX,s=!1):i=r.__TX.clone(),iu(n,i,r,s),"__FEE_RATE"===e?r.__FEE_RATE:"__FEE"===e?r.__FEE:void 0}function Gc(e,t,n,r,i,s){const o=du(n);if(!function(e,t,n){switch(n){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return Hc(1,e.partialSig);case"multisig":const n=Ac.p2ms({output:t});return Hc(n.m,e.partialSig,n.pubkeys);default:return!1}}(t,n,o))throw new Error(`Can not finalize input #${e}`);return function(e,t,n,r,i,s){let o,a;const l=function(e,t,n){let r;switch(t){case"multisig":const t=function(e,t){return Ac.p2ms({output:e}).pubkeys.map(e=>(t.filter(t=>t.pubkey.equals(e))[0]||{}).signature).filter(e=>!!e)}(e,n);r=Ac.p2ms({output:e,signatures:t});break;case"pubkey":r=Ac.p2pk({output:e,signature:n[0].signature});break;case"pubkeyhash":r=Ac.p2pkh({output:e,pubkey:n[0].pubkey,signature:n[0].signature});break;case"witnesspubkeyhash":r=Ac.p2wpkh({output:e,pubkey:n[0].pubkey,signature:n[0].signature})}return r}(e,t,n),c=s?Ac.p2wsh({redeem:l}):null,u=i?Ac.p2sh({redeem:c||l}):null;return r?(a=c?(0,Cc.witnessStackToScriptWitness)(c.witness):(0,Cc.witnessStackToScriptWitness)(l.witness),u&&(o=u.input)):o=u?u.input:l.input,{finalScriptSig:o,finalScriptWitness:a}}(n,o,t.partialSig,r,i,s)}function zc(e,t,n,r,i){const s=(0,Sc.checkForInput)(e,t),{hash:o,sighashType:a,script:l}=Yc(t,s,r,!1,i);return Kc(n,l,"sign"),{hash:o,sighashType:a}}function Yc(e,t,n,r,i){const s=n.__TX,o=t.sighashType||xc.Transaction.SIGHASH_ALL;let a,l;if(eu(o,i),t.nonWitnessUtxo){const r=su(n,t,e),i=s.ins[e].hash,o=r.getHash();if(!i.equals(o))throw new Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`);const a=s.ins[e].index;l=r.outs[a]}else{if(!t.witnessUtxo)throw new Error("Need a Utxo input item for signing");l=t.witnessUtxo}const{meaningfulScript:c,type:u}=cu(l.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(u)>=0)a=s.hashForWitnessV0(e,c,l.value,o);else if((0,Cc.isP2WPKH)(c)){const t=Ac.p2pkh({hash:c.slice(2)}).output;a=s.hashForWitnessV0(e,t,l.value,o)}else{if(void 0===t.nonWitnessUtxo&&!1===n.__UNSAFE_SIGN_NONSEGWIT)throw new Error(`Input #${e} has witnessUtxo but non-segwit script: ${c.toString("hex")}`);r||!1===n.__UNSAFE_SIGN_NONSEGWIT||console.warn("Warning: Signing non-segwit inputs without the full parent transaction means there is a chance that a miner could feed you incorrect information to trick you into paying large fees. This behavior is the same as Psbt's predecessor (TransactionBuilder - now removed) when signing non-segwit scripts. You are not able to export this Psbt with toBuffer|toBase64|toHex since it is not BIP174 compliant.\n*********************\nPROCEED WITH CAUTION!\n*********************"),a=s.hashForSignature(e,c,o)}return{script:c,sighashType:o,hash:a}}function Jc(e,t,n){const{script:r}=au(e,t,n);return(0,Cc.isP2TR)(r)?r.subarray(2,34):null}function Qc(e){return 64===e.length?e:e.subarray(0,64)}function Zc(e,t,n,r,i,s,o){const a=i.__TX,l=t.sighashType||xc.Transaction.SIGHASH_DEFAULT;eu(l,o);const c=n.map((e,t)=>au(t,e,i)),u=c.map(e=>e.script),d=c.map(e=>e.value),p=[];if(t.tapInternalKey&&!s){const n=Jc(e,t,i)||Buffer.from([]);if((0,_c.toXOnly)(r).equals(n)){const t=a.hashForWitnessV1(e,u,d,l);p.push({pubkey:r,hash:t})}}const h=(t.tapLeafScript||[]).filter(e=>(0,Cc.pubkeyInScript)(r,e.script)).map(e=>{const t=(0,Bc.tapleafHash)({output:e.script,version:e.leafVersion});return Object.assign({hash:t},e)}).filter(e=>!s||s.equals(e.hash)).map(t=>{const n=a.hashForWitnessV1(e,u,d,l,t.hash);return{pubkey:r,hash:n,leafHash:t.hash}});return p.concat(h)}function eu(e,t){if(t&&t.indexOf(e)<0){const t=function(e){let t=e&xc.Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";switch(31&e){case xc.Transaction.SIGHASH_ALL:t+="SIGHASH_ALL";break;case xc.Transaction.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case xc.Transaction.SIGHASH_NONE:t+="SIGHASH_NONE"}return t}(e);throw new Error(`Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: ${t}`)}}function tu(e,t,n){const r=(0,Sc.checkForInput)(t,e);if(!r.bip32Derivation||0===r.bip32Derivation.length)throw new Error("Need bip32Derivation to sign with HD");const i=r.bip32Derivation.map(e=>e.masterFingerprint.equals(n.fingerprint)?e:void 0).filter(e=>!!e);if(0===i.length)throw new Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");return i.map(e=>{const t=n.derivePath(e.path);if(!e.pubkey.equals(t.publicKey))throw new Error("pubkey did not match bip32Derivation");return t})}function nu(e){let t=0;function n(){const n=Ec.decode(e,t);return t+=Ec.decode.bytes,n}function r(){return r=n(),t+=r,e.slice(t-r,t);var r}return function(){const e=n(),t=[];for(let n=0;n<e;n++)t.push(r());return t}()}function ru(e,t,n){e.__NON_WITNESS_UTXO_BUF_CACHE[n]=t.nonWitnessUtxo;const r=xc.Transaction.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[n]=r;const i=e,s=n;delete t.nonWitnessUtxo,Object.defineProperty(t,"nonWitnessUtxo",{enumerable:!0,get(){const e=i.__NON_WITNESS_UTXO_BUF_CACHE[s],t=i.__NON_WITNESS_UTXO_TX_CACHE[s];if(void 0!==e)return e;{const e=t.toBuffer();return i.__NON_WITNESS_UTXO_BUF_CACHE[s]=e,e}},set(e){i.__NON_WITNESS_UTXO_BUF_CACHE[s]=e}})}function iu(e,t,n,r){let i=0;e.forEach((e,s)=>{if(r&&e.finalScriptSig&&(t.ins[s].script=e.finalScriptSig),r&&e.finalScriptWitness&&(t.ins[s].witness=nu(e.finalScriptWitness)),e.witnessUtxo)i+=e.witnessUtxo.value;else if(e.nonWitnessUtxo){const r=su(n,e,s),o=t.ins[s].index,a=r.outs[o];i+=a.value}});const s=t.outs.reduce((e,t)=>e+t.value,0),o=i-s;if(o<0)throw new Error("Outputs are spending more than Inputs");const a=t.virtualSize();n.__FEE=o,n.__EXTRACTED_TX=t,n.__FEE_RATE=Math.floor(o/a)}function su(e,t,n){const r=e.__NON_WITNESS_UTXO_TX_CACHE;return r[n]||ru(e,t,n),r[n]}function ou(e,t,n){const{script:r}=au(e,t,n);return r}function au(e,t,n){if(void 0!==t.witnessUtxo)return{script:t.witnessUtxo.script,value:t.witnessUtxo.value};if(void 0!==t.nonWitnessUtxo){const r=su(n,t,e).outs[n.__TX.ins[e].index];return{script:r.script,value:r.value}}throw new Error("Can't find pubkey in input without Utxo data")}function lu(e){return 33===e.length&&Nc.isCanonicalPubKey(e)}function cu(e,t,n,r,i){const s=(0,Cc.isP2SHScript)(e),o=s&&r&&(0,Cc.isP2WSHScript)(r),a=(0,Cc.isP2WSHScript)(e);if(s&&void 0===r)throw new Error("scriptPubkey is P2SH but redeemScript missing");if((a||o)&&void 0===i)throw new Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");let l;return o?(l=i,Xc(t,e,r,n),Vc(t,r,i,n),uu(l)):a?(l=i,Vc(t,e,i,n),uu(l)):s?(l=r,Xc(t,e,r,n)):l=e,{meaningfulScript:l,type:o?"p2sh-p2wsh":s?"p2sh":a?"p2wsh":"raw"}}function uu(e){if((0,Cc.isP2WPKH)(e)||(0,Cc.isP2SHScript)(e))throw new Error("P2WPKH or P2SH can not be contained within P2WSH")}function du(e){return(0,Cc.isP2WPKH)(e)?"witnesspubkeyhash":(0,Cc.isP2PKH)(e)?"pubkeyhash":(0,Cc.isP2MS)(e)?"multisig":(0,Cc.isP2PK)(e)?"pubkey":"nonstandard"}function pu(e){return[...Array(e).keys()]}!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.initEccLib=e.Transaction=e.opcodes=e.Psbt=e.Block=e.script=e.payments=e.networks=e.crypto=e.address=void 0;const t=Ao();e.address=t;const n=Ur;e.crypto=n;const r=fn;e.networks=r;const i=Po();e.payments=i;const s=hr();e.script=s;var o=Bo;Object.defineProperty(e,"Block",{enumerable:!0,get:function(){return o.Block}});var a=ia;Object.defineProperty(e,"Psbt",{enumerable:!0,get:function(){return a.Psbt}});var l=bn;Object.defineProperty(e,"opcodes",{enumerable:!0,get:function(){return l.OPS}});var c=xo;Object.defineProperty(e,"Transaction",{enumerable:!0,get:function(){return c.Transaction}});var u=no;Object.defineProperty(e,"initEccLib",{enumerable:!0,get:function(){return u.initEccLib}})}(pn);const hu=t({__proto__:null,default:dn(pn)},[pn])}},function(){return S||(0,E[r(E)[0]])((S={exports:{}}).exports,S),S.exports});export default I();

</script>
  <style>
.inscription-item{padding:var(--spacing-lg);border-radius:var(--radius-md);cursor:pointer;transition:all var(--transition-fast);position:relative;display:flex;flex-direction:column;gap:var(--spacing-md)}.light-theme .inscription-item{background:var(--color-card-light);border:1px solid var(--color-border-light)}.dark-theme .inscription-item{background:var(--color-card-dark);border:1px solid var(--color-border-dark)}.inscription-item:hover{border-color:var(--color-purple-600);transform:translateY(-2px)}.light-theme .inscription-item:hover{box-shadow:0 4px 12px #9333ea1a}.dark-theme .inscription-item:hover{box-shadow:0 4px 12px #9333ea33}.inscription-header{display:flex;align-items:center;gap:var(--spacing-sm);flex-wrap:wrap}.inscription-badge{display:inline-flex;align-items:center;padding:.375rem .75rem;border-radius:9999px;font-size:.875rem;font-weight:700;background:var(--color-purple-100);color:var(--color-purple-700)}.content-type-pill{display:inline-flex;align-items:center;padding:.25rem .625rem;border-radius:9999px;font-size:.75rem;font-weight:600}.light-theme .content-type-pill{background:#0000000d;color:var(--color-text-secondary-light)}.dark-theme .content-type-pill{background:#ffffff1a;color:var(--color-text-secondary-dark)}.inscription-id-display{font-size:.875rem;word-break:break-all;opacity:.7}.inscription-arrow{position:absolute;right:var(--spacing-lg);top:50%;transform:translateY(-50%);font-size:1.25rem;opacity:0;transition:all var(--transition-fast)}.light-theme .inscription-arrow,.dark-theme .inscription-arrow{color:var(--color-purple-600)}.inscription-item:hover .inscription-arrow{opacity:1;transform:translateY(-50%) translate(4px)}@media (max-width: 768px){.inscription-item{padding:var(--spacing-md)}.inscription-badge{font-size:.8125rem}.inscription-arrow{display:none}}.xverse-panel{margin:2rem 0;background:linear-gradient(135deg,#8b45ff1a,#582ccc1a);border:2px solid rgba(139,69,255,.3);border-radius:16px;padding:2rem;animation:slideIn .5s ease-out}@keyframes slideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.xverse-header{text-align:center;margin-bottom:2rem}.xverse-header h2{font-size:2rem;margin:0 0 .5rem;color:#8b45ff;text-shadow:0 0 20px rgba(139,69,255,.5)}.xverse-header p{color:#ffffffb3;margin:0}.xverse-tabs{display:flex;gap:1rem;margin-bottom:2rem;border-bottom:2px solid rgba(139,69,255,.2);flex-wrap:wrap}.xverse-tab{background:transparent;border:none;color:#fff9;padding:1rem 1.5rem;font-size:1rem;font-weight:600;cursor:pointer;border-bottom:3px solid transparent;transition:all .3s ease;position:relative;bottom:-2px}.xverse-tab:hover{color:#ffffffe6;background:#8b45ff1a}.xverse-tab.active{color:#8b45ff;border-bottom-color:#8b45ff;background:#8b45ff26}.xverse-content{display:grid;gap:1.5rem}.xverse-section{background:#1e1e2899;border:1px solid rgba(139,69,255,.2);border-radius:12px;padding:1.5rem;transition:all .3s ease}.xverse-section:hover{border-color:#8b45ff66;box-shadow:0 4px 20px #8b45ff26;transform:translateY(-2px)}.xverse-section h3{margin:0 0 .5rem;color:#8b45ff;font-size:1.2rem}.xverse-section p{margin:0 0 1rem;color:#fff9;font-size:.9rem}.xverse-note{font-size:.85rem;font-style:italic;color:#ffffff80}.xverse-section input,.xverse-section textarea{width:100%;padding:.75rem;margin-bottom:.75rem;background:#14141ecc;border:1px solid rgba(139,69,255,.3);border-radius:8px;color:#fff;font-family:Courier New,monospace;font-size:.9rem;transition:all .3s ease}.xverse-section input:focus,.xverse-section textarea:focus{outline:none;border-color:#8b45ff;box-shadow:0 0 0 3px #8b45ff33}.xverse-section textarea{resize:vertical;min-height:80px}.xverse-section button{background:linear-gradient(135deg,#8b45ff,#582ccc);border:none;border-radius:8px;color:#fff;padding:.75rem 1.5rem;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s ease;width:100%;margin-top:.5rem}.xverse-section button:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #8b45ff66}.xverse-section button:disabled{opacity:.5;cursor:not-allowed}.xverse-result{background:#2ed5731a;border:2px solid rgba(46,213,115,.3);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem;position:relative}.xverse-result h3{margin:0 0 1rem;color:#2ed573;font-size:1.1rem}.xverse-result pre{background:#00000080;border:1px solid rgba(46,213,115,.2);border-radius:8px;padding:1rem;overflow-x:auto;color:#a8e6cf;font-size:.85rem;margin:0 0 1rem;max-height:400px;overflow-y:auto}.xverse-result button{background:#2ed57333;border:1px solid rgba(46,213,115,.4);color:#2ed573;padding:.5rem 1rem;border-radius:6px;cursor:pointer;font-weight:600;transition:all .3s ease}.xverse-result button:hover{background:#2ed5734d;transform:translateY(-2px)}.xverse-error{background:#ff47571a;border:2px solid rgba(255,71,87,.3);border-radius:12px;padding:1rem 1.5rem;margin-bottom:1.5rem;color:#ff4757;display:flex;justify-content:space-between;align-items:center;animation:shake .5s ease}@keyframes shake{0%,to{transform:translate(0)}25%{transform:translate(-10px)}75%{transform:translate(10px)}}.xverse-error button{background:transparent;border:none;color:#ff4757;font-size:1.5rem;cursor:pointer;padding:0;width:auto;line-height:1;transition:all .3s ease}.xverse-error button:hover{transform:scale(1.2)}.xverse-loading{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#14141ef2;border:2px solid rgba(139,69,255,.5);border-radius:16px;padding:2rem;text-align:center;z-index:9999;box-shadow:0 10px 40px #00000080}.spinner{border:4px solid rgba(139,69,255,.2);border-top:4px solid #8b45ff;border-radius:50%;width:50px;height:50px;animation:spin 1s linear infinite;margin:0 auto 1rem}.xverse-loading p{color:#8b45ff;font-weight:600;margin:0}.runes-balance-display{margin-top:1rem;padding:1rem;background:#0000004d;border:1px solid rgba(139,69,255,.2);border-radius:8px}.runes-balance-display pre{margin:0;color:#a8b2ff;font-size:.85rem;white-space:pre-wrap;word-wrap:break-word}@media (max-width: 768px){.xverse-panel{padding:1rem}.xverse-tabs{flex-direction:column;gap:.5rem}.xverse-tab{width:100%;text-align:center}.xverse-section{padding:1rem}}body.dark-mode .xverse-panel{background:linear-gradient(135deg,#8b45ff26,#582ccc26)}body:not(.dark-mode) .xverse-panel{background:linear-gradient(135deg,#8b45ff0d,#582ccc0d)}body:not(.dark-mode) .xverse-section{background:#fffc}body:not(.dark-mode) .xverse-section input,body:not(.dark-mode) .xverse-section textarea{background:#ffffffe6;color:#333}body:not(.dark-mode) .xverse-section p{color:#0009}:root{--color-bg-light: #f9fafb;--color-card-light: #ffffff;--color-text-light: #111827;--color-text-secondary-light: #6b7280;--color-border-light: #e5e7eb;--color-bg-dark: #111827;--color-card-dark: rgba(31, 41, 55, .5);--color-text-dark: #ffffff;--color-text-secondary-dark: #9ca3af;--color-border-dark: #374151;--color-purple-600: #9333ea;--color-purple-700: #7e22ce;--color-purple-50: #faf5ff;--color-purple-100: #f3e8ff;--spacing-xs: .5rem;--spacing-sm: .75rem;--spacing-md: 1rem;--spacing-lg: 1.5rem;--spacing-xl: 2rem;--spacing-2xl: 3rem;--radius-sm: 8px;--radius-md: 12px;--radius-lg: 16px;--radius-xl: 24px;--transition-fast: .2s ease;--transition-base: .3s ease}*{box-sizing:border-box;margin:0;padding:0}body{margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;overflow-x:hidden}.nexus-wallet-app{min-height:100vh;transition:background-color var(--transition-base),color var(--transition-base)}.nexus-wallet-app.light-theme{background-color:var(--color-bg-light);color:var(--color-text-light)}.nexus-wallet-app.dark-theme{background-color:var(--color-bg-dark);color:var(--color-text-dark)}.top-navigation{position:fixed;top:0;left:0;right:0;z-index:1000;padding:var(--spacing-md) var(--spacing-xl);display:flex;justify-content:space-between;align-items:center;backdrop-filter:blur(10px);transition:all var(--transition-base)}.light-theme .top-navigation{background-color:#ffffffe6;border-bottom:1px solid var(--color-border-light)}.dark-theme .top-navigation{background-color:#111827e6;border-bottom:1px solid var(--color-border-dark)}.nav-left{display:flex;align-items:center;gap:var(--spacing-md)}.nav-logo{width:40px;height:40px;background:linear-gradient(135deg,#9333ea,#3b82f6);border-radius:var(--radius-sm);display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff;font-size:1.25rem}.nav-title-group{display:flex;flex-direction:column}.nav-title{font-size:1.125rem;font-weight:700;line-height:1.2}.nav-subtitle{font-size:.75rem;font-weight:500;opacity:.6;letter-spacing:.05em}.nav-right{display:flex;align-items:center;gap:var(--spacing-md)}.main-content{max-width:1280px;margin:0 auto;padding:calc(70px + var(--spacing-xl)) var(--spacing-xl) var(--spacing-xl)}@media (max-width: 768px){.main-content{padding:calc(70px + var(--spacing-md)) var(--spacing-md) var(--spacing-md)}}.welcome-screen{display:flex;justify-content:center;align-items:center;min-height:calc(100vh - 140px)}.welcome-card{max-width:600px;width:100%;padding:var(--spacing-2xl);border-radius:var(--radius-xl);text-align:center;transition:all var(--transition-base)}.light-theme .welcome-card{background:var(--color-card-light);border:1px solid var(--color-border-light);box-shadow:0 20px 25px -5px #0000001a}.dark-theme .welcome-card{background:var(--color-card-dark);border:1px solid var(--color-border-dark);backdrop-filter:blur(10px)}.welcome-icon{width:80px;height:80px;background:linear-gradient(135deg,#9333ea,#3b82f6);border-radius:var(--radius-lg);margin:0 auto var(--spacing-xl);display:flex;align-items:center;justify-content:center;font-size:2.5rem}.welcome-heading{font-size:2rem;font-weight:700;margin-bottom:var(--spacing-md)}.welcome-description{font-size:1rem;margin-bottom:var(--spacing-xl);line-height:1.6}.light-theme .welcome-description{color:var(--color-text-secondary-light)}.dark-theme .welcome-description{color:var(--color-text-secondary-dark)}.tab-navigation{padding:var(--spacing-sm);border-radius:var(--radius-lg);margin-bottom:var(--spacing-xl);display:flex;justify-content:space-between;align-items:center;gap:var(--spacing-md);transition:all var(--transition-base)}.light-theme .tab-navigation{background:var(--color-card-light);border:1px solid var(--color-border-light)}.dark-theme .tab-navigation{background:var(--color-card-dark);border:1px solid var(--color-border-dark)}.tab-navigation-left{display:inline-flex;gap:var(--spacing-xs);flex:1}.tab-navigation-right{display:flex;align-items:center}.tab-button{padding:var(--spacing-sm) var(--spacing-lg);border-radius:var(--radius-sm);border:none;background:none;cursor:pointer;font-size:.875rem;font-weight:600;transition:all var(--transition-fast);white-space:nowrap}.light-theme .tab-button{color:var(--color-text-secondary-light)}.dark-theme .tab-button{color:var(--color-text-secondary-dark)}.tab-button:hover{opacity:.7}.tab-button.active{background:var(--color-purple-600);color:#fff}.tab-button:disabled{opacity:.4;cursor:not-allowed}.card{padding:var(--spacing-xl);border-radius:var(--radius-lg);transition:all var(--transition-base)}.light-theme .card{background:var(--color-card-light);border:1px solid var(--color-border-light)}.dark-theme .card{background:var(--color-card-dark);border:1px solid var(--color-border-dark);backdrop-filter:blur(10px)}.card-header{margin-bottom:var(--spacing-lg)}.card-title{font-size:1.25rem;font-weight:700;margin-bottom:var(--spacing-xs)}.card-subtitle{font-size:.875rem}.light-theme .card-subtitle{color:var(--color-text-secondary-light)}.dark-theme .card-subtitle{color:var(--color-text-secondary-dark)}.grid-2col{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:var(--spacing-lg);margin-bottom:var(--spacing-lg)}@media (max-width: 768px){.grid-2col{grid-template-columns:1fr}}.btn{padding:.625rem 1rem;border-radius:var(--radius-sm);border:none;font-size:.875rem;font-weight:600;cursor:pointer;transition:all var(--transition-fast);display:inline-flex;align-items:center;justify-content:center;gap:var(--spacing-xs)}.btn:disabled{opacity:.5;cursor:not-allowed}.btn-primary{background:var(--color-purple-600);color:#fff}.btn-primary:hover:not(:disabled){background:var(--color-purple-700)}.btn-secondary{color:inherit}.light-theme .btn-secondary{background:var(--color-bg-light);border:1px solid var(--color-border-light)}.dark-theme .btn-secondary{background:#4b556380;border:1px solid var(--color-border-dark)}.btn-secondary:hover:not(:disabled){opacity:.8}.btn-large{padding:1rem 2rem;font-size:1rem}.btn-sm{padding:.5rem 1rem;font-size:.875rem}.btn-icon{width:40px;height:40px;padding:0;border-radius:var(--radius-sm)}h1,h2,h3,h4,h5,h6{font-weight:700;line-height:1.2}.text-3xl{font-size:1.875rem}.text-2xl{font-size:1.5rem}.text-xl{font-size:1.25rem}.text-lg{font-size:1.125rem}.text-base{font-size:1rem}.text-sm{font-size:.875rem}.text-xs{font-size:.75rem}.monospace{font-family:Courier New,Courier,monospace}.address-section{margin-bottom:var(--spacing-md)}.address-label{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;margin-bottom:var(--spacing-xs);opacity:.7}.address-display{padding:var(--spacing-md);border-radius:var(--radius-sm);font-family:Courier New,monospace;font-size:.875rem;word-break:break-all;transition:all var(--transition-base)}.light-theme .address-display{background:var(--color-bg-light);border:1px solid var(--color-border-light);color:var(--color-text-light)}.dark-theme .address-display{background:#0000004d;border:1px solid var(--color-border-dark);color:var(--color-text-dark)}.balance-display{font-size:2rem;font-weight:700;margin:var(--spacing-md) 0}.balance-amount{display:block}.balance-note{font-size:.875rem;font-weight:400;margin-top:var(--spacing-xs);opacity:.7;font-style:italic}.balance-unavailable{color:#f59e0b;font-size:1rem;font-weight:500}.balance-label{font-size:.875rem;font-weight:500;margin-bottom:var(--spacing-xs)}.light-theme .balance-label{color:var(--color-text-secondary-light)}.dark-theme .balance-label{color:var(--color-text-secondary-dark)}.action-buttons{display:flex;gap:var(--spacing-md);margin-top:var(--spacing-lg)}@media (max-width: 640px){.action-buttons{flex-direction:column}.action-buttons .btn{width:100%}}.stat-item{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-md) 0;border-bottom:1px solid}.light-theme .stat-item{border-bottom-color:var(--color-border-light)}.dark-theme .stat-item{border-bottom-color:var(--color-border-dark)}.stat-item:last-child{border-bottom:none}.stat-label{font-size:.875rem;font-weight:500}.light-theme .stat-label{color:var(--color-text-secondary-light)}.dark-theme .stat-label{color:var(--color-text-secondary-dark)}.stat-value{font-size:.875rem;font-weight:600}.inscriptions-list{display:flex;flex-direction:column;gap:var(--spacing-md)}.empty-state{text-align:center;padding:var(--spacing-2xl)}.light-theme .empty-state{color:var(--color-text-secondary-light)}.dark-theme .empty-state{color:var(--color-text-secondary-dark)}.modal-overlay{position:fixed;inset:0;background:#000000d9;backdrop-filter:blur(4px);display:flex;justify-content:center;align-items:center;z-index:2000;padding:var(--spacing-md)}.modal-card{max-width:448px;width:100%;max-height:90vh;overflow-y:auto;border-radius:var(--radius-lg);transition:all var(--transition-base)}.light-theme .modal-card{background:var(--color-card-light);border:1px solid var(--color-border-light)}.dark-theme .modal-card{background:var(--color-card-dark);border:1px solid var(--color-border-dark)}.modal-header{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-xl);border-bottom:1px solid}.light-theme .modal-header{border-bottom-color:var(--color-border-light)}.dark-theme .modal-header{border-bottom-color:var(--color-border-dark)}.modal-title{font-size:1.25rem;font-weight:700}.modal-close{width:32px;height:32px;border-radius:50%;border:none;background:none;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all var(--transition-fast)}.modal-close:hover{background:#0000001a}.modal-body{padding:var(--spacing-xl)}.form-group{margin-bottom:var(--spacing-lg)}.form-label{display:block;font-size:.875rem;font-weight:600;margin-bottom:var(--spacing-xs)}.form-input,.form-select,.form-textarea{width:100%;padding:var(--spacing-sm) var(--spacing-md);border-radius:var(--radius-sm);border:1px solid;font-size:.875rem;transition:all var(--transition-fast)}.light-theme .form-input,.light-theme .form-select,.light-theme .form-textarea{background:var(--color-card-light);border-color:var(--color-border-light);color:var(--color-text-light)}.dark-theme .form-input,.dark-theme .form-select,.dark-theme .form-textarea{background:#0000004d;border-color:var(--color-border-dark);color:var(--color-text-dark)}.form-input:focus,.form-select:focus,.form-textarea:focus{outline:none;border-color:var(--color-purple-600)}.form-textarea{min-height:100px;resize:vertical}.badge{display:inline-flex;align-items:center;padding:.25rem .75rem;border-radius:9999px;font-size:.75rem;font-weight:600}.badge-purple{background:var(--color-purple-100);color:var(--color-purple-700)}.badge-gray{background:#0000001a}.light-theme .badge-gray{color:var(--color-text-secondary-light)}.dark-theme .badge-gray{background:#ffffff1a;color:var(--color-text-secondary-dark)}.loading-state{display:flex;justify-content:center;align-items:center;padding:var(--spacing-xl)}.spinner{border:3px solid rgba(147,51,234,.3);border-top-color:var(--color-purple-600);border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.error-message{padding:var(--spacing-md);border-radius:var(--radius-sm);background:#dc26261a;border:1px solid rgba(220,38,38,.3);color:#dc2626;font-size:.875rem}.success-message{padding:var(--spacing-md);border-radius:var(--radius-sm);background:#22c55e1a;border:1px solid rgba(34,197,94,.3);color:#16a34a;font-size:.875rem}.flex{display:flex}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-between{justify-content:space-between}.justify-center{justify-content:center}.gap-sm{gap:var(--spacing-sm)}.gap-md{gap:var(--spacing-md)}.gap-lg{gap:var(--spacing-lg)}.text-center{text-align:center}.mb-sm{margin-bottom:var(--spacing-sm)}.mb-md{margin-bottom:var(--spacing-md)}.mb-lg{margin-bottom:var(--spacing-lg)}.mt-sm{margin-top:var(--spacing-sm)}.mt-md{margin-top:var(--spacing-md)}.mt-lg{margin-top:var(--spacing-lg)}.info-message{padding:var(--spacing-sm);border-radius:var(--radius-md);background:#3b82f61a;color:#3b82f6;text-align:center}.info-display{padding:var(--spacing-sm) var(--spacing-md);border-radius:var(--radius-md);font-size:.875rem}.info-display.code{font-family:Courier New,monospace;word-break:break-all}.light-theme .info-display{background:var(--color-bg-secondary-light);color:var(--color-text-primary-light)}.dark-theme .info-display{background:var(--color-bg-secondary-dark);color:var(--color-text-primary-dark)}.form-hint{display:block;margin-top:var(--spacing-xs);font-size:.75rem;opacity:.7}.divider{border:none;border-top:1px solid;margin:var(--spacing-lg) 0}.light-theme .divider{border-color:#0000001a}.dark-theme .divider{border-color:#ffffff1a}.btn-danger{background:#dc2626;color:#fff}.btn-danger:hover:not(:disabled){background:#b91c1c}.loading-overlay{position:fixed;inset:0;background:#000c;backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:10001;animation:fadeIn .2s ease-out}.loading-spinner{background:var(--color-bg-primary-dark);border:1px solid rgba(255,255,255,.1);border-radius:var(--radius-lg);padding:var(--spacing-xl);text-align:center;max-width:400px;box-shadow:0 20px 60px #00000080}.spinner-icon{font-size:3rem;margin-bottom:var(--spacing-md);animation:spin 2s linear infinite}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-spinner h3{margin:0 0 var(--spacing-sm) 0;color:var(--color-text-primary-dark);font-size:1.25rem}.loading-spinner p{margin:0;color:var(--color-text-secondary-dark);font-size:.875rem}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.xverse-helper-box{background:#3b82f60d;border:1px solid rgba(59,130,246,.2);border-radius:var(--radius-md);padding:var(--spacing-md);margin-bottom:var(--spacing-lg)}.dark-theme .xverse-helper-box{background:#3b82f61a;border-color:#3b82f64d}.xverse-helper-box p{margin:0 0 var(--spacing-xs) 0;font-size:.875rem;font-weight:600;color:#3b82f6}.xverse-helper-box ul{margin:var(--spacing-xs) 0 var(--spacing-xs) var(--spacing-lg);padding:0}.xverse-helper-box li{margin-bottom:var(--spacing-xs);font-size:.875rem;line-height:1.6}.xverse-example{font-family:Courier New,monospace;font-size:.875rem!important;margin-top:var(--spacing-sm)!important;padding:var(--spacing-xs) var(--spacing-sm);background:#22c55e1a;border-radius:var(--radius-sm);color:#16a34a!important}.xverse-input-group{margin-bottom:var(--spacing-lg)}.xverse-input-group label{display:block;font-size:.875rem;font-weight:600;margin-bottom:var(--spacing-xs)}.xverse-input-group input,.xverse-input-group textarea{width:100%;padding:var(--spacing-sm) var(--spacing-md);border-radius:var(--radius-sm);border:1px solid;font-size:.875rem;transition:all var(--transition-fast)}.light-theme .xverse-input-group input,.light-theme .xverse-input-group textarea{background:var(--color-card-light);border-color:var(--color-border-light);color:var(--color-text-light)}.dark-theme .xverse-input-group input,.dark-theme .xverse-input-group textarea{background:#0000004d;border-color:var(--color-border-dark);color:var(--color-text-dark)}.xverse-input-group input:focus,.xverse-input-group textarea:focus{outline:none;border-color:var(--color-purple-600)}.xverse-input-invalid{border-color:#dc2626!important;background:#dc26260d!important}.xverse-input-invalid:focus{border-color:#dc2626!important}.xverse-validation-error{display:block;margin-top:var(--spacing-xs);font-size:.75rem;color:#dc2626;font-weight:500}.xverse-validation-success{display:block;margin-top:var(--spacing-xs);font-size:.75rem;color:#16a34a;font-weight:500}.xverse-help-text{display:block;margin-top:var(--spacing-xs);font-size:.75rem;opacity:.7;font-style:italic}.xverse-button-disabled{opacity:.5;cursor:not-allowed}.xverse-checkbox-group{display:flex;align-items:flex-start;gap:var(--spacing-xs)}.xverse-checkbox-group label{display:flex;align-items:center;gap:var(--spacing-xs);margin-bottom:0}.xverse-checkbox-group input[type=checkbox]{width:auto;cursor:pointer}.xverse-checkbox-group span{font-weight:600}

</style>
</head>
<body>
  <div id="root"></div>

</body>
</html>
